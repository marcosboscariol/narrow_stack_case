[0m20:46:18.815526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bd26bcbdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bd273dce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bd2725d2d0>]}


============================== 20:46:18.822984 | 28bfea9b-851e-469f-95d8-617f69ff3d72 ==============================
[0m20:46:18.822984 [info ] [MainThread]: Running with dbt=1.7.9
[0m20:46:18.824271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'profiles_dir': '/usr/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:46:18.825878 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m20:46:18.827800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bd26bcbdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bd2508ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bd2508ece0>]}
[0m20:46:18.828721 [debug] [MainThread]: Flushing usage events
[0m20:46:43.627487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535cf957310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535ce47b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535cffe82b0>]}


============================== 20:46:43.633447 | c3837fbc-9d8b-4dba-be0f-546cd31fcf29 ==============================
[0m20:46:43.633447 [info ] [MainThread]: Running with dbt=1.7.9
[0m20:46:43.634514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:46:43.828842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3837fbc-9d8b-4dba-be0f-546cd31fcf29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535ce47b100>]}
[0m20:46:43.914015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3837fbc-9d8b-4dba-be0f-546cd31fcf29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535cddce9e0>]}
[0m20:46:43.915767 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m20:46:43.926079 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m20:46:43.930475 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:46:43.931596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c3837fbc-9d8b-4dba-be0f-546cd31fcf29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535cc456f20>]}
[0m20:46:44.905690 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.staging
- models.mage_case.data_mart
[0m20:46:44.914761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3837fbc-9d8b-4dba-be0f-546cd31fcf29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535cc26f910>]}
[0m20:46:44.948726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3837fbc-9d8b-4dba-be0f-546cd31fcf29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535cc33cdf0>]}
[0m20:46:44.950455 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:46:44.951904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3837fbc-9d8b-4dba-be0f-546cd31fcf29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535cc3f53f0>]}
[0m20:46:44.955664 [info ] [MainThread]: 
[0m20:46:44.957715 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:46:44.961469 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m20:46:44.973374 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m20:46:44.974695 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m20:46:44.975821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:45.007924 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:46:45.009969 [debug] [ThreadPool]: On list_dbt: Close
[0m20:46:45.012371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_public)
[0m20:46:45.018448 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m20:46:45.019283 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m20:46:45.020084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:45.028307 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:46:45.029278 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m20:46:45.030031 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:46:45.037961 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:46:45.039727 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m20:46:45.040711 [debug] [ThreadPool]: On list_dbt_public: Close
[0m20:46:45.045781 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:45.046718 [debug] [MainThread]: On master: BEGIN
[0m20:46:45.047423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:46:45.056579 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:46:45.057642 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:45.058854 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:46:45.064694 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:46:45.066681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3837fbc-9d8b-4dba-be0f-546cd31fcf29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535cb09e230>]}
[0m20:46:45.067704 [debug] [MainThread]: On master: ROLLBACK
[0m20:46:45.068615 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:45.069321 [debug] [MainThread]: On master: BEGIN
[0m20:46:45.070521 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:46:45.071458 [debug] [MainThread]: On master: COMMIT
[0m20:46:45.072484 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:45.073548 [debug] [MainThread]: On master: COMMIT
[0m20:46:45.074710 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:46:45.075551 [debug] [MainThread]: On master: Close
[0m20:46:45.076986 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:46:45.078112 [info ] [MainThread]: 
[0m20:46:45.089361 [debug] [Thread-1 (]: Began running node model.mage_case.stg_clientes
[0m20:46:45.089995 [debug] [Thread-2 (]: Began running node model.mage_case.stg_itens_vendas
[0m20:46:45.090452 [debug] [Thread-3 (]: Began running node model.mage_case.stg_produtos
[0m20:46:45.090877 [debug] [Thread-4 (]: Began running node model.mage_case.stg_vendas
[0m20:46:45.091641 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_clientes ................................ [RUN]
[0m20:46:45.092775 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_itens_vendas ............................ [RUN]
[0m20:46:45.094526 [info ] [Thread-3 (]: 3 of 4 START sql view model public.stg_produtos ................................ [RUN]
[0m20:46:45.096060 [info ] [Thread-4 (]: 4 of 4 START sql view model public.stg_vendas .................................. [RUN]
[0m20:46:45.097877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now model.mage_case.stg_clientes)
[0m20:46:45.099797 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.mage_case.stg_itens_vendas'
[0m20:46:45.101892 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.mage_case.stg_produtos'
[0m20:46:45.103924 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.mage_case.stg_vendas'
[0m20:46:45.104789 [debug] [Thread-1 (]: Began compiling node model.mage_case.stg_clientes
[0m20:46:45.105543 [debug] [Thread-2 (]: Began compiling node model.mage_case.stg_itens_vendas
[0m20:46:45.106265 [debug] [Thread-3 (]: Began compiling node model.mage_case.stg_produtos
[0m20:46:45.107014 [debug] [Thread-4 (]: Began compiling node model.mage_case.stg_vendas
[0m20:46:45.116647 [debug] [Thread-1 (]: Writing injected SQL for node "model.mage_case.stg_clientes"
[0m20:46:45.120247 [debug] [Thread-2 (]: Writing injected SQL for node "model.mage_case.stg_itens_vendas"
[0m20:46:45.124004 [debug] [Thread-3 (]: Writing injected SQL for node "model.mage_case.stg_produtos"
[0m20:46:45.128441 [debug] [Thread-4 (]: Writing injected SQL for node "model.mage_case.stg_vendas"
[0m20:46:45.142670 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (compile): 20:46:45.117536 => 20:46:45.142205
[0m20:46:45.144080 [debug] [Thread-2 (]: Began executing node model.mage_case.stg_itens_vendas
[0m20:46:45.145076 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (compile): 20:46:45.107971 => 20:46:45.144697
[0m20:46:45.152440 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (compile): 20:46:45.124845 => 20:46:45.151689
[0m20:46:45.162551 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (compile): 20:46:45.121385 => 20:46:45.162020
[0m20:46:45.184123 [debug] [Thread-1 (]: Began executing node model.mage_case.stg_clientes
[0m20:46:45.184888 [debug] [Thread-2 (]: Writing runtime sql for node "model.mage_case.stg_itens_vendas"
[0m20:46:45.186267 [debug] [Thread-4 (]: Began executing node model.mage_case.stg_vendas
[0m20:46:45.187382 [debug] [Thread-3 (]: Began executing node model.mage_case.stg_produtos
[0m20:46:45.192446 [debug] [Thread-1 (]: Writing runtime sql for node "model.mage_case.stg_clientes"
[0m20:46:45.198956 [debug] [Thread-4 (]: Writing runtime sql for node "model.mage_case.stg_vendas"
[0m20:46:45.204071 [debug] [Thread-3 (]: Writing runtime sql for node "model.mage_case.stg_produtos"
[0m20:46:45.214038 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m20:46:45.215555 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: BEGIN
[0m20:46:45.216230 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m20:46:45.217703 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:46:45.218534 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m20:46:45.219144 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m20:46:45.220155 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: BEGIN
[0m20:46:45.222573 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: BEGIN
[0m20:46:45.224115 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: BEGIN
[0m20:46:45.225600 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:46:45.226848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:45.228151 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:46:45.231510 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:45.238727 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m20:46:45.240128 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:45.241039 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */

  create view "dbt"."public"."stg_produtos__dbt_tmp"
    
    
  as (
    

select *
from read_parquet('s3://mage-bucket/parquet/produtos.parquet')
  );
[0m20:46:45.241742 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:45.242458 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:46:45.243174 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m20:46:45.245025 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m20:46:45.245980 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function read_parquet(unknown) does not exist
LINE 10: from read_parquet('s3://mage-bucket/parquet/produtos.parquet...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:46:45.247037 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m20:46:45.247929 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */

  create view "dbt"."public"."stg_itens_vendas__dbt_tmp"
    
    
  as (
    

select *
from read_parquet('s3://mage-bucket/parquet/itens_vendas.parquet')
  );
[0m20:46:45.248804 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */

  create view "dbt"."public"."stg_clientes__dbt_tmp"
    
    
  as (
    

select *
from read_parquet('s3://mage-bucket/parquet/clientes.parquet')
  );
[0m20:46:45.249693 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: ROLLBACK
[0m20:46:45.250845 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */

  create view "dbt"."public"."stg_vendas__dbt_tmp"
    
    
  as (
    

select *
from read_parquet('s3://mage-bucket/parquet/vendas.parquet')
  );
[0m20:46:45.252651 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function read_parquet(unknown) does not exist
LINE 10: from read_parquet('s3://mage-bucket/parquet/itens_vendas.par...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:46:45.254139 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function read_parquet(unknown) does not exist
LINE 10: from read_parquet('s3://mage-bucket/parquet/clientes.parquet...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:46:45.255230 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (execute): 20:46:45.200284 => 20:46:45.254894
[0m20:46:45.256818 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: ROLLBACK
[0m20:46:45.257493 [debug] [Thread-4 (]: Postgres adapter: Postgres error: function read_parquet(unknown) does not exist
LINE 10: from read_parquet('s3://mage-bucket/parquet/vendas.parquet')
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:46:45.258625 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: ROLLBACK
[0m20:46:45.259572 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: Close
[0m20:46:45.261146 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (execute): 20:46:45.146136 => 20:46:45.260813
[0m20:46:45.261889 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: ROLLBACK
[0m20:46:45.263313 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (execute): 20:46:45.188279 => 20:46:45.263035
[0m20:46:45.265373 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: Close
[0m20:46:45.267439 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (execute): 20:46:45.194366 => 20:46:45.267037
[0m20:46:45.268566 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: Close
[0m20:46:45.271583 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: Close
[0m20:46:45.278552 [debug] [Thread-1 (]: Database Error in model stg_clientes (models/stagking/stg_clientes.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/clientes.parquet...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.sql
[0m20:46:45.279385 [debug] [Thread-3 (]: Database Error in model stg_produtos (models/stagking/stg_produtos.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/produtos.parquet...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_produtos.sql
[0m20:46:45.280172 [debug] [Thread-4 (]: Database Error in model stg_vendas (models/stagking/stg_vendas.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/vendas.parquet')
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_vendas.sql
[0m20:46:45.281497 [debug] [Thread-2 (]: Database Error in model stg_itens_vendas (models/stagking/stg_itens_vendas.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/itens_vendas.par...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_itens_vendas.sql
[0m20:46:45.282481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3837fbc-9d8b-4dba-be0f-546cd31fcf29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535cc1d5660>]}
[0m20:46:45.283795 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3837fbc-9d8b-4dba-be0f-546cd31fcf29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535caf476d0>]}
[0m20:46:45.284968 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3837fbc-9d8b-4dba-be0f-546cd31fcf29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535cc219cf0>]}
[0m20:46:45.286243 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3837fbc-9d8b-4dba-be0f-546cd31fcf29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535cb0a92d0>]}
[0m20:46:45.287754 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.stg_clientes ....................... [[31mERROR[0m in 0.19s]
[0m20:46:45.289331 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model public.stg_produtos ....................... [[31mERROR[0m in 0.18s]
[0m20:46:45.290783 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model public.stg_vendas ......................... [[31mERROR[0m in 0.18s]
[0m20:46:45.292058 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.stg_itens_vendas ................... [[31mERROR[0m in 0.19s]
[0m20:46:45.293636 [debug] [Thread-1 (]: Finished running node model.mage_case.stg_clientes
[0m20:46:45.295281 [debug] [Thread-3 (]: Finished running node model.mage_case.stg_produtos
[0m20:46:45.296651 [debug] [Thread-4 (]: Finished running node model.mage_case.stg_vendas
[0m20:46:45.297684 [debug] [Thread-2 (]: Finished running node model.mage_case.stg_itens_vendas
[0m20:46:45.302240 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:45.303510 [debug] [MainThread]: On master: BEGIN
[0m20:46:45.304542 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:46:45.314356 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:46:45.315606 [debug] [MainThread]: On master: COMMIT
[0m20:46:45.316585 [debug] [MainThread]: Using postgres connection "master"
[0m20:46:45.317564 [debug] [MainThread]: On master: COMMIT
[0m20:46:45.318607 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:46:45.319467 [debug] [MainThread]: On master: Close
[0m20:46:45.320622 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:45.323467 [debug] [MainThread]: Connection 'model.mage_case.stg_clientes' was properly closed.
[0m20:46:45.324831 [debug] [MainThread]: Connection 'model.mage_case.stg_itens_vendas' was properly closed.
[0m20:46:45.326049 [debug] [MainThread]: Connection 'model.mage_case.stg_produtos' was properly closed.
[0m20:46:45.326882 [debug] [MainThread]: Connection 'model.mage_case.stg_vendas' was properly closed.
[0m20:46:45.327842 [info ] [MainThread]: 
[0m20:46:45.328796 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m20:46:45.331514 [debug] [MainThread]: Command end result
[0m20:46:45.358595 [info ] [MainThread]: 
[0m20:46:45.360373 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m20:46:45.362137 [info ] [MainThread]: 
[0m20:46:45.364616 [error] [MainThread]:   Database Error in model stg_clientes (models/stagking/stg_clientes.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/clientes.parquet...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.sql
[0m20:46:45.366336 [info ] [MainThread]: 
[0m20:46:45.368238 [error] [MainThread]:   Database Error in model stg_produtos (models/stagking/stg_produtos.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/produtos.parquet...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_produtos.sql
[0m20:46:45.369599 [info ] [MainThread]: 
[0m20:46:45.371188 [error] [MainThread]:   Database Error in model stg_vendas (models/stagking/stg_vendas.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/vendas.parquet')
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_vendas.sql
[0m20:46:45.373195 [info ] [MainThread]: 
[0m20:46:45.376273 [error] [MainThread]:   Database Error in model stg_itens_vendas (models/stagking/stg_itens_vendas.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/itens_vendas.par...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_itens_vendas.sql
[0m20:46:45.378033 [info ] [MainThread]: 
[0m20:46:45.379806 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m20:46:45.382702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535cf957310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535cc454fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535cc20bc70>]}
[0m20:46:45.384000 [debug] [MainThread]: Flushing usage events
[0m20:51:13.299563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71114bf1b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71114aa3f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71114c5ac2b0>]}


============================== 20:51:13.305406 | 726bf8fc-7da6-42e4-acde-8edd9420c30a ==============================
[0m20:51:13.305406 [info ] [MainThread]: Running with dbt=1.7.9
[0m20:51:13.306398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:51:13.497951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '726bf8fc-7da6-42e4-acde-8edd9420c30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71114aa3f100>]}
[0m20:51:13.585946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '726bf8fc-7da6-42e4-acde-8edd9420c30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71114a3969e0>]}
[0m20:51:13.587686 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m20:51:13.602911 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m20:51:13.704469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:51:13.705458 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:51:13.706429 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.data_mart
- models.mage_case.staging
[0m20:51:13.713064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '726bf8fc-7da6-42e4-acde-8edd9420c30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7111487020e0>]}
[0m20:51:13.736090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '726bf8fc-7da6-42e4-acde-8edd9420c30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711148814d30>]}
[0m20:51:13.738482 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:51:13.741211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '726bf8fc-7da6-42e4-acde-8edd9420c30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711148814fa0>]}
[0m20:51:13.744806 [info ] [MainThread]: 
[0m20:51:13.746797 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:51:13.750098 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m20:51:13.761589 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m20:51:13.762845 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m20:51:13.763970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:13.779472 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:51:13.781166 [debug] [ThreadPool]: On list_dbt: Close
[0m20:51:13.783235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_public)
[0m20:51:13.791174 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m20:51:13.792067 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m20:51:13.792692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:13.801022 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:51:13.802040 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m20:51:13.803020 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:51:13.807191 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:51:13.808985 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m20:51:13.810093 [debug] [ThreadPool]: On list_dbt_public: Close
[0m20:51:13.814929 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:13.815848 [debug] [MainThread]: On master: BEGIN
[0m20:51:13.816493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:51:13.823722 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:51:13.824603 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:13.825334 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:51:13.828518 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:51:13.830088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '726bf8fc-7da6-42e4-acde-8edd9420c30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7111487534c0>]}
[0m20:51:13.830930 [debug] [MainThread]: On master: ROLLBACK
[0m20:51:13.832074 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:13.833028 [debug] [MainThread]: On master: BEGIN
[0m20:51:13.834160 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:51:13.834837 [debug] [MainThread]: On master: COMMIT
[0m20:51:13.835446 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:13.836030 [debug] [MainThread]: On master: COMMIT
[0m20:51:13.836744 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:51:13.837361 [debug] [MainThread]: On master: Close
[0m20:51:13.838335 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:51:13.839333 [info ] [MainThread]: 
[0m20:51:13.847282 [debug] [Thread-1 (]: Began running node model.mage_case.stg_clientes
[0m20:51:13.847850 [debug] [Thread-2 (]: Began running node model.mage_case.stg_itens_vendas
[0m20:51:13.848329 [debug] [Thread-3 (]: Began running node model.mage_case.stg_produtos
[0m20:51:13.848967 [debug] [Thread-4 (]: Began running node model.mage_case.stg_vendas
[0m20:51:13.849773 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_clientes ................................ [RUN]
[0m20:51:13.850772 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_itens_vendas ............................ [RUN]
[0m20:51:13.851993 [info ] [Thread-3 (]: 3 of 4 START sql view model public.stg_produtos ................................ [RUN]
[0m20:51:13.853335 [info ] [Thread-4 (]: 4 of 4 START sql view model public.stg_vendas .................................. [RUN]
[0m20:51:13.856011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now model.mage_case.stg_clientes)
[0m20:51:13.858196 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.mage_case.stg_itens_vendas'
[0m20:51:13.859642 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.mage_case.stg_produtos'
[0m20:51:13.861190 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.mage_case.stg_vendas'
[0m20:51:13.862654 [debug] [Thread-1 (]: Began compiling node model.mage_case.stg_clientes
[0m20:51:13.863713 [debug] [Thread-2 (]: Began compiling node model.mage_case.stg_itens_vendas
[0m20:51:13.864590 [debug] [Thread-3 (]: Began compiling node model.mage_case.stg_produtos
[0m20:51:13.865310 [debug] [Thread-4 (]: Began compiling node model.mage_case.stg_vendas
[0m20:51:13.873397 [debug] [Thread-1 (]: Writing injected SQL for node "model.mage_case.stg_clientes"
[0m20:51:13.876622 [debug] [Thread-2 (]: Writing injected SQL for node "model.mage_case.stg_itens_vendas"
[0m20:51:13.881770 [debug] [Thread-3 (]: Writing injected SQL for node "model.mage_case.stg_produtos"
[0m20:51:13.886971 [debug] [Thread-4 (]: Writing injected SQL for node "model.mage_case.stg_vendas"
[0m20:51:13.892787 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (compile): 20:51:13.865918 => 20:51:13.892309
[0m20:51:13.893395 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (compile): 20:51:13.877673 => 20:51:13.893118
[0m20:51:13.894443 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (compile): 20:51:13.874349 => 20:51:13.894086
[0m20:51:13.895276 [debug] [Thread-1 (]: Began executing node model.mage_case.stg_clientes
[0m20:51:13.896373 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (compile): 20:51:13.883824 => 20:51:13.896095
[0m20:51:13.896792 [debug] [Thread-3 (]: Began executing node model.mage_case.stg_produtos
[0m20:51:13.897619 [debug] [Thread-2 (]: Began executing node model.mage_case.stg_itens_vendas
[0m20:51:13.919948 [debug] [Thread-4 (]: Began executing node model.mage_case.stg_vendas
[0m20:51:13.930870 [debug] [Thread-1 (]: Writing runtime sql for node "model.mage_case.stg_clientes"
[0m20:51:13.935539 [debug] [Thread-3 (]: Writing runtime sql for node "model.mage_case.stg_produtos"
[0m20:51:13.941537 [debug] [Thread-2 (]: Writing runtime sql for node "model.mage_case.stg_itens_vendas"
[0m20:51:13.946618 [debug] [Thread-4 (]: Writing runtime sql for node "model.mage_case.stg_vendas"
[0m20:51:13.953069 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m20:51:13.953822 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m20:51:13.955035 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m20:51:13.955515 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: BEGIN
[0m20:51:13.956521 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: BEGIN
[0m20:51:13.957045 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m20:51:13.957760 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: BEGIN
[0m20:51:13.958633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:13.959493 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:51:13.960315 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: BEGIN
[0m20:51:13.961129 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:51:13.963796 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:51:13.970809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:51:13.971924 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m20:51:13.972690 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m20:51:13.973433 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:51:13.973989 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m20:51:13.974408 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m20:51:13.975036 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */

  create view "dbt"."public"."stg_clientes__dbt_tmp"
    
    
  as (
    

select *
from read_parquet('s3://mage-bucket/parquet/clientes.parquet')
  );
[0m20:51:13.975799 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m20:51:13.976526 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */

  create view "dbt"."public"."stg_produtos__dbt_tmp"
    
    
  as (
    

select *
from read_parquet('s3://mage-bucket/parquet/produtos.parquet')
  );
[0m20:51:13.977233 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m20:51:13.978462 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */

  create view "dbt"."public"."stg_itens_vendas__dbt_tmp"
    
    
  as (
    

select *
from read_parquet('s3://mage-bucket/parquet/itens_vendas.parquet')
  );
[0m20:51:13.978964 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function read_parquet(unknown) does not exist
LINE 10: from read_parquet('s3://mage-bucket/parquet/clientes.parquet...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:51:13.980152 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function read_parquet(unknown) does not exist
LINE 10: from read_parquet('s3://mage-bucket/parquet/produtos.parquet...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:51:13.980547 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */

  create view "dbt"."public"."stg_vendas__dbt_tmp"
    
    
  as (
    

select *
from read_parquet('s3://mage-bucket/parquet/vendas.parquet')
  );
[0m20:51:13.981722 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function read_parquet(unknown) does not exist
LINE 10: from read_parquet('s3://mage-bucket/parquet/itens_vendas.par...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:51:13.982131 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: ROLLBACK
[0m20:51:13.982878 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: ROLLBACK
[0m20:51:13.984034 [debug] [Thread-4 (]: Postgres adapter: Postgres error: function read_parquet(unknown) does not exist
LINE 10: from read_parquet('s3://mage-bucket/parquet/vendas.parquet')
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:51:13.984407 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: ROLLBACK
[0m20:51:13.985530 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (execute): 20:51:13.898236 => 20:51:13.985297
[0m20:51:13.986424 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (execute): 20:51:13.931816 => 20:51:13.986213
[0m20:51:13.987025 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: ROLLBACK
[0m20:51:13.988037 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (execute): 20:51:13.936681 => 20:51:13.987827
[0m20:51:13.988701 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: Close
[0m20:51:13.989453 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: Close
[0m20:51:13.990526 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (execute): 20:51:13.942794 => 20:51:13.990311
[0m20:51:13.991012 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: Close
[0m20:51:13.994286 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: Close
[0m20:51:14.002133 [debug] [Thread-3 (]: Database Error in model stg_produtos (models/stagking/stg_produtos.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/produtos.parquet...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_produtos.sql
[0m20:51:14.002947 [debug] [Thread-2 (]: Database Error in model stg_itens_vendas (models/stagking/stg_itens_vendas.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/itens_vendas.par...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_itens_vendas.sql
[0m20:51:14.004028 [debug] [Thread-1 (]: Database Error in model stg_clientes (models/stagking/stg_clientes.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/clientes.parquet...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.sql
[0m20:51:14.004648 [debug] [Thread-4 (]: Database Error in model stg_vendas (models/stagking/stg_vendas.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/vendas.parquet')
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_vendas.sql
[0m20:51:14.005087 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726bf8fc-7da6-42e4-acde-8edd9420c30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7111487ed6f0>]}
[0m20:51:14.005938 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726bf8fc-7da6-42e4-acde-8edd9420c30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7111487ee110>]}
[0m20:51:14.006824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726bf8fc-7da6-42e4-acde-8edd9420c30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7111487d63b0>]}
[0m20:51:14.007592 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726bf8fc-7da6-42e4-acde-8edd9420c30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711148702da0>]}
[0m20:51:14.008648 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model public.stg_produtos ....................... [[31mERROR[0m in 0.15s]
[0m20:51:14.009787 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.stg_itens_vendas ................... [[31mERROR[0m in 0.15s]
[0m20:51:14.011124 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.stg_clientes ....................... [[31mERROR[0m in 0.15s]
[0m20:51:14.012401 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model public.stg_vendas ......................... [[31mERROR[0m in 0.15s]
[0m20:51:14.013672 [debug] [Thread-3 (]: Finished running node model.mage_case.stg_produtos
[0m20:51:14.014721 [debug] [Thread-2 (]: Finished running node model.mage_case.stg_itens_vendas
[0m20:51:14.015629 [debug] [Thread-1 (]: Finished running node model.mage_case.stg_clientes
[0m20:51:14.016498 [debug] [Thread-4 (]: Finished running node model.mage_case.stg_vendas
[0m20:51:14.020959 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:14.021865 [debug] [MainThread]: On master: BEGIN
[0m20:51:14.022629 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:51:14.030513 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:51:14.031421 [debug] [MainThread]: On master: COMMIT
[0m20:51:14.032092 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:14.032755 [debug] [MainThread]: On master: COMMIT
[0m20:51:14.033951 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:51:14.035622 [debug] [MainThread]: On master: Close
[0m20:51:14.037346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:14.038590 [debug] [MainThread]: Connection 'model.mage_case.stg_clientes' was properly closed.
[0m20:51:14.039667 [debug] [MainThread]: Connection 'model.mage_case.stg_itens_vendas' was properly closed.
[0m20:51:14.040618 [debug] [MainThread]: Connection 'model.mage_case.stg_produtos' was properly closed.
[0m20:51:14.042355 [debug] [MainThread]: Connection 'model.mage_case.stg_vendas' was properly closed.
[0m20:51:14.043828 [info ] [MainThread]: 
[0m20:51:14.045652 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m20:51:14.047768 [debug] [MainThread]: Command end result
[0m20:51:14.065771 [info ] [MainThread]: 
[0m20:51:14.067001 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m20:51:14.068843 [info ] [MainThread]: 
[0m20:51:14.071967 [error] [MainThread]:   Database Error in model stg_produtos (models/stagking/stg_produtos.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/produtos.parquet...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_produtos.sql
[0m20:51:14.074323 [info ] [MainThread]: 
[0m20:51:14.075986 [error] [MainThread]:   Database Error in model stg_itens_vendas (models/stagking/stg_itens_vendas.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/itens_vendas.par...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_itens_vendas.sql
[0m20:51:14.077560 [info ] [MainThread]: 
[0m20:51:14.079614 [error] [MainThread]:   Database Error in model stg_clientes (models/stagking/stg_clientes.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/clientes.parquet...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.sql
[0m20:51:14.081108 [info ] [MainThread]: 
[0m20:51:14.082792 [error] [MainThread]:   Database Error in model stg_vendas (models/stagking/stg_vendas.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/vendas.parquet')
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_vendas.sql
[0m20:51:14.084506 [info ] [MainThread]: 
[0m20:51:14.086565 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m20:51:14.088958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71114bf1b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7111488c3e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7111488c3fa0>]}
[0m20:51:14.090232 [debug] [MainThread]: Flushing usage events
[0m00:06:49.741804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e68bcf310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e67aa3100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e6930e680>]}


============================== 00:06:49.749738 | ed178da1-a528-460f-afe0-a34278a40322 ==============================
[0m00:06:49.749738 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:06:49.750912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:06:50.020964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed178da1-a528-460f-afe0-a34278a40322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e67aa3100>]}
[0m00:06:50.119264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed178da1-a528-460f-afe0-a34278a40322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e676e7f10>]}
[0m00:06:50.121536 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:06:50.139754 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:06:50.323665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:06:50.325071 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:06:50.326499 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.staging
- models.mage_case.data_mart
[0m00:06:50.336781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed178da1-a528-460f-afe0-a34278a40322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e657620b0>]}
[0m00:06:50.392836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed178da1-a528-460f-afe0-a34278a40322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e65694d00>]}
[0m00:06:50.395247 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:06:50.397281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed178da1-a528-460f-afe0-a34278a40322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e65694f70>]}
[0m00:06:50.402905 [info ] [MainThread]: 
[0m00:06:50.405582 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:06:50.409609 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:06:50.431627 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:06:50.433051 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:06:50.433974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:50.459429 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m00:06:50.461594 [debug] [ThreadPool]: On list_dbt: Close
[0m00:06:50.464327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_public)
[0m00:06:50.472706 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:06:50.473864 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:06:50.474719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:50.484583 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:06:50.485705 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:06:50.486757 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:06:50.493674 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m00:06:50.495782 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:06:50.496972 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:06:50.505037 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:50.506215 [debug] [MainThread]: On master: BEGIN
[0m00:06:50.507138 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:06:50.516533 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:06:50.517527 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:50.518794 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:06:50.525361 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m00:06:50.527271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed178da1-a528-460f-afe0-a34278a40322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e65727fd0>]}
[0m00:06:50.528528 [debug] [MainThread]: On master: ROLLBACK
[0m00:06:50.529966 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:50.531249 [debug] [MainThread]: On master: BEGIN
[0m00:06:50.532949 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:06:50.534200 [debug] [MainThread]: On master: COMMIT
[0m00:06:50.535328 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:50.536656 [debug] [MainThread]: On master: COMMIT
[0m00:06:50.538113 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:06:50.539288 [debug] [MainThread]: On master: Close
[0m00:06:50.540928 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:06:50.543126 [info ] [MainThread]: 
[0m00:06:50.555923 [debug] [Thread-1 (]: Began running node model.mage_case.stg_clientes
[0m00:06:50.556477 [debug] [Thread-2 (]: Began running node model.mage_case.stg_itens_vendas
[0m00:06:50.557000 [debug] [Thread-3 (]: Began running node model.mage_case.stg_produtos
[0m00:06:50.557674 [debug] [Thread-4 (]: Began running node model.mage_case.stg_vendas
[0m00:06:50.558689 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_clientes ................................ [RUN]
[0m00:06:50.560505 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_itens_vendas ............................ [RUN]
[0m00:06:50.562661 [info ] [Thread-3 (]: 3 of 4 START sql view model public.stg_produtos ................................ [RUN]
[0m00:06:50.565042 [info ] [Thread-4 (]: 4 of 4 START sql view model public.stg_vendas .................................. [RUN]
[0m00:06:50.568387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now model.mage_case.stg_clientes)
[0m00:06:50.571636 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.mage_case.stg_itens_vendas'
[0m00:06:50.574981 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.mage_case.stg_produtos'
[0m00:06:50.578255 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.mage_case.stg_vendas'
[0m00:06:50.579810 [debug] [Thread-1 (]: Began compiling node model.mage_case.stg_clientes
[0m00:06:50.581432 [debug] [Thread-2 (]: Began compiling node model.mage_case.stg_itens_vendas
[0m00:06:50.583647 [debug] [Thread-3 (]: Began compiling node model.mage_case.stg_produtos
[0m00:06:50.585194 [debug] [Thread-4 (]: Began compiling node model.mage_case.stg_vendas
[0m00:06:50.597948 [debug] [Thread-1 (]: Writing injected SQL for node "model.mage_case.stg_clientes"
[0m00:06:50.602951 [debug] [Thread-2 (]: Writing injected SQL for node "model.mage_case.stg_itens_vendas"
[0m00:06:50.609665 [debug] [Thread-3 (]: Writing injected SQL for node "model.mage_case.stg_produtos"
[0m00:06:50.613770 [debug] [Thread-4 (]: Writing injected SQL for node "model.mage_case.stg_vendas"
[0m00:06:50.620998 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (compile): 00:06:50.598866 => 00:06:50.620401
[0m00:06:50.623130 [debug] [Thread-2 (]: Began executing node model.mage_case.stg_itens_vendas
[0m00:06:50.624251 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (compile): 00:06:50.586301 => 00:06:50.623735
[0m00:06:50.625062 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (compile): 00:06:50.610556 => 00:06:50.624698
[0m00:06:50.625956 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (compile): 00:06:50.604236 => 00:06:50.625678
[0m00:06:50.648335 [debug] [Thread-1 (]: Began executing node model.mage_case.stg_clientes
[0m00:06:50.665632 [debug] [Thread-2 (]: Writing runtime sql for node "model.mage_case.stg_itens_vendas"
[0m00:06:50.666567 [debug] [Thread-4 (]: Began executing node model.mage_case.stg_vendas
[0m00:06:50.667824 [debug] [Thread-3 (]: Began executing node model.mage_case.stg_produtos
[0m00:06:50.673103 [debug] [Thread-1 (]: Writing runtime sql for node "model.mage_case.stg_clientes"
[0m00:06:50.681470 [debug] [Thread-4 (]: Writing runtime sql for node "model.mage_case.stg_vendas"
[0m00:06:50.687110 [debug] [Thread-3 (]: Writing runtime sql for node "model.mage_case.stg_produtos"
[0m00:06:50.688970 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:06:50.691818 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:06:50.692481 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: BEGIN
[0m00:06:50.693788 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:06:50.694661 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: BEGIN
[0m00:06:50.695300 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:06:50.696429 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:06:50.697592 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: BEGIN
[0m00:06:50.698709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:50.699670 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: BEGIN
[0m00:06:50.701511 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:06:50.703946 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:06:50.711774 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:06:50.712414 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:06:50.713627 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:06:50.714850 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:06:50.715465 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:06:50.715989 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:06:50.716986 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */

  create view "dbt"."public"."stg_itens_vendas__dbt_tmp"
    
    
  as (
    

select *
from read_parquet('s3://mage-bucket/parquet/itens_vendas.parquet')
  );
[0m00:06:50.717972 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:06:50.719071 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */

  create view "dbt"."public"."stg_clientes__dbt_tmp"
    
    
  as (
    

select *
from read_parquet('s3://mage-bucket/parquet/clientes.parquet')
  );
[0m00:06:50.719979 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:06:50.721594 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */

  create view "dbt"."public"."stg_vendas__dbt_tmp"
    
    
  as (
    

select *
from read_parquet('s3://mage-bucket/parquet/vendas.parquet')
  );
[0m00:06:50.722206 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function read_parquet(unknown) does not exist
LINE 10: from read_parquet('s3://mage-bucket/parquet/itens_vendas.par...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:06:50.723594 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function read_parquet(unknown) does not exist
LINE 10: from read_parquet('s3://mage-bucket/parquet/clientes.parquet...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:06:50.724071 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */

  create view "dbt"."public"."stg_produtos__dbt_tmp"
    
    
  as (
    

select *
from read_parquet('s3://mage-bucket/parquet/produtos.parquet')
  );
[0m00:06:50.725694 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: ROLLBACK
[0m00:06:50.726315 [debug] [Thread-4 (]: Postgres adapter: Postgres error: function read_parquet(unknown) does not exist
LINE 10: from read_parquet('s3://mage-bucket/parquet/vendas.parquet')
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:06:50.727358 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: ROLLBACK
[0m00:06:50.728937 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function read_parquet(unknown) does not exist
LINE 10: from read_parquet('s3://mage-bucket/parquet/produtos.parquet...
              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:06:50.729852 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (execute): 00:06:50.626452 => 00:06:50.729567
[0m00:06:50.730696 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: ROLLBACK
[0m00:06:50.732074 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (execute): 00:06:50.668631 => 00:06:50.731787
[0m00:06:50.732864 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: ROLLBACK
[0m00:06:50.733903 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: Close
[0m00:06:50.735349 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (execute): 00:06:50.675023 => 00:06:50.735062
[0m00:06:50.735978 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: Close
[0m00:06:50.737168 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (execute): 00:06:50.682458 => 00:06:50.736912
[0m00:06:50.738908 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: Close
[0m00:06:50.742280 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: Close
[0m00:06:50.756886 [debug] [Thread-2 (]: Database Error in model stg_itens_vendas (models/stagking/stg_itens_vendas.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/itens_vendas.par...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_itens_vendas.sql
[0m00:06:50.757762 [debug] [Thread-4 (]: Database Error in model stg_vendas (models/stagking/stg_vendas.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/vendas.parquet')
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_vendas.sql
[0m00:06:50.758691 [debug] [Thread-3 (]: Database Error in model stg_produtos (models/stagking/stg_produtos.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/produtos.parquet...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_produtos.sql
[0m00:06:50.759560 [debug] [Thread-1 (]: Database Error in model stg_clientes (models/stagking/stg_clientes.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/clientes.parquet...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.sql
[0m00:06:50.760339 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed178da1-a528-460f-afe0-a34278a40322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e6561ff40>]}
[0m00:06:50.761309 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed178da1-a528-460f-afe0-a34278a40322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e65762140>]}
[0m00:06:50.762395 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed178da1-a528-460f-afe0-a34278a40322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e65760f10>]}
[0m00:06:50.763406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed178da1-a528-460f-afe0-a34278a40322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e656464d0>]}
[0m00:06:50.764580 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.stg_itens_vendas ................... [[31mERROR[0m in 0.19s]
[0m00:06:50.765858 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model public.stg_vendas ......................... [[31mERROR[0m in 0.18s]
[0m00:06:50.767414 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model public.stg_produtos ....................... [[31mERROR[0m in 0.19s]
[0m00:06:50.768973 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.stg_clientes ....................... [[31mERROR[0m in 0.20s]
[0m00:06:50.770582 [debug] [Thread-2 (]: Finished running node model.mage_case.stg_itens_vendas
[0m00:06:50.772127 [debug] [Thread-4 (]: Finished running node model.mage_case.stg_vendas
[0m00:06:50.773910 [debug] [Thread-3 (]: Finished running node model.mage_case.stg_produtos
[0m00:06:50.775574 [debug] [Thread-1 (]: Finished running node model.mage_case.stg_clientes
[0m00:06:50.782826 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:50.784447 [debug] [MainThread]: On master: BEGIN
[0m00:06:50.785636 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:06:50.799588 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:06:50.801087 [debug] [MainThread]: On master: COMMIT
[0m00:06:50.802315 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:50.803697 [debug] [MainThread]: On master: COMMIT
[0m00:06:50.805349 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:06:50.806974 [debug] [MainThread]: On master: Close
[0m00:06:50.808783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:06:50.811147 [debug] [MainThread]: Connection 'model.mage_case.stg_clientes' was properly closed.
[0m00:06:50.812768 [debug] [MainThread]: Connection 'model.mage_case.stg_itens_vendas' was properly closed.
[0m00:06:50.813950 [debug] [MainThread]: Connection 'model.mage_case.stg_produtos' was properly closed.
[0m00:06:50.815107 [debug] [MainThread]: Connection 'model.mage_case.stg_vendas' was properly closed.
[0m00:06:50.816067 [info ] [MainThread]: 
[0m00:06:50.817646 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m00:06:50.820306 [debug] [MainThread]: Command end result
[0m00:06:50.847981 [info ] [MainThread]: 
[0m00:06:50.849745 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:06:50.852393 [info ] [MainThread]: 
[0m00:06:50.855222 [error] [MainThread]:   Database Error in model stg_itens_vendas (models/stagking/stg_itens_vendas.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/itens_vendas.par...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_itens_vendas.sql
[0m00:06:50.858422 [info ] [MainThread]: 
[0m00:06:50.860932 [error] [MainThread]:   Database Error in model stg_vendas (models/stagking/stg_vendas.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/vendas.parquet')
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_vendas.sql
[0m00:06:50.862988 [info ] [MainThread]: 
[0m00:06:50.864903 [error] [MainThread]:   Database Error in model stg_produtos (models/stagking/stg_produtos.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/produtos.parquet...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_produtos.sql
[0m00:06:50.867472 [info ] [MainThread]: 
[0m00:06:50.869935 [error] [MainThread]:   Database Error in model stg_clientes (models/stagking/stg_clientes.sql)
  function read_parquet(unknown) does not exist
  LINE 10: from read_parquet('s3://mage-bucket/parquet/clientes.parquet...
                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.sql
[0m00:06:50.871977 [info ] [MainThread]: 
[0m00:06:50.874170 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:06:50.878129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e68bcf310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e65727df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e65727f70>]}
[0m00:06:50.880366 [debug] [MainThread]: Flushing usage events
[0m00:08:03.399149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2378cfb730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e23793882b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2379388310>]}


============================== 00:08:03.405291 | 5dbb8dae-b6b6-492a-aea6-ec98ead936dc ==============================
[0m00:08:03.405291 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:08:03.406448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:08:03.610990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dbb8dae-b6b6-492a-aea6-ec98ead936dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e23771aed10>]}
[0m00:08:03.712500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dbb8dae-b6b6-492a-aea6-ec98ead936dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2377467f70>]}
[0m00:08:03.714487 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:08:03.730529 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:08:03.882726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m00:08:03.883941 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/stg_produtos.sql
[0m00:08:03.884915 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/stg_clientes.sql
[0m00:08:03.885804 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/stg_itens_vendas.sql
[0m00:08:03.886759 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/stg_vendas.sql
[0m00:08:04.089632 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.staging
- models.mage_case.data_mart
[0m00:08:04.100237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dbb8dae-b6b6-492a-aea6-ec98ead936dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e23744080d0>]}
[0m00:08:04.137012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dbb8dae-b6b6-492a-aea6-ec98ead936dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e23755e8c40>]}
[0m00:08:04.138709 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:08:04.140370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dbb8dae-b6b6-492a-aea6-ec98ead936dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e23755e8eb0>]}
[0m00:08:04.144663 [info ] [MainThread]: 
[0m00:08:04.147384 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:08:04.151408 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:08:04.172898 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:08:04.174433 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:08:04.175468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:04.190019 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m00:08:04.192589 [debug] [ThreadPool]: On list_dbt: Close
[0m00:08:04.196911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_public)
[0m00:08:04.207256 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:08:04.208485 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:08:04.209577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:04.222586 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:08:04.223852 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:08:04.254023 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:08:04.278967 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m00:08:04.282240 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:08:04.292841 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:08:04.302245 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:04.303595 [debug] [MainThread]: On master: BEGIN
[0m00:08:04.304799 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:08:04.317031 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:08:04.318143 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:04.319233 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:08:04.324864 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m00:08:04.327115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dbb8dae-b6b6-492a-aea6-ec98ead936dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e23755e80a0>]}
[0m00:08:04.328226 [debug] [MainThread]: On master: ROLLBACK
[0m00:08:04.329474 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:04.331175 [debug] [MainThread]: On master: BEGIN
[0m00:08:04.333401 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:08:04.335060 [debug] [MainThread]: On master: COMMIT
[0m00:08:04.336384 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:04.337688 [debug] [MainThread]: On master: COMMIT
[0m00:08:04.338841 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:08:04.339678 [debug] [MainThread]: On master: Close
[0m00:08:04.341091 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:08:04.342330 [info ] [MainThread]: 
[0m00:08:04.355874 [debug] [Thread-1 (]: Began running node model.mage_case.stg_clientes
[0m00:08:04.357627 [debug] [Thread-2 (]: Began running node model.mage_case.stg_itens_vendas
[0m00:08:04.358358 [debug] [Thread-3 (]: Began running node model.mage_case.stg_produtos
[0m00:08:04.359247 [debug] [Thread-4 (]: Began running node model.mage_case.stg_vendas
[0m00:08:04.360454 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_clientes ................................ [RUN]
[0m00:08:04.362162 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_itens_vendas ............................ [RUN]
[0m00:08:04.364331 [info ] [Thread-3 (]: 3 of 4 START sql view model public.stg_produtos ................................ [RUN]
[0m00:08:04.367087 [info ] [Thread-4 (]: 4 of 4 START sql view model public.stg_vendas .................................. [RUN]
[0m00:08:04.369384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now model.mage_case.stg_clientes)
[0m00:08:04.371928 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.mage_case.stg_itens_vendas'
[0m00:08:04.375170 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.mage_case.stg_produtos'
[0m00:08:04.377572 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.mage_case.stg_vendas'
[0m00:08:04.379801 [debug] [Thread-1 (]: Began compiling node model.mage_case.stg_clientes
[0m00:08:04.381792 [debug] [Thread-2 (]: Began compiling node model.mage_case.stg_itens_vendas
[0m00:08:04.383660 [debug] [Thread-3 (]: Began compiling node model.mage_case.stg_produtos
[0m00:08:04.385768 [debug] [Thread-4 (]: Began compiling node model.mage_case.stg_vendas
[0m00:08:04.398766 [debug] [Thread-1 (]: Writing injected SQL for node "model.mage_case.stg_clientes"
[0m00:08:04.404619 [debug] [Thread-2 (]: Writing injected SQL for node "model.mage_case.stg_itens_vendas"
[0m00:08:04.410167 [debug] [Thread-3 (]: Writing injected SQL for node "model.mage_case.stg_produtos"
[0m00:08:04.414789 [debug] [Thread-4 (]: Writing injected SQL for node "model.mage_case.stg_vendas"
[0m00:08:04.422149 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (compile): 00:08:04.387804 => 00:08:04.421633
[0m00:08:04.423516 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (compile): 00:08:04.400501 => 00:08:04.423083
[0m00:08:04.424777 [debug] [Thread-1 (]: Began executing node model.mage_case.stg_clientes
[0m00:08:04.425921 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (compile): 00:08:04.406168 => 00:08:04.425399
[0m00:08:04.427062 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (compile): 00:08:04.411357 => 00:08:04.426518
[0m00:08:04.428520 [debug] [Thread-2 (]: Began executing node model.mage_case.stg_itens_vendas
[0m00:08:04.453802 [debug] [Thread-3 (]: Began executing node model.mage_case.stg_produtos
[0m00:08:04.480961 [debug] [Thread-4 (]: Began executing node model.mage_case.stg_vendas
[0m00:08:04.483166 [debug] [Thread-1 (]: Writing runtime sql for node "model.mage_case.stg_clientes"
[0m00:08:04.490796 [debug] [Thread-2 (]: Writing runtime sql for node "model.mage_case.stg_itens_vendas"
[0m00:08:04.497594 [debug] [Thread-3 (]: Writing runtime sql for node "model.mage_case.stg_produtos"
[0m00:08:04.504047 [debug] [Thread-4 (]: Writing runtime sql for node "model.mage_case.stg_vendas"
[0m00:08:04.510171 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:08:04.511142 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:08:04.512883 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: BEGIN
[0m00:08:04.513845 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:08:04.515057 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:08:04.515892 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: BEGIN
[0m00:08:04.519196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:04.521242 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: BEGIN
[0m00:08:04.523126 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: BEGIN
[0m00:08:04.525161 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:08:04.528362 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:08:04.530647 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:08:04.538829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:08:04.540362 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:08:04.542619 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */

  create view "dbt"."public"."stg_clientes__dbt_tmp"
    
    
  as (
    

select *
from clientes
  );
[0m00:08:04.546638 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:08:04.547577 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:08:04.548675 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:08:04.549647 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:08:04.550679 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:08:04.552418 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:08:04.554379 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:08:04.565046 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:08:04.566728 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */

  create view "dbt"."public"."stg_itens_vendas__dbt_tmp"
    
    
  as (
    

select *
from itens_vendas
  );
[0m00:08:04.568228 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */

  create view "dbt"."public"."stg_produtos__dbt_tmp"
    
    
  as (
    

select *
from produtos
  );
[0m00:08:04.569748 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */

  create view "dbt"."public"."stg_vendas__dbt_tmp"
    
    
  as (
    

select *
from vendas
  );
[0m00:08:04.571339 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */
alter table "dbt"."public"."stg_clientes__dbt_tmp" rename to "stg_clientes"
[0m00:08:04.575366 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:08:04.576136 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:08:04.576674 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:08:04.578438 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:08:04.583213 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:08:04.650092 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:08:04.658402 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:08:04.682390 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
alter table "dbt"."public"."stg_itens_vendas__dbt_tmp" rename to "stg_itens_vendas"
[0m00:08:04.683553 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: COMMIT
[0m00:08:04.685939 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
alter table "dbt"."public"."stg_produtos__dbt_tmp" rename to "stg_produtos"
[0m00:08:04.688250 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
alter table "dbt"."public"."stg_vendas__dbt_tmp" rename to "stg_vendas"
[0m00:08:04.691317 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:08:04.692148 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:08:04.694321 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:08:04.695588 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:08:04.698455 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: COMMIT
[0m00:08:04.699851 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: COMMIT
[0m00:08:04.702659 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: COMMIT
[0m00:08:04.705404 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: COMMIT
[0m00:08:04.706942 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:08:04.708930 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:08:04.709534 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:08:04.710389 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:08:04.711500 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: COMMIT
[0m00:08:04.713133 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: COMMIT
[0m00:08:04.722960 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."stg_clientes__dbt_backup"
[0m00:08:04.724190 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: COMMIT
[0m00:08:04.726559 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:08:04.728121 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:08:04.734781 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:08:04.740419 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_itens_vendas__dbt_backup"
[0m00:08:04.741175 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m00:08:04.744861 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_produtos__dbt_backup"
[0m00:08:04.746172 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */
drop view if exists "dbt"."public"."stg_clientes__dbt_backup" cascade
[0m00:08:04.748842 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:08:04.753843 [debug] [Thread-4 (]: Applying DROP to: "dbt"."public"."stg_vendas__dbt_backup"
[0m00:08:04.756202 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:08:04.757914 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:08:04.758686 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
drop view if exists "dbt"."public"."stg_itens_vendas__dbt_backup" cascade
[0m00:08:04.760694 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:08:04.761952 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
drop view if exists "dbt"."public"."stg_produtos__dbt_backup" cascade
[0m00:08:04.764362 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (execute): 00:08:04.429897 => 00:08:04.764095
[0m00:08:04.765832 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:08:04.766504 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
drop view if exists "dbt"."public"."stg_vendas__dbt_backup" cascade
[0m00:08:04.768516 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:08:04.769603 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: Close
[0m00:08:04.772637 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (execute): 00:08:04.484378 => 00:08:04.772335
[0m00:08:04.774563 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:08:04.776811 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (execute): 00:08:04.491680 => 00:08:04.776491
[0m00:08:04.778482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dbb8dae-b6b6-492a-aea6-ec98ead936dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2374457e50>]}
[0m00:08:04.779422 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: Close
[0m00:08:04.782318 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (execute): 00:08:04.498501 => 00:08:04.782009
[0m00:08:04.783563 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: Close
[0m00:08:04.784981 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.stg_clientes ........................... [[32mCREATE VIEW[0m in 0.41s]
[0m00:08:04.786928 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dbb8dae-b6b6-492a-aea6-ec98ead936dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2374329210>]}
[0m00:08:04.788318 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: Close
[0m00:08:04.790424 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dbb8dae-b6b6-492a-aea6-ec98ead936dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e23742d7700>]}
[0m00:08:04.791669 [debug] [Thread-1 (]: Finished running node model.mage_case.stg_clientes
[0m00:08:04.792966 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.stg_itens_vendas ....................... [[32mCREATE VIEW[0m in 0.42s]
[0m00:08:04.795795 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dbb8dae-b6b6-492a-aea6-ec98ead936dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e23742d7970>]}
[0m00:08:04.798036 [info ] [Thread-3 (]: 3 of 4 OK created sql view model public.stg_produtos ........................... [[32mCREATE VIEW[0m in 0.42s]
[0m00:08:04.801938 [debug] [Thread-2 (]: Finished running node model.mage_case.stg_itens_vendas
[0m00:08:04.804616 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.stg_vendas ............................. [[32mCREATE VIEW[0m in 0.42s]
[0m00:08:04.806557 [debug] [Thread-3 (]: Finished running node model.mage_case.stg_produtos
[0m00:08:04.809867 [debug] [Thread-4 (]: Finished running node model.mage_case.stg_vendas
[0m00:08:04.814545 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:04.815522 [debug] [MainThread]: On master: BEGIN
[0m00:08:04.817013 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:08:04.827944 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:08:04.829021 [debug] [MainThread]: On master: COMMIT
[0m00:08:04.830285 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:04.831371 [debug] [MainThread]: On master: COMMIT
[0m00:08:04.832937 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:08:04.833823 [debug] [MainThread]: On master: Close
[0m00:08:04.835017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:08:04.835787 [debug] [MainThread]: Connection 'model.mage_case.stg_clientes' was properly closed.
[0m00:08:04.836853 [debug] [MainThread]: Connection 'model.mage_case.stg_itens_vendas' was properly closed.
[0m00:08:04.838299 [debug] [MainThread]: Connection 'model.mage_case.stg_produtos' was properly closed.
[0m00:08:04.839257 [debug] [MainThread]: Connection 'model.mage_case.stg_vendas' was properly closed.
[0m00:08:04.840217 [info ] [MainThread]: 
[0m00:08:04.841344 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m00:08:04.843736 [debug] [MainThread]: Command end result
[0m00:08:04.867919 [info ] [MainThread]: 
[0m00:08:04.869586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:08:04.871449 [info ] [MainThread]: 
[0m00:08:04.873975 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:08:04.876883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2378cfb730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e237570b8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e237570b610>]}
[0m00:08:04.879135 [debug] [MainThread]: Flushing usage events
[0m00:17:18.858745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bfd6999cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bfd54baa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bfd701c2e0>]}


============================== 00:17:18.864865 | 7c41868d-6b69-4f91-aff4-3f1fa9017c15 ==============================
[0m00:17:18.864865 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:17:18.865977 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:17:19.081372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c41868d-6b69-4f91-aff4-3f1fa9017c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bfd54baa70>]}
[0m00:17:19.187068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c41868d-6b69-4f91-aff4-3f1fa9017c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bfd50ffeb0>]}
[0m00:17:19.188611 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:17:19.202412 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:17:19.221803 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:17:19.222961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c41868d-6b69-4f91-aff4-3f1fa9017c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bfd3480b80>]}
[0m00:17:20.340040 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.data_mart
- models.mage_case.staging
[0m00:17:20.347132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c41868d-6b69-4f91-aff4-3f1fa9017c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bfd1fb00d0>]}
[0m00:17:20.374815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c41868d-6b69-4f91-aff4-3f1fa9017c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bfd3221c30>]}
[0m00:17:20.376595 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:17:20.378278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c41868d-6b69-4f91-aff4-3f1fa9017c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bfd318af50>]}
[0m00:17:20.381690 [info ] [MainThread]: 
[0m00:17:20.383780 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:17:20.386732 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:17:20.400906 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:17:20.402432 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:17:20.403538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:20.416871 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m00:17:20.419215 [debug] [ThreadPool]: On list_dbt: Close
[0m00:17:20.422635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_public)
[0m00:17:20.432077 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:17:20.433660 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:17:20.434942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:20.444616 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:17:20.446172 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:17:20.447827 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:17:20.452439 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:17:20.454822 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:17:20.456217 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:17:20.463473 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:20.464866 [debug] [MainThread]: On master: BEGIN
[0m00:17:20.465979 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:17:20.475259 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:17:20.476508 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:20.477445 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:17:20.483412 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m00:17:20.486328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c41868d-6b69-4f91-aff4-3f1fa9017c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bfd1ffb460>]}
[0m00:17:20.487301 [debug] [MainThread]: On master: ROLLBACK
[0m00:17:20.488352 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:20.489542 [debug] [MainThread]: On master: BEGIN
[0m00:17:20.490805 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:17:20.491565 [debug] [MainThread]: On master: COMMIT
[0m00:17:20.492257 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:20.492930 [debug] [MainThread]: On master: COMMIT
[0m00:17:20.493924 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:17:20.494679 [debug] [MainThread]: On master: Close
[0m00:17:20.495790 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:17:20.496934 [info ] [MainThread]: 
[0m00:17:20.506556 [debug] [Thread-1 (]: Began running node model.mage_case.stg_clientes
[0m00:17:20.507074 [debug] [Thread-2 (]: Began running node model.mage_case.stg_itens_vendas
[0m00:17:20.507638 [debug] [Thread-3 (]: Began running node model.mage_case.stg_produtos
[0m00:17:20.508104 [debug] [Thread-4 (]: Began running node model.mage_case.stg_vendas
[0m00:17:20.509028 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_clientes ................................ [RUN]
[0m00:17:20.510541 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_itens_vendas ............................ [RUN]
[0m00:17:20.512235 [info ] [Thread-3 (]: 3 of 4 START sql view model public.stg_produtos ................................ [RUN]
[0m00:17:20.514300 [info ] [Thread-4 (]: 4 of 4 START sql view model public.stg_vendas .................................. [RUN]
[0m00:17:20.516582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now model.mage_case.stg_clientes)
[0m00:17:20.518625 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.mage_case.stg_itens_vendas'
[0m00:17:20.520581 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.mage_case.stg_produtos'
[0m00:17:20.522588 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.mage_case.stg_vendas'
[0m00:17:20.524007 [debug] [Thread-1 (]: Began compiling node model.mage_case.stg_clientes
[0m00:17:20.525032 [debug] [Thread-2 (]: Began compiling node model.mage_case.stg_itens_vendas
[0m00:17:20.526145 [debug] [Thread-3 (]: Began compiling node model.mage_case.stg_produtos
[0m00:17:20.527240 [debug] [Thread-4 (]: Began compiling node model.mage_case.stg_vendas
[0m00:17:20.536988 [debug] [Thread-1 (]: Writing injected SQL for node "model.mage_case.stg_clientes"
[0m00:17:20.540277 [debug] [Thread-2 (]: Writing injected SQL for node "model.mage_case.stg_itens_vendas"
[0m00:17:20.545084 [debug] [Thread-3 (]: Writing injected SQL for node "model.mage_case.stg_produtos"
[0m00:17:20.549905 [debug] [Thread-4 (]: Writing injected SQL for node "model.mage_case.stg_vendas"
[0m00:17:20.556998 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (compile): 00:17:20.528273 => 00:17:20.556374
[0m00:17:20.558143 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (compile): 00:17:20.541880 => 00:17:20.557681
[0m00:17:20.559602 [debug] [Thread-1 (]: Began executing node model.mage_case.stg_clientes
[0m00:17:20.560579 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (compile): 00:17:20.546415 => 00:17:20.560177
[0m00:17:20.561482 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (compile): 00:17:20.537923 => 00:17:20.560997
[0m00:17:20.562662 [debug] [Thread-3 (]: Began executing node model.mage_case.stg_produtos
[0m00:17:20.590712 [debug] [Thread-4 (]: Began executing node model.mage_case.stg_vendas
[0m00:17:20.609789 [debug] [Thread-1 (]: Writing runtime sql for node "model.mage_case.stg_clientes"
[0m00:17:20.610766 [debug] [Thread-2 (]: Began executing node model.mage_case.stg_itens_vendas
[0m00:17:20.617226 [debug] [Thread-3 (]: Writing runtime sql for node "model.mage_case.stg_produtos"
[0m00:17:20.626028 [debug] [Thread-4 (]: Writing runtime sql for node "model.mage_case.stg_vendas"
[0m00:17:20.635327 [debug] [Thread-2 (]: Writing runtime sql for node "model.mage_case.stg_itens_vendas"
[0m00:17:20.637768 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:17:20.639835 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:17:20.640984 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: BEGIN
[0m00:17:20.642851 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:17:20.643597 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: BEGIN
[0m00:17:20.644304 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:17:20.645623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:20.647118 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: BEGIN
[0m00:17:20.648154 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:17:20.649351 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: BEGIN
[0m00:17:20.651437 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:17:20.654523 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:17:20.661423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:20.662901 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:20.666064 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:17:20.667273 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:20.668295 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:17:20.668895 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:17:20.670344 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */

  create view "dbt"."public"."stg_clientes__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT 
        *
    FROM
        "dbt"."stg"."clientes"
)

SELECT
    id_cliente,
    nome,
    email,
    cidade,
    estado
FROM
    source
  );
[0m00:17:20.671637 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:17:20.672670 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */

  create view "dbt"."public"."stg_produtos__dbt_tmp"
    
    
  as (
    

select *
from produtos
  );
[0m00:17:20.673856 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:17:20.676094 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "stg.clientes" does not exist
LINE 11:         "dbt"."stg"."clientes"
                 ^

[0m00:17:20.676828 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */

  create view "dbt"."public"."stg_vendas__dbt_tmp"
    
    
  as (
    

select *
from vendas
  );
[0m00:17:20.679136 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */

  create view "dbt"."public"."stg_itens_vendas__dbt_tmp"
    
    
  as (
    

select *
from itens_vendas
  );
[0m00:17:20.681086 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: ROLLBACK
[0m00:17:20.682418 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:17:20.687322 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:17:20.691770 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:17:20.693754 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (execute): 00:17:20.563825 => 00:17:20.693175
[0m00:17:20.714687 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:17:20.726511 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:17:20.735774 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:17:20.737013 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: Close
[0m00:17:20.738611 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
alter table "dbt"."public"."stg_produtos" rename to "stg_produtos__dbt_backup"
[0m00:17:20.739661 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
alter table "dbt"."public"."stg_vendas" rename to "stg_vendas__dbt_backup"
[0m00:17:20.740671 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
alter table "dbt"."public"."stg_itens_vendas" rename to "stg_itens_vendas__dbt_backup"
[0m00:17:20.744310 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:20.747316 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:20.748808 [debug] [Thread-1 (]: Database Error in model stg_clientes (models/stagking/stg_clientes.sql)
  relation "stg.clientes" does not exist
  LINE 11:         "dbt"."stg"."clientes"
                   ^
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.sql
[0m00:17:20.750673 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:20.756585 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:17:20.762597 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:17:20.764413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c41868d-6b69-4f91-aff4-3f1fa9017c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bfd203efe0>]}
[0m00:17:20.771865 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:17:20.773447 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
alter table "dbt"."public"."stg_produtos__dbt_tmp" rename to "stg_produtos"
[0m00:17:20.776367 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
alter table "dbt"."public"."stg_vendas__dbt_tmp" rename to "stg_vendas"
[0m00:17:20.778636 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.stg_clientes ....................... [[31mERROR[0m in 0.25s]
[0m00:17:20.781507 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
alter table "dbt"."public"."stg_itens_vendas__dbt_tmp" rename to "stg_itens_vendas"
[0m00:17:20.785420 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:20.786896 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:20.788463 [debug] [Thread-1 (]: Finished running node model.mage_case.stg_clientes
[0m00:17:20.797481 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:17:20.830587 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: COMMIT
[0m00:17:20.832959 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: COMMIT
[0m00:17:20.836290 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: COMMIT
[0m00:17:20.837726 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:17:20.839138 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:17:20.840299 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:17:20.841249 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: COMMIT
[0m00:17:20.842206 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: COMMIT
[0m00:17:20.843072 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: COMMIT
[0m00:17:20.845019 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:17:20.845599 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m00:17:20.846121 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:17:20.854473 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_produtos__dbt_backup"
[0m00:17:20.858427 [debug] [Thread-4 (]: Applying DROP to: "dbt"."public"."stg_vendas__dbt_backup"
[0m00:17:20.861843 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_itens_vendas__dbt_backup"
[0m00:17:20.867305 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:17:20.868780 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:17:20.870661 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:17:20.871687 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
drop view if exists "dbt"."public"."stg_produtos__dbt_backup" cascade
[0m00:17:20.872759 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
drop view if exists "dbt"."public"."stg_vendas__dbt_backup" cascade
[0m00:17:20.873747 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
drop view if exists "dbt"."public"."stg_itens_vendas__dbt_backup" cascade
[0m00:17:20.876109 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:17:20.876666 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:17:20.879191 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (execute): 00:17:20.611659 => 00:17:20.878956
[0m00:17:20.879671 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:17:20.881630 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (execute): 00:17:20.618210 => 00:17:20.881408
[0m00:17:20.882521 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: Close
[0m00:17:20.884422 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (execute): 00:17:20.628172 => 00:17:20.884204
[0m00:17:20.885483 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: Close
[0m00:17:20.886919 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c41868d-6b69-4f91-aff4-3f1fa9017c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bfd1e8e410>]}
[0m00:17:20.887751 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: Close
[0m00:17:20.889281 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c41868d-6b69-4f91-aff4-3f1fa9017c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bfd1e8e680>]}
[0m00:17:20.891413 [info ] [Thread-3 (]: 3 of 4 OK created sql view model public.stg_produtos ........................... [[32mCREATE VIEW[0m in 0.37s]
[0m00:17:20.893147 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c41868d-6b69-4f91-aff4-3f1fa9017c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bfd1eb3130>]}
[0m00:17:20.894446 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.stg_vendas ............................. [[32mCREATE VIEW[0m in 0.37s]
[0m00:17:20.895820 [debug] [Thread-3 (]: Finished running node model.mage_case.stg_produtos
[0m00:17:20.897207 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.stg_itens_vendas ....................... [[32mCREATE VIEW[0m in 0.38s]
[0m00:17:20.898545 [debug] [Thread-4 (]: Finished running node model.mage_case.stg_vendas
[0m00:17:20.900869 [debug] [Thread-2 (]: Finished running node model.mage_case.stg_itens_vendas
[0m00:17:20.905219 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:20.906265 [debug] [MainThread]: On master: BEGIN
[0m00:17:20.907078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:17:20.916391 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:17:20.917644 [debug] [MainThread]: On master: COMMIT
[0m00:17:20.918557 [debug] [MainThread]: Using postgres connection "master"
[0m00:17:20.919327 [debug] [MainThread]: On master: COMMIT
[0m00:17:20.920308 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:17:20.921043 [debug] [MainThread]: On master: Close
[0m00:17:20.922481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:20.923403 [debug] [MainThread]: Connection 'model.mage_case.stg_clientes' was properly closed.
[0m00:17:20.924657 [debug] [MainThread]: Connection 'model.mage_case.stg_itens_vendas' was properly closed.
[0m00:17:20.925744 [debug] [MainThread]: Connection 'model.mage_case.stg_produtos' was properly closed.
[0m00:17:20.926569 [debug] [MainThread]: Connection 'model.mage_case.stg_vendas' was properly closed.
[0m00:17:20.927384 [info ] [MainThread]: 
[0m00:17:20.928355 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m00:17:20.930802 [debug] [MainThread]: Command end result
[0m00:17:20.954637 [info ] [MainThread]: 
[0m00:17:20.956351 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:17:20.958321 [info ] [MainThread]: 
[0m00:17:20.960333 [error] [MainThread]:   Database Error in model stg_clientes (models/stagking/stg_clientes.sql)
  relation "stg.clientes" does not exist
  LINE 11:         "dbt"."stg"."clientes"
                   ^
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.sql
[0m00:17:20.962218 [info ] [MainThread]: 
[0m00:17:20.964166 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m00:17:20.967788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bfd6999cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bfd1fb3d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bfd1fb3d00>]}
[0m00:17:20.969812 [debug] [MainThread]: Flushing usage events
[0m00:18:11.644592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7771d5db3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7771d64402e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7771d6442260>]}


============================== 00:18:11.650760 | f30e70c7-33d1-491a-8fc2-987b92d615ef ==============================
[0m00:18:11.650760 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:18:11.651901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:18:11.858647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f30e70c7-33d1-491a-8fc2-987b92d615ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7771d4266d70>]}
[0m00:18:11.965075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f30e70c7-33d1-491a-8fc2-987b92d615ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7771d451fbe0>]}
[0m00:18:11.966897 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:18:11.983795 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:18:12.114194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:18:12.116040 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/src_stg.yml
[0m00:18:12.340449 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.mage_case.stg_clientes' (models/stagking/stg_clientes.sql) depends on a source named 'stg.clientes' which was not found
[0m00:18:12.342909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7771d5db3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7771d153a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7771d153b850>]}
[0m00:18:12.344318 [debug] [MainThread]: Flushing usage events
[0m00:19:00.768577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508de67bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508dd1ad810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508ded0a680>]}


============================== 00:19:00.778631 | 8b7f2f84-28df-4c67-aff3-4c600a6e7893 ==============================
[0m00:19:00.778631 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:19:00.780980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:19:01.054734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b7f2f84-28df-4c67-aff3-4c600a6e7893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508dd1ad810>]}
[0m00:19:01.161949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b7f2f84-28df-4c67-aff3-4c600a6e7893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508ded09030>]}
[0m00:19:01.163602 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:19:01.178318 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:19:01.307361 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 2 files changed.
[0m00:19:01.308759 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/src_stg.yml
[0m00:19:01.309698 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/stg_clientes.sql
[0m00:19:01.565983 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.mage_case.stg_clientes' (models/stagking/stg_clientes.sql) depends on a source named 'dbt.clientes' which was not found
[0m00:19:01.568137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508de67bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508d9dfc7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508d9dfc7f0>]}
[0m00:19:01.569383 [debug] [MainThread]: Flushing usage events
[0m00:19:22.908164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734507593310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7345060bb100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734507c142b0>]}


============================== 00:19:22.914178 | d60ed838-e776-4f7e-88ac-f48af3a28b88 ==============================
[0m00:19:22.914178 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:19:22.915420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:19:23.135164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd60ed838-e776-4f7e-88ac-f48af3a28b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7345060bb100>]}
[0m00:19:23.238176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd60ed838-e776-4f7e-88ac-f48af3a28b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734505cf7ee0>]}
[0m00:19:23.240077 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:19:23.255419 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:19:23.397627 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 2 files changed.
[0m00:19:23.399653 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/src_stg.yml
[0m00:19:23.401336 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/stg_clientes.sql
[0m00:19:23.722362 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.data_mart
- models.mage_case.staging
[0m00:19:23.729005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd60ed838-e776-4f7e-88ac-f48af3a28b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734502dd00d0>]}
[0m00:19:23.759433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd60ed838-e776-4f7e-88ac-f48af3a28b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734503e91a50>]}
[0m00:19:23.760751 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:19:23.762147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd60ed838-e776-4f7e-88ac-f48af3a28b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734503e91ba0>]}
[0m00:19:23.765241 [info ] [MainThread]: 
[0m00:19:23.767353 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:19:23.769940 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:19:23.783898 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:19:23.785456 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:19:23.786654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:23.801595 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m00:19:23.803823 [debug] [ThreadPool]: On list_dbt: Close
[0m00:19:23.806499 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_public)
[0m00:19:23.815149 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:19:23.816411 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:19:23.817368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:23.827093 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:19:23.828138 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:19:23.829030 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:19:23.833074 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:19:23.834992 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:19:23.835959 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:19:23.842724 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:23.843691 [debug] [MainThread]: On master: BEGIN
[0m00:19:23.844515 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:19:23.852917 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:19:23.854122 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:23.855244 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:19:23.860647 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m00:19:23.863525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd60ed838-e776-4f7e-88ac-f48af3a28b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734503f3bdc0>]}
[0m00:19:23.864539 [debug] [MainThread]: On master: ROLLBACK
[0m00:19:23.865620 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:23.866352 [debug] [MainThread]: On master: BEGIN
[0m00:19:23.867580 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:19:23.868374 [debug] [MainThread]: On master: COMMIT
[0m00:19:23.869098 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:23.870142 [debug] [MainThread]: On master: COMMIT
[0m00:19:23.871184 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:19:23.872064 [debug] [MainThread]: On master: Close
[0m00:19:23.873249 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:19:23.874301 [info ] [MainThread]: 
[0m00:19:23.883361 [debug] [Thread-1 (]: Began running node model.mage_case.stg_clientes
[0m00:19:23.884002 [debug] [Thread-2 (]: Began running node model.mage_case.stg_itens_vendas
[0m00:19:23.884504 [debug] [Thread-3 (]: Began running node model.mage_case.stg_produtos
[0m00:19:23.884976 [debug] [Thread-4 (]: Began running node model.mage_case.stg_vendas
[0m00:19:23.885876 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_clientes ................................ [RUN]
[0m00:19:23.887342 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_itens_vendas ............................ [RUN]
[0m00:19:23.888981 [info ] [Thread-3 (]: 3 of 4 START sql view model public.stg_produtos ................................ [RUN]
[0m00:19:23.890635 [info ] [Thread-4 (]: 4 of 4 START sql view model public.stg_vendas .................................. [RUN]
[0m00:19:23.893473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now model.mage_case.stg_clientes)
[0m00:19:23.895498 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.mage_case.stg_itens_vendas'
[0m00:19:23.897529 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.mage_case.stg_produtos'
[0m00:19:23.899323 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.mage_case.stg_vendas'
[0m00:19:23.900765 [debug] [Thread-1 (]: Began compiling node model.mage_case.stg_clientes
[0m00:19:23.902107 [debug] [Thread-2 (]: Began compiling node model.mage_case.stg_itens_vendas
[0m00:19:23.903151 [debug] [Thread-3 (]: Began compiling node model.mage_case.stg_produtos
[0m00:19:23.904043 [debug] [Thread-4 (]: Began compiling node model.mage_case.stg_vendas
[0m00:19:23.913474 [debug] [Thread-1 (]: Writing injected SQL for node "model.mage_case.stg_clientes"
[0m00:19:23.917500 [debug] [Thread-2 (]: Writing injected SQL for node "model.mage_case.stg_itens_vendas"
[0m00:19:23.923973 [debug] [Thread-3 (]: Writing injected SQL for node "model.mage_case.stg_produtos"
[0m00:19:23.988152 [debug] [Thread-4 (]: Writing injected SQL for node "model.mage_case.stg_vendas"
[0m00:19:23.998718 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (compile): 00:19:23.914352 => 00:19:23.997921
[0m00:19:23.999928 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (compile): 00:19:23.904861 => 00:19:23.999285
[0m00:19:24.002526 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (compile): 00:19:23.918597 => 00:19:24.001427
[0m00:19:24.004268 [debug] [Thread-2 (]: Began executing node model.mage_case.stg_itens_vendas
[0m00:19:24.006304 [debug] [Thread-1 (]: Began executing node model.mage_case.stg_clientes
[0m00:19:24.007326 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (compile): 00:19:23.924916 => 00:19:24.006791
[0m00:19:24.009274 [debug] [Thread-3 (]: Began executing node model.mage_case.stg_produtos
[0m00:19:24.064032 [debug] [Thread-2 (]: Writing runtime sql for node "model.mage_case.stg_itens_vendas"
[0m00:19:24.066600 [debug] [Thread-1 (]: Writing runtime sql for node "model.mage_case.stg_clientes"
[0m00:19:24.067257 [debug] [Thread-4 (]: Began executing node model.mage_case.stg_vendas
[0m00:19:24.073537 [debug] [Thread-3 (]: Writing runtime sql for node "model.mage_case.stg_produtos"
[0m00:19:24.080733 [debug] [Thread-4 (]: Writing runtime sql for node "model.mage_case.stg_vendas"
[0m00:19:24.085869 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:19:24.087557 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:19:24.088699 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:19:24.089434 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: BEGIN
[0m00:19:24.090128 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:19:24.091457 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: BEGIN
[0m00:19:24.093185 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: BEGIN
[0m00:19:24.094461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:24.095806 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: BEGIN
[0m00:19:24.097172 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:19:24.098401 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:19:24.100542 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:19:24.109604 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:19:24.111118 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:19:24.112071 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:19:24.112513 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:19:24.113278 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */

  create view "dbt"."public"."stg_clientes__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT 
        *
    FROM
        "dbt"."public"."clientes"
)

SELECT
    id_cliente,
    nome,
    email,
    cidade,
    estado
FROM
    source
  );
[0m00:19:24.114334 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:19:24.115388 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:19:24.116301 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:19:24.117475 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */

  create view "dbt"."public"."stg_itens_vendas__dbt_tmp"
    
    
  as (
    

select *
from itens_vendas
  );
[0m00:19:24.118400 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */

  create view "dbt"."public"."stg_produtos__dbt_tmp"
    
    
  as (
    

select *
from produtos
  );
[0m00:19:24.118870 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:19:24.119670 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:19:24.127129 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:19:24.127639 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:19:24.130327 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:19:24.131379 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */

  create view "dbt"."public"."stg_vendas__dbt_tmp"
    
    
  as (
    

select *
from vendas
  );
[0m00:19:24.135678 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:19:24.140639 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:19:24.142190 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */
alter table "dbt"."public"."stg_clientes" rename to "stg_clientes__dbt_backup"
[0m00:19:24.144174 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
alter table "dbt"."public"."stg_itens_vendas" rename to "stg_itens_vendas__dbt_backup"
[0m00:19:24.145205 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:19:24.145700 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
alter table "dbt"."public"."stg_produtos" rename to "stg_produtos__dbt_backup"
[0m00:19:24.147289 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:24.148257 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:24.151915 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:19:24.153474 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:24.156904 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:19:24.160895 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:19:24.162034 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
alter table "dbt"."public"."stg_vendas" rename to "stg_vendas__dbt_backup"
[0m00:19:24.165840 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:19:24.167070 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */
alter table "dbt"."public"."stg_clientes__dbt_tmp" rename to "stg_clientes"
[0m00:19:24.168506 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
alter table "dbt"."public"."stg_itens_vendas__dbt_tmp" rename to "stg_itens_vendas"
[0m00:19:24.170032 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:24.170499 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
alter table "dbt"."public"."stg_produtos__dbt_tmp" rename to "stg_produtos"
[0m00:19:24.171857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:24.172876 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:24.176434 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:19:24.177808 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:24.197191 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: COMMIT
[0m00:19:24.199199 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: COMMIT
[0m00:19:24.200831 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
alter table "dbt"."public"."stg_vendas__dbt_tmp" rename to "stg_vendas"
[0m00:19:24.203902 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: COMMIT
[0m00:19:24.205406 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:19:24.206283 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:19:24.207799 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:24.208265 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:19:24.209234 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: COMMIT
[0m00:19:24.210102 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: COMMIT
[0m00:19:24.212738 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: COMMIT
[0m00:19:24.213663 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: COMMIT
[0m00:19:24.215721 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:19:24.216350 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:19:24.216975 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:19:24.223688 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:19:24.225710 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."stg_clientes__dbt_backup"
[0m00:19:24.229796 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_itens_vendas__dbt_backup"
[0m00:19:24.231060 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: COMMIT
[0m00:19:24.235561 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_produtos__dbt_backup"
[0m00:19:24.243505 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:19:24.245887 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:19:24.249147 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:19:24.249677 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m00:19:24.250895 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */
drop view if exists "dbt"."public"."stg_clientes__dbt_backup" cascade
[0m00:19:24.252109 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
drop view if exists "dbt"."public"."stg_itens_vendas__dbt_backup" cascade
[0m00:19:24.253153 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
drop view if exists "dbt"."public"."stg_produtos__dbt_backup" cascade
[0m00:19:24.256749 [debug] [Thread-4 (]: Applying DROP to: "dbt"."public"."stg_vendas__dbt_backup"
[0m00:19:24.260314 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:19:24.260802 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:19:24.261224 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:19:24.261643 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:19:24.262236 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
drop view if exists "dbt"."public"."stg_vendas__dbt_backup" cascade
[0m00:19:24.264405 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (execute): 00:19:24.032766 => 00:19:24.264174
[0m00:19:24.266505 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (execute): 00:19:24.010894 => 00:19:24.266231
[0m00:19:24.268477 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (execute): 00:19:24.068521 => 00:19:24.268259
[0m00:19:24.269904 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: Close
[0m00:19:24.270780 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:19:24.271418 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: Close
[0m00:19:24.272319 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: Close
[0m00:19:24.273676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd60ed838-e776-4f7e-88ac-f48af3a28b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734502cacc70>]}
[0m00:19:24.275668 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (execute): 00:19:24.075727 => 00:19:24.275431
[0m00:19:24.277215 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd60ed838-e776-4f7e-88ac-f48af3a28b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734502e45990>]}
[0m00:19:24.278552 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd60ed838-e776-4f7e-88ac-f48af3a28b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734502caf910>]}
[0m00:19:24.279818 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.stg_clientes ........................... [[32mCREATE VIEW[0m in 0.38s]
[0m00:19:24.280887 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: Close
[0m00:19:24.282155 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.stg_itens_vendas ....................... [[32mCREATE VIEW[0m in 0.38s]
[0m00:19:24.283432 [info ] [Thread-3 (]: 3 of 4 OK created sql view model public.stg_produtos ........................... [[32mCREATE VIEW[0m in 0.38s]
[0m00:19:24.284862 [debug] [Thread-1 (]: Finished running node model.mage_case.stg_clientes
[0m00:19:24.286461 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd60ed838-e776-4f7e-88ac-f48af3a28b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734502e39ba0>]}
[0m00:19:24.287858 [debug] [Thread-2 (]: Finished running node model.mage_case.stg_itens_vendas
[0m00:19:24.289309 [debug] [Thread-3 (]: Finished running node model.mage_case.stg_produtos
[0m00:19:24.291605 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.stg_vendas ............................. [[32mCREATE VIEW[0m in 0.39s]
[0m00:19:24.295567 [debug] [Thread-4 (]: Finished running node model.mage_case.stg_vendas
[0m00:19:24.299011 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:24.300124 [debug] [MainThread]: On master: BEGIN
[0m00:19:24.301072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:19:24.310667 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:19:24.311833 [debug] [MainThread]: On master: COMMIT
[0m00:19:24.312713 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:24.313503 [debug] [MainThread]: On master: COMMIT
[0m00:19:24.314567 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:19:24.315774 [debug] [MainThread]: On master: Close
[0m00:19:24.317169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:24.317979 [debug] [MainThread]: Connection 'model.mage_case.stg_clientes' was properly closed.
[0m00:19:24.318773 [debug] [MainThread]: Connection 'model.mage_case.stg_itens_vendas' was properly closed.
[0m00:19:24.319582 [debug] [MainThread]: Connection 'model.mage_case.stg_produtos' was properly closed.
[0m00:19:24.321005 [debug] [MainThread]: Connection 'model.mage_case.stg_vendas' was properly closed.
[0m00:19:24.323095 [info ] [MainThread]: 
[0m00:19:24.324614 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m00:19:24.327427 [debug] [MainThread]: Command end result
[0m00:19:24.351379 [info ] [MainThread]: 
[0m00:19:24.353021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:19:24.355145 [info ] [MainThread]: 
[0m00:19:24.357960 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:19:24.360924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734507593310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734505cf7ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7345059b86a0>]}
[0m00:19:24.362831 [debug] [MainThread]: Flushing usage events
[0m00:25:09.271234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c37d046f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c37d0afc6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c37d0afd7b0>]}


============================== 00:25:09.277285 | a0cb8641-526b-4dcf-a759-bd21cba196f1 ==============================
[0m00:25:09.277285 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:25:09.278502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:25:09.384563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0cb8641-526b-4dcf-a759-bd21cba196f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c37cf0ee770>]}
[0m00:25:09.388716 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-50_updx9'
[0m00:25:09.390020 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:25:09.525373 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:25:09.528096 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:25:09.602390 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:25:09.617123 [info ] [MainThread]: Updating lock file in file path: /usr/app/package-lock.yml
[0m00:25:09.630361 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ujzddnau'
[0m00:25:09.635275 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:25:13.423243 [info ] [MainThread]: Installed from version 1.3.0
[0m00:25:13.424526 [info ] [MainThread]: Up to date!
[0m00:25:13.425737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a0cb8641-526b-4dcf-a759-bd21cba196f1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c37cebdbd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c37ce923fa0>]}
[0m00:25:13.427543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c37d046f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c37ce922080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c37cebda470>]}
[0m00:25:13.428457 [debug] [MainThread]: Flushing usage events
[0m00:25:27.248228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7f006c7730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7f00d4a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7f00d49ea0>]}


============================== 00:25:27.254275 | 5cf4f5c2-67fa-460d-bc11-65a3f3cf99fa ==============================
[0m00:25:27.254275 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:25:27.255374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:25:27.487710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cf4f5c2-67fa-460d-bc11-65a3f3cf99fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7efeb6ad70>]}
[0m00:25:27.586939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cf4f5c2-67fa-460d-bc11-65a3f3cf99fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7efee2bbe0>]}
[0m00:25:27.588853 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:25:27.616310 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:25:27.640212 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m00:25:27.641573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5cf4f5c2-67fa-460d-bc11-65a3f3cf99fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7efd26f3a0>]}
[0m00:25:29.983868 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.data_mart
- models.mage_case.staging
[0m00:25:29.992338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cf4f5c2-67fa-460d-bc11-65a3f3cf99fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee7be00d0>]}
[0m00:25:30.029644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cf4f5c2-67fa-460d-bc11-65a3f3cf99fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee7babac0>]}
[0m00:25:30.030935 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m00:25:30.032504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cf4f5c2-67fa-460d-bc11-65a3f3cf99fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7efd0a11e0>]}
[0m00:25:30.036290 [info ] [MainThread]: 
[0m00:25:30.039309 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:25:30.043023 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:25:30.059240 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:25:30.060762 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:25:30.062209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:25:30.075340 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m00:25:30.078033 [debug] [ThreadPool]: On list_dbt: Close
[0m00:25:30.081300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_public)
[0m00:25:30.091024 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:25:30.092376 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:25:30.093474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:25:30.105006 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:25:30.106499 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:25:30.108068 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:25:30.113246 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:25:30.115621 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:25:30.117498 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:25:30.126007 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:30.127375 [debug] [MainThread]: On master: BEGIN
[0m00:25:30.128586 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:25:30.137970 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:25:30.139279 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:30.140314 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:25:30.145790 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m00:25:30.148877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cf4f5c2-67fa-460d-bc11-65a3f3cf99fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee7a1fca0>]}
[0m00:25:30.150106 [debug] [MainThread]: On master: ROLLBACK
[0m00:25:30.151437 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:30.152486 [debug] [MainThread]: On master: BEGIN
[0m00:25:30.153787 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:25:30.154666 [debug] [MainThread]: On master: COMMIT
[0m00:25:30.155499 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:30.156321 [debug] [MainThread]: On master: COMMIT
[0m00:25:30.157457 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:25:30.158305 [debug] [MainThread]: On master: Close
[0m00:25:30.159565 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:25:30.160662 [info ] [MainThread]: 
[0m00:25:30.170723 [debug] [Thread-1 (]: Began running node model.mage_case.stg_clientes
[0m00:25:30.171316 [debug] [Thread-2 (]: Began running node model.mage_case.stg_itens_vendas
[0m00:25:30.171868 [debug] [Thread-3 (]: Began running node model.mage_case.stg_produtos
[0m00:25:30.172352 [debug] [Thread-4 (]: Began running node model.mage_case.stg_vendas
[0m00:25:30.173153 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_clientes ................................ [RUN]
[0m00:25:30.174379 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_itens_vendas ............................ [RUN]
[0m00:25:30.176328 [info ] [Thread-3 (]: 3 of 4 START sql view model public.stg_produtos ................................ [RUN]
[0m00:25:30.178048 [info ] [Thread-4 (]: 4 of 4 START sql view model public.stg_vendas .................................. [RUN]
[0m00:25:30.180244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now model.mage_case.stg_clientes)
[0m00:25:30.182466 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.mage_case.stg_itens_vendas'
[0m00:25:30.184673 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.mage_case.stg_produtos'
[0m00:25:30.187040 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.mage_case.stg_vendas'
[0m00:25:30.188573 [debug] [Thread-1 (]: Began compiling node model.mage_case.stg_clientes
[0m00:25:30.191087 [debug] [Thread-2 (]: Began compiling node model.mage_case.stg_itens_vendas
[0m00:25:30.192551 [debug] [Thread-3 (]: Began compiling node model.mage_case.stg_produtos
[0m00:25:30.193900 [debug] [Thread-4 (]: Began compiling node model.mage_case.stg_vendas
[0m00:25:30.205343 [debug] [Thread-1 (]: Writing injected SQL for node "model.mage_case.stg_clientes"
[0m00:25:30.210715 [debug] [Thread-2 (]: Writing injected SQL for node "model.mage_case.stg_itens_vendas"
[0m00:25:30.215853 [debug] [Thread-3 (]: Writing injected SQL for node "model.mage_case.stg_produtos"
[0m00:25:30.220662 [debug] [Thread-4 (]: Writing injected SQL for node "model.mage_case.stg_vendas"
[0m00:25:30.228061 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (compile): 00:25:30.195056 => 00:25:30.227457
[0m00:25:30.229557 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (compile): 00:25:30.206909 => 00:25:30.229037
[0m00:25:30.230303 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (compile): 00:25:30.212350 => 00:25:30.230030
[0m00:25:30.231148 [debug] [Thread-1 (]: Began executing node model.mage_case.stg_clientes
[0m00:25:30.231966 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (compile): 00:25:30.217390 => 00:25:30.231682
[0m00:25:30.232806 [debug] [Thread-2 (]: Began executing node model.mage_case.stg_itens_vendas
[0m00:25:30.233772 [debug] [Thread-3 (]: Began executing node model.mage_case.stg_produtos
[0m00:25:30.257613 [debug] [Thread-4 (]: Began executing node model.mage_case.stg_vendas
[0m00:25:30.272605 [debug] [Thread-1 (]: Writing runtime sql for node "model.mage_case.stg_clientes"
[0m00:25:30.280013 [debug] [Thread-2 (]: Writing runtime sql for node "model.mage_case.stg_itens_vendas"
[0m00:25:30.343122 [debug] [Thread-3 (]: Writing runtime sql for node "model.mage_case.stg_produtos"
[0m00:25:30.351235 [debug] [Thread-4 (]: Writing runtime sql for node "model.mage_case.stg_vendas"
[0m00:25:30.359730 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:25:30.360500 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:25:30.361930 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: BEGIN
[0m00:25:30.362720 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:25:30.363753 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:25:30.364270 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: BEGIN
[0m00:25:30.365323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:25:30.366288 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: BEGIN
[0m00:25:30.367239 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: BEGIN
[0m00:25:30.368200 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:25:30.370009 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:25:30.371714 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:25:30.379097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:25:30.382959 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:25:30.383606 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:25:30.384130 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:25:30.385274 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:25:30.385786 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:25:30.387015 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:25:30.388186 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */

  create view "dbt"."public"."stg_clientes__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT 
        *
    FROM
        "dbt"."public"."clientes"
)

SELECT
    id_cliente,
    nome,
    email,
    cidade,
    estado
FROM
    source
  );
[0m00:25:30.389091 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:25:30.389993 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */

  create view "dbt"."public"."stg_produtos__dbt_tmp"
    
    
  as (
    

select *
from produtos
  );
[0m00:25:30.391065 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */

  create view "dbt"."public"."stg_itens_vendas__dbt_tmp"
    
    
  as (
    

select *
from itens_vendas
  );
[0m00:25:30.392604 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */

  create view "dbt"."public"."stg_vendas__dbt_tmp"
    
    
  as (
    

select *
from vendas
  );
[0m00:25:30.394357 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:25:30.394883 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:25:30.396101 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:25:30.403535 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:25:30.404050 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:25:30.408375 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:25:30.412546 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:25:30.413981 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */
alter table "dbt"."public"."stg_clientes" rename to "stg_clientes__dbt_backup"
[0m00:25:30.419301 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:25:30.420808 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
alter table "dbt"."public"."stg_produtos" rename to "stg_produtos__dbt_backup"
[0m00:25:30.422150 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
alter table "dbt"."public"."stg_itens_vendas" rename to "stg_itens_vendas__dbt_backup"
[0m00:25:30.423734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:25:30.424158 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
alter table "dbt"."public"."stg_vendas" rename to "stg_vendas__dbt_backup"
[0m00:25:30.425482 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:25:30.426468 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:25:30.430063 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:25:30.431485 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:25:30.435116 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:25:30.439130 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:25:30.440297 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */
alter table "dbt"."public"."stg_clientes__dbt_tmp" rename to "stg_clientes"
[0m00:25:30.444281 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:25:30.445559 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
alter table "dbt"."public"."stg_produtos__dbt_tmp" rename to "stg_produtos"
[0m00:25:30.446741 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
alter table "dbt"."public"."stg_itens_vendas__dbt_tmp" rename to "stg_itens_vendas"
[0m00:25:30.448439 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:25:30.449069 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
alter table "dbt"."public"."stg_vendas__dbt_tmp" rename to "stg_vendas"
[0m00:25:30.450552 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:25:30.451344 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:25:30.476016 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: COMMIT
[0m00:25:30.476626 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:25:30.479301 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: COMMIT
[0m00:25:30.482279 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: COMMIT
[0m00:25:30.483501 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:25:30.486131 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: COMMIT
[0m00:25:30.487027 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:25:30.488083 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:25:30.489016 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: COMMIT
[0m00:25:30.489805 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:25:30.490694 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: COMMIT
[0m00:25:30.491595 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: COMMIT
[0m00:25:30.493337 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: COMMIT
[0m00:25:30.493797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:25:30.495247 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:25:30.495734 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:25:30.501996 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m00:25:30.504496 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."stg_clientes__dbt_backup"
[0m00:25:30.509536 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_produtos__dbt_backup"
[0m00:25:30.513456 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_itens_vendas__dbt_backup"
[0m00:25:30.517032 [debug] [Thread-4 (]: Applying DROP to: "dbt"."public"."stg_vendas__dbt_backup"
[0m00:25:30.522867 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:25:30.524953 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:25:30.526990 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:25:30.528474 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:25:30.529711 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */
drop view if exists "dbt"."public"."stg_clientes__dbt_backup" cascade
[0m00:25:30.530855 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
drop view if exists "dbt"."public"."stg_produtos__dbt_backup" cascade
[0m00:25:30.532032 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
drop view if exists "dbt"."public"."stg_itens_vendas__dbt_backup" cascade
[0m00:25:30.533079 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
drop view if exists "dbt"."public"."stg_vendas__dbt_backup" cascade
[0m00:25:30.535546 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:25:30.536519 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:25:30.537485 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:25:30.539554 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (execute): 00:25:30.234662 => 00:25:30.539308
[0m00:25:30.540025 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:25:30.541916 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (execute): 00:25:30.281095 => 00:25:30.541692
[0m00:25:30.543853 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (execute): 00:25:30.273803 => 00:25:30.543636
[0m00:25:30.544742 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: Close
[0m00:25:30.546613 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (execute): 00:25:30.344159 => 00:25:30.546394
[0m00:25:30.547490 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: Close
[0m00:25:30.548397 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: Close
[0m00:25:30.549769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cf4f5c2-67fa-460d-bc11-65a3f3cf99fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee7a91900>]}
[0m00:25:30.551933 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: Close
[0m00:25:30.553360 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cf4f5c2-67fa-460d-bc11-65a3f3cf99fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee7be08e0>]}
[0m00:25:30.554572 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cf4f5c2-67fa-460d-bc11-65a3f3cf99fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee793ff10>]}
[0m00:25:30.555714 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.stg_clientes ........................... [[32mCREATE VIEW[0m in 0.37s]
[0m00:25:30.557409 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cf4f5c2-67fa-460d-bc11-65a3f3cf99fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee790f670>]}
[0m00:25:30.558680 [info ] [Thread-3 (]: 3 of 4 OK created sql view model public.stg_produtos ........................... [[32mCREATE VIEW[0m in 0.37s]
[0m00:25:30.560238 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.stg_itens_vendas ....................... [[32mCREATE VIEW[0m in 0.37s]
[0m00:25:30.561833 [debug] [Thread-1 (]: Finished running node model.mage_case.stg_clientes
[0m00:25:30.563327 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.stg_vendas ............................. [[32mCREATE VIEW[0m in 0.37s]
[0m00:25:30.565091 [debug] [Thread-3 (]: Finished running node model.mage_case.stg_produtos
[0m00:25:30.566700 [debug] [Thread-2 (]: Finished running node model.mage_case.stg_itens_vendas
[0m00:25:30.569364 [debug] [Thread-4 (]: Finished running node model.mage_case.stg_vendas
[0m00:25:30.574611 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:30.576255 [debug] [MainThread]: On master: BEGIN
[0m00:25:30.578002 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:25:30.588438 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:25:30.590009 [debug] [MainThread]: On master: COMMIT
[0m00:25:30.591225 [debug] [MainThread]: Using postgres connection "master"
[0m00:25:30.592364 [debug] [MainThread]: On master: COMMIT
[0m00:25:30.593621 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:25:30.594519 [debug] [MainThread]: On master: Close
[0m00:25:30.596036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:25:30.597534 [debug] [MainThread]: Connection 'model.mage_case.stg_clientes' was properly closed.
[0m00:25:30.598922 [debug] [MainThread]: Connection 'model.mage_case.stg_itens_vendas' was properly closed.
[0m00:25:30.599828 [debug] [MainThread]: Connection 'model.mage_case.stg_produtos' was properly closed.
[0m00:25:30.600617 [debug] [MainThread]: Connection 'model.mage_case.stg_vendas' was properly closed.
[0m00:25:30.601524 [info ] [MainThread]: 
[0m00:25:30.602595 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m00:25:30.605593 [debug] [MainThread]: Command end result
[0m00:25:30.638569 [info ] [MainThread]: 
[0m00:25:30.640606 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:25:30.642476 [info ] [MainThread]: 
[0m00:25:30.644378 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:25:30.647525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7f006c7730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee7be0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ee7be0b50>]}
[0m00:25:30.649220 [debug] [MainThread]: Flushing usage events
[0m00:26:18.939811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736352dd7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7363518f6e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736353458d30>]}


============================== 00:26:18.946025 | bd8b1c32-c087-4b50-812d-9a17d122bc2b ==============================
[0m00:26:18.946025 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:26:18.947219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m00:26:19.187471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd8b1c32-c087-4b50-812d-9a17d122bc2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7363518f6e60>]}
[0m00:26:19.284546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd8b1c32-c087-4b50-812d-9a17d122bc2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73635153bee0>]}
[0m00:26:19.286476 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:26:19.315792 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:26:20.090792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:26:20.091709 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:26:20.092810 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.staging
- models.mage_case.data_mart
[0m00:26:20.099775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd8b1c32-c087-4b50-812d-9a17d122bc2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73634f64c4c0>]}
[0m00:26:20.132460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd8b1c32-c087-4b50-812d-9a17d122bc2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73634f610640>]}
[0m00:26:20.133657 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m00:26:20.134841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd8b1c32-c087-4b50-812d-9a17d122bc2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73634f6108b0>]}
[0m00:26:20.137782 [info ] [MainThread]: 
[0m00:26:20.140131 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:26:20.143127 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m00:26:20.158407 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:26:20.159711 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:26:20.160633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:26:20.172213 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:26:20.173983 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:26:20.175842 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:26:20.181046 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:26:20.183554 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:26:20.185256 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:26:20.194500 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:20.195978 [debug] [MainThread]: On master: BEGIN
[0m00:26:20.196914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:26:20.207435 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:26:20.209082 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:20.210295 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:26:20.216311 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m00:26:20.219085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd8b1c32-c087-4b50-812d-9a17d122bc2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73634f602e60>]}
[0m00:26:20.220098 [debug] [MainThread]: On master: ROLLBACK
[0m00:26:20.221183 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:20.221924 [debug] [MainThread]: On master: BEGIN
[0m00:26:20.223143 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:26:20.224026 [debug] [MainThread]: On master: COMMIT
[0m00:26:20.224760 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:20.225479 [debug] [MainThread]: On master: COMMIT
[0m00:26:20.226356 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:26:20.227095 [debug] [MainThread]: On master: Close
[0m00:26:20.228237 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:26:20.229225 [info ] [MainThread]: 
[0m00:26:20.237843 [debug] [Thread-1 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011
[0m00:26:20.238383 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:26:20.239035 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:26:20.239766 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:26:20.240540 [info ] [Thread-1 (]: 1 of 8 START test dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2  [RUN]
[0m00:26:20.241730 [info ] [Thread-2 (]: 2 of 8 START test not_null_stg_clientes_cidade ................................. [RUN]
[0m00:26:20.242927 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_clientes_email .................................. [RUN]
[0m00:26:20.244040 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_clientes_estado ................................. [RUN]
[0m00:26:20.245808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011)
[0m00:26:20.247912 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73'
[0m00:26:20.250060 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_email.d1824e153a'
[0m00:26:20.251684 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_estado.33c8769c0b'
[0m00:26:20.252650 [debug] [Thread-1 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011
[0m00:26:20.254032 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:26:20.256730 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:26:20.258889 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:26:20.287664 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011"
[0m00:26:20.293160 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:26:20.301115 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:26:20.307129 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:26:20.317559 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (compile): 00:26:20.296111 => 00:26:20.317117
[0m00:26:20.319252 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:26:20.320215 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (compile): 00:26:20.302458 => 00:26:20.319893
[0m00:26:20.326949 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (compile): 00:26:20.282307 => 00:26:20.326278
[0m00:26:20.327836 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011 (compile): 00:26:20.260123 => 00:26:20.327404
[0m00:26:20.342297 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:26:20.343623 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:26:20.345149 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:26:20.346429 [debug] [Thread-1 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011
[0m00:26:20.350960 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:26:20.354231 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:26:20.358897 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011"
[0m00:26:20.364481 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:26:20.366140 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: BEGIN
[0m00:26:20.367120 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:26:20.368376 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011"
[0m00:26:20.369050 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:26:20.370494 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: BEGIN
[0m00:26:20.371184 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:26:20.372661 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011: BEGIN
[0m00:26:20.375337 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:26:20.376843 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: BEGIN
[0m00:26:20.378243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:26:20.380956 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:26:20.384884 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:26:20.386177 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:26:20.387446 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_email.d1824e153a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from "dbt"."public"."stg_clientes"
where email is null



      
    ) dbt_internal_test
[0m00:26:20.389367 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:26:20.390571 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:26:20.391701 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cidade
from "dbt"."public"."stg_clientes"
where cidade is null



      
    ) dbt_internal_test
[0m00:26:20.392182 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:26:20.393561 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:26:20.394155 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:26:20.396352 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (execute): 00:26:20.321073 => 00:26:20.396050
[0m00:26:20.397312 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:26:20.398085 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011"
[0m00:26:20.400204 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (execute): 00:26:20.351824 => 00:26:20.399946
[0m00:26:20.401341 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: ROLLBACK
[0m00:26:20.402491 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:26:20.403458 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_clientes"

where not(estado char_length(estado) = 2)


      
    ) dbt_internal_test
[0m00:26:20.404293 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: ROLLBACK
[0m00:26:20.405419 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: Close
[0m00:26:20.406044 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select estado
from "dbt"."public"."stg_clientes"
where estado is null



      
    ) dbt_internal_test
[0m00:26:20.407552 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "char_length"
LINE 15: where not(estado char_length(estado) = 2)
                          ^

[0m00:26:20.408160 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: Close
[0m00:26:20.409468 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_clientes_email ........................................ [[32mPASS[0m in 0.16s]
[0m00:26:20.411234 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011: ROLLBACK
[0m00:26:20.411828 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:26:20.413347 [info ] [Thread-2 (]: 2 of 8 PASS not_null_stg_clientes_cidade ....................................... [[32mPASS[0m in 0.17s]
[0m00:26:20.414733 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:26:20.416232 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011 (execute): 00:26:20.355277 => 00:26:20.415900
[0m00:26:20.418409 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (execute): 00:26:20.348356 => 00:26:20.418082
[0m00:26:20.419718 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:26:20.421221 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:26:20.422617 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011: Close
[0m00:26:20.424199 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: ROLLBACK
[0m00:26:20.425846 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:26:20.427350 [info ] [Thread-3 (]: 5 of 8 START test not_null_stg_clientes_id_cliente ............................. [RUN]
[0m00:26:20.432683 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: Close
[0m00:26:20.434350 [info ] [Thread-2 (]: 6 of 8 START test not_null_stg_clientes_nome ................................... [RUN]
[0m00:26:20.436610 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_email.d1824e153a, now test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2)
[0m00:26:20.438239 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2 (models/stagking/stg_clientes.yml)
  syntax error at or near "char_length"
  LINE 15: where not(estado char_length(estado) = 2)
                            ^
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.yml/dbt_utils_expression_is_true_s_8eb9cc185edfbc26f8cf0f06e318d10c.sql
[0m00:26:20.440504 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_clientes_estado ....................................... [[32mPASS[0m in 0.19s]
[0m00:26:20.442744 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73, now test.mage_case.not_null_stg_clientes_nome.04166b95e6)
[0m00:26:20.444380 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:26:20.445848 [error] [Thread-1 (]: 1 of 8 ERROR dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2  [[31mERROR[0m in 0.20s]
[0m00:26:20.448085 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:26:20.450302 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:26:20.459289 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:26:20.460936 [debug] [Thread-1 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011
[0m00:26:20.462966 [debug] [Thread-4 (]: Began running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:26:20.470773 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:26:20.474619 [debug] [Thread-1 (]: Began running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:26:20.476873 [info ] [Thread-4 (]: 7 of 8 START test unique_stg_clientes_email .................................... [RUN]
[0m00:26:20.480125 [info ] [Thread-1 (]: 8 of 8 START test unique_stg_clientes_id_cliente ............................... [RUN]
[0m00:26:20.483199 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_estado.33c8769c0b, now test.mage_case.unique_stg_clientes_email.2b7c7e0aff)
[0m00:26:20.486458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011, now test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3)
[0m00:26:20.487939 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (compile): 00:26:20.451950 => 00:26:20.487388
[0m00:26:20.489745 [debug] [Thread-4 (]: Began compiling node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:26:20.491957 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (compile): 00:26:20.464468 => 00:26:20.491351
[0m00:26:20.492709 [debug] [Thread-1 (]: Began compiling node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:26:20.494628 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:26:20.504926 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:26:20.506869 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:26:20.515284 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:26:20.519760 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:26:20.525979 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:26:20.532377 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (compile): 00:26:20.495947 => 00:26:20.531764
[0m00:26:20.534093 [debug] [Thread-4 (]: Began executing node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:26:20.535005 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:26:20.535963 [debug] [Thread-1 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (compile): 00:26:20.508940 => 00:26:20.535506
[0m00:26:20.594354 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:26:20.595136 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:26:20.596607 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: BEGIN
[0m00:26:20.598605 [debug] [Thread-1 (]: Began executing node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:26:20.601232 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: BEGIN
[0m00:26:20.602695 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:26:20.607266 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:26:20.608929 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:26:20.614110 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:26:20.615934 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: BEGIN
[0m00:26:20.617576 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:26:20.618456 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:26:20.620993 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: BEGIN
[0m00:26:20.622795 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:26:20.623665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:26:20.625019 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:26:20.626644 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:26:20.628777 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_cliente
from "dbt"."public"."stg_clientes"
where id_cliente is null



      
    ) dbt_internal_test
[0m00:26:20.630548 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:26:20.631828 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:26:20.633704 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_nome.04166b95e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome
from "dbt"."public"."stg_clientes"
where nome is null



      
    ) dbt_internal_test
[0m00:26:20.634447 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:26:20.635967 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:26:20.639174 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (execute): 00:26:20.516510 => 00:26:20.638843
[0m00:26:20.639769 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:26:20.640210 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:26:20.641177 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where email is not null
group by email
having count(*) > 1



      
    ) dbt_internal_test
[0m00:26:20.642160 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: ROLLBACK
[0m00:26:20.644320 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (execute): 00:26:20.522167 => 00:26:20.644038
[0m00:26:20.645276 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:26:20.646845 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: Close
[0m00:26:20.647463 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:26:20.647940 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: ROLLBACK
[0m00:26:20.648849 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_cliente as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where id_cliente is not null
group by id_cliente
having count(*) > 1



      
    ) dbt_internal_test
[0m00:26:20.650365 [info ] [Thread-3 (]: 5 of 8 PASS not_null_stg_clientes_id_cliente ................................... [[32mPASS[0m in 0.21s]
[0m00:26:20.652795 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (execute): 00:26:20.536860 => 00:26:20.652477
[0m00:26:20.654203 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: Close
[0m00:26:20.655823 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:26:20.656381 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:26:20.657248 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: ROLLBACK
[0m00:26:20.658738 [info ] [Thread-2 (]: 6 of 8 PASS not_null_stg_clientes_nome ......................................... [[32mPASS[0m in 0.22s]
[0m00:26:20.661718 [debug] [Thread-1 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (execute): 00:26:20.603692 => 00:26:20.661369
[0m00:26:20.663628 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: Close
[0m00:26:20.665413 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:26:20.667390 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: ROLLBACK
[0m00:26:20.669587 [info ] [Thread-4 (]: 7 of 8 PASS unique_stg_clientes_email .......................................... [[32mPASS[0m in 0.19s]
[0m00:26:20.672772 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: Close
[0m00:26:20.675561 [debug] [Thread-4 (]: Finished running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:26:20.678782 [info ] [Thread-1 (]: 8 of 8 PASS unique_stg_clientes_id_cliente ..................................... [[32mPASS[0m in 0.19s]
[0m00:26:20.682465 [debug] [Thread-1 (]: Finished running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:26:20.685622 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:20.686892 [debug] [MainThread]: On master: BEGIN
[0m00:26:20.687790 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:26:20.697628 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:26:20.699061 [debug] [MainThread]: On master: COMMIT
[0m00:26:20.700346 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:20.701610 [debug] [MainThread]: On master: COMMIT
[0m00:26:20.702752 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:26:20.703652 [debug] [MainThread]: On master: Close
[0m00:26:20.704991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:26:20.706582 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3' was properly closed.
[0m00:26:20.709067 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_clientes_nome.04166b95e6' was properly closed.
[0m00:26:20.710103 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2' was properly closed.
[0m00:26:20.711129 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_email.2b7c7e0aff' was properly closed.
[0m00:26:20.712255 [info ] [MainThread]: 
[0m00:26:20.713696 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m00:26:20.717284 [debug] [MainThread]: Command end result
[0m00:26:20.744235 [info ] [MainThread]: 
[0m00:26:20.745657 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:26:20.747624 [info ] [MainThread]: 
[0m00:26:20.749276 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2 (models/stagking/stg_clientes.yml)
  syntax error at or near "char_length"
  LINE 15: where not(estado char_length(estado) = 2)
                            ^
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.yml/dbt_utils_expression_is_true_s_8eb9cc185edfbc26f8cf0f06e318d10c.sql
[0m00:26:20.750992 [info ] [MainThread]: 
[0m00:26:20.752665 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m00:26:20.755769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736352dd7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73635153bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73634c3e3880>]}
[0m00:26:20.758441 [debug] [MainThread]: Flushing usage events
[0m00:29:04.070921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721d63a49cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721d62579420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721d640cc7c0>]}


============================== 00:29:04.079943 | 7b16ae6b-5fce-4868-be40-c40b438fc2d0 ==============================
[0m00:29:04.079943 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:29:04.081930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:29:04.303696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b16ae6b-5fce-4868-be40-c40b438fc2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721d62579420>]}
[0m00:29:04.402914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b16ae6b-5fce-4868-be40-c40b438fc2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721d61e70b80>]}
[0m00:29:04.404703 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:29:04.437163 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:29:05.198803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:29:05.200060 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/stg_clientes.yml
[0m00:29:05.591569 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.staging
- models.mage_case.data_mart
[0m00:29:05.600545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b16ae6b-5fce-4868-be40-c40b438fc2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721d603d4910>]}
[0m00:29:05.641486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b16ae6b-5fce-4868-be40-c40b438fc2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721d602769b0>]}
[0m00:29:05.642981 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m00:29:05.644456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b16ae6b-5fce-4868-be40-c40b438fc2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721d60276b30>]}
[0m00:29:05.647771 [info ] [MainThread]: 
[0m00:29:05.650466 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:29:05.653726 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m00:29:05.670642 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:29:05.672016 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:29:05.673376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:05.687271 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:29:05.689114 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:29:05.690633 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:29:05.695827 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:29:05.698241 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:29:05.699583 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:29:05.707103 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:05.708527 [debug] [MainThread]: On master: BEGIN
[0m00:29:05.709721 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:29:05.718717 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:29:05.719968 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:05.721143 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:29:05.726466 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m00:29:05.729586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b16ae6b-5fce-4868-be40-c40b438fc2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721d602752a0>]}
[0m00:29:05.731115 [debug] [MainThread]: On master: ROLLBACK
[0m00:29:05.732467 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:05.733485 [debug] [MainThread]: On master: BEGIN
[0m00:29:05.735131 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:29:05.736124 [debug] [MainThread]: On master: COMMIT
[0m00:29:05.736875 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:05.737577 [debug] [MainThread]: On master: COMMIT
[0m00:29:05.738561 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:29:05.739328 [debug] [MainThread]: On master: Close
[0m00:29:05.740470 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:29:05.742804 [info ] [MainThread]: 
[0m00:29:05.752319 [debug] [Thread-1 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011
[0m00:29:05.752919 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:29:05.753375 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:29:05.753817 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:29:05.754535 [info ] [Thread-1 (]: 1 of 8 START test dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2  [RUN]
[0m00:29:05.755570 [info ] [Thread-2 (]: 2 of 8 START test not_null_stg_clientes_cidade ................................. [RUN]
[0m00:29:05.757327 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_clientes_email .................................. [RUN]
[0m00:29:05.759044 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_clientes_estado ................................. [RUN]
[0m00:29:05.761632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011)
[0m00:29:05.764172 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73'
[0m00:29:05.766772 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_email.d1824e153a'
[0m00:29:05.768168 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_estado.33c8769c0b'
[0m00:29:05.769200 [debug] [Thread-1 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011
[0m00:29:05.770351 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:29:05.771794 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:29:05.772963 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:29:05.785405 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011"
[0m00:29:05.797217 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:29:05.804363 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:29:05.811563 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:29:05.819232 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011 (compile): 00:29:05.773799 => 00:29:05.818752
[0m00:29:05.819972 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (compile): 00:29:05.798669 => 00:29:05.819640
[0m00:29:05.820660 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (compile): 00:29:05.805307 => 00:29:05.820356
[0m00:29:05.821489 [debug] [Thread-1 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011
[0m00:29:05.822343 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (compile): 00:29:05.787011 => 00:29:05.822071
[0m00:29:05.823122 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:29:05.824021 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:29:05.840384 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011"
[0m00:29:05.841417 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:29:05.845028 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:29:05.848709 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:29:05.853579 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:29:05.858720 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011"
[0m00:29:05.859383 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:29:05.860578 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011: BEGIN
[0m00:29:05.861231 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:29:05.862172 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: BEGIN
[0m00:29:05.862624 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:29:05.863522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:05.864364 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: BEGIN
[0m00:29:05.865183 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:29:05.866031 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: BEGIN
[0m00:29:05.867745 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:29:05.869615 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:29:05.875925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:29:05.877318 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011"
[0m00:29:05.878661 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:29:05.879808 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_clientes"

where not(estado char_length(estado) = 2)


      
    ) dbt_internal_test
[0m00:29:05.880283 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:29:05.880695 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:29:05.881874 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:29:05.883204 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "char_length"
LINE 15: where not(estado char_length(estado) = 2)
                          ^

[0m00:29:05.883811 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:29:05.884749 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:29:05.885672 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_email.d1824e153a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from "dbt"."public"."stg_clientes"
where email is null



      
    ) dbt_internal_test
[0m00:29:05.886624 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011: ROLLBACK
[0m00:29:05.887611 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cidade
from "dbt"."public"."stg_clientes"
where cidade is null



      
    ) dbt_internal_test
[0m00:29:05.888480 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select estado
from "dbt"."public"."stg_clientes"
where estado is null



      
    ) dbt_internal_test
[0m00:29:05.890301 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011 (execute): 00:29:05.824735 => 00:29:05.890004
[0m00:29:05.890880 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:29:05.892312 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:29:05.892765 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:29:05.893591 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011: Close
[0m00:29:05.896418 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (execute): 00:29:05.842410 => 00:29:05.896095
[0m00:29:05.898396 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (execute): 00:29:05.850895 => 00:29:05.898143
[0m00:29:05.900265 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (execute): 00:29:05.846267 => 00:29:05.900016
[0m00:29:05.902412 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: ROLLBACK
[0m00:29:05.904222 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: ROLLBACK
[0m00:29:05.905108 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2 (models/stagking/stg_clientes.yml)
  syntax error at or near "char_length"
  LINE 15: where not(estado char_length(estado) = 2)
                            ^
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.yml/dbt_utils_expression_is_true_s_8eb9cc185edfbc26f8cf0f06e318d10c.sql
[0m00:29:05.905942 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: ROLLBACK
[0m00:29:05.907025 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: Close
[0m00:29:05.907772 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: Close
[0m00:29:05.908668 [error] [Thread-1 (]: 1 of 8 ERROR dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2  [[31mERROR[0m in 0.15s]
[0m00:29:05.909973 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: Close
[0m00:29:05.911429 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_clientes_email ........................................ [[32mPASS[0m in 0.15s]
[0m00:29:05.913166 [info ] [Thread-2 (]: 2 of 8 PASS not_null_stg_clientes_cidade ....................................... [[32mPASS[0m in 0.15s]
[0m00:29:05.914689 [debug] [Thread-1 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011
[0m00:29:05.916706 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_clientes_estado ....................................... [[32mPASS[0m in 0.15s]
[0m00:29:05.917952 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:29:05.919412 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:29:05.920786 [debug] [Thread-1 (]: Began running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:29:05.922873 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:29:05.925235 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:29:05.926753 [debug] [Thread-2 (]: Began running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:29:05.928294 [info ] [Thread-1 (]: 5 of 8 START test not_null_stg_clientes_id_cliente ............................. [RUN]
[0m00:29:05.930839 [debug] [Thread-4 (]: Began running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:29:05.932257 [info ] [Thread-3 (]: 6 of 8 START test not_null_stg_clientes_nome ................................... [RUN]
[0m00:29:05.933557 [info ] [Thread-2 (]: 7 of 8 START test unique_stg_clientes_email .................................... [RUN]
[0m00:29:05.935198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011, now test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2)
[0m00:29:05.936933 [info ] [Thread-4 (]: 8 of 8 START test unique_stg_clientes_id_cliente ............................... [RUN]
[0m00:29:05.939761 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_email.d1824e153a, now test.mage_case.not_null_stg_clientes_nome.04166b95e6)
[0m00:29:05.947257 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73, now test.mage_case.unique_stg_clientes_email.2b7c7e0aff)
[0m00:29:05.948450 [debug] [Thread-1 (]: Began compiling node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:29:05.950056 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_estado.33c8769c0b, now test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3)
[0m00:29:05.951450 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:29:05.953020 [debug] [Thread-2 (]: Began compiling node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:29:05.960238 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:29:05.961483 [debug] [Thread-4 (]: Began compiling node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:29:05.973094 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:29:05.982495 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:29:05.991162 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:29:05.996565 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (compile): 00:29:05.954111 => 00:29:05.995943
[0m00:29:05.997753 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (compile): 00:29:05.962786 => 00:29:05.997208
[0m00:29:05.998822 [debug] [Thread-2 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (compile): 00:29:05.974341 => 00:29:05.998446
[0m00:29:05.999773 [debug] [Thread-1 (]: Began executing node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:29:06.001176 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:29:06.001929 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (compile): 00:29:05.984992 => 00:29:06.001582
[0m00:29:06.003030 [debug] [Thread-2 (]: Began executing node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:29:06.006577 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:29:06.009800 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:29:06.011042 [debug] [Thread-4 (]: Began executing node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:29:06.014229 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:29:06.018881 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:29:06.023994 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:29:06.024756 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:29:06.026257 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: BEGIN
[0m00:29:06.027070 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:29:06.027523 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:29:06.028305 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: BEGIN
[0m00:29:06.029172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:06.030349 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: BEGIN
[0m00:29:06.031231 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: BEGIN
[0m00:29:06.032073 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:29:06.033595 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:29:06.034527 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:29:06.042915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:29:06.044260 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:29:06.044883 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:29:06.045996 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:29:06.046420 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:29:06.046846 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:29:06.047923 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_cliente
from "dbt"."public"."stg_clientes"
where id_cliente is null



      
    ) dbt_internal_test
[0m00:29:06.048806 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:29:06.049683 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:29:06.050620 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_cliente as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where id_cliente is not null
group by id_cliente
having count(*) > 1



      
    ) dbt_internal_test
[0m00:29:06.051915 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_nome.04166b95e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome
from "dbt"."public"."stg_clientes"
where nome is null



      
    ) dbt_internal_test
[0m00:29:06.052638 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:29:06.053062 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where email is not null
group by email
having count(*) > 1



      
    ) dbt_internal_test
[0m00:29:06.055059 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:29:06.056687 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (execute): 00:29:06.003916 => 00:29:06.056425
[0m00:29:06.057104 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:29:06.059839 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (execute): 00:29:06.016246 => 00:29:06.059544
[0m00:29:06.060313 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:29:06.061149 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: ROLLBACK
[0m00:29:06.063073 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (execute): 00:29:06.007491 => 00:29:06.062826
[0m00:29:06.063966 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: ROLLBACK
[0m00:29:06.065933 [debug] [Thread-2 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (execute): 00:29:06.011866 => 00:29:06.065610
[0m00:29:06.067037 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: Close
[0m00:29:06.067697 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: ROLLBACK
[0m00:29:06.068823 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: Close
[0m00:29:06.069416 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: ROLLBACK
[0m00:29:06.070798 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stg_clientes_id_cliente ................................... [[32mPASS[0m in 0.14s]
[0m00:29:06.071831 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: Close
[0m00:29:06.073821 [info ] [Thread-4 (]: 8 of 8 PASS unique_stg_clientes_id_cliente ..................................... [[32mPASS[0m in 0.12s]
[0m00:29:06.075570 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: Close
[0m00:29:06.076869 [debug] [Thread-1 (]: Finished running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:29:06.078423 [info ] [Thread-3 (]: 6 of 8 PASS not_null_stg_clientes_nome ......................................... [[32mPASS[0m in 0.14s]
[0m00:29:06.080385 [debug] [Thread-4 (]: Finished running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:29:06.082949 [info ] [Thread-2 (]: 7 of 8 PASS unique_stg_clientes_email .......................................... [[32mPASS[0m in 0.14s]
[0m00:29:06.087106 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:29:06.089982 [debug] [Thread-2 (]: Finished running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:29:06.093780 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:06.095026 [debug] [MainThread]: On master: BEGIN
[0m00:29:06.096806 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:29:06.107144 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:29:06.108255 [debug] [MainThread]: On master: COMMIT
[0m00:29:06.109013 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:06.110169 [debug] [MainThread]: On master: COMMIT
[0m00:29:06.111332 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:29:06.112141 [debug] [MainThread]: On master: Close
[0m00:29:06.113277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:29:06.114036 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2' was properly closed.
[0m00:29:06.114891 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_email.2b7c7e0aff' was properly closed.
[0m00:29:06.115714 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_clientes_nome.04166b95e6' was properly closed.
[0m00:29:06.116592 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3' was properly closed.
[0m00:29:06.117752 [info ] [MainThread]: 
[0m00:29:06.120511 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m00:29:06.124248 [debug] [MainThread]: Command end result
[0m00:29:06.152077 [info ] [MainThread]: 
[0m00:29:06.155043 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:29:06.157595 [info ] [MainThread]: 
[0m00:29:06.159624 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2 (models/stagking/stg_clientes.yml)
  syntax error at or near "char_length"
  LINE 15: where not(estado char_length(estado) = 2)
                            ^
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.yml/dbt_utils_expression_is_true_s_8eb9cc185edfbc26f8cf0f06e318d10c.sql
[0m00:29:06.162365 [info ] [MainThread]: 
[0m00:29:06.164596 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m00:29:06.168609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721d63a49cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721d5f0c7ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721d5f0c49a0>]}
[0m00:29:06.171141 [debug] [MainThread]: Flushing usage events
[0m00:30:45.042559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7744bc6a7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7744bb1cec20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7744bcd34d30>]}


============================== 00:30:45.048823 | 9a7485b3-e49d-4e6c-892e-7d2c7b28a767 ==============================
[0m00:30:45.048823 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:30:45.049964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:30:45.263159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a7485b3-e49d-4e6c-892e-7d2c7b28a767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7744bb1cec20>]}
[0m00:30:45.362328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a7485b3-e49d-4e6c-892e-7d2c7b28a767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7744bae13ee0>]}
[0m00:30:45.364222 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:30:45.393842 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:30:46.150851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:30:46.152166 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/stg_clientes.yml
[0m00:30:46.535598 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.data_mart
- models.mage_case.staging
[0m00:30:46.544291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a7485b3-e49d-4e6c-892e-7d2c7b28a767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7744b92fd000>]}
[0m00:30:46.584166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a7485b3-e49d-4e6c-892e-7d2c7b28a767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7744b8f829b0>]}
[0m00:30:46.585455 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m00:30:46.586806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a7485b3-e49d-4e6c-892e-7d2c7b28a767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7744b8f82ad0>]}
[0m00:30:46.590481 [info ] [MainThread]: 
[0m00:30:46.592766 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:30:46.596335 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m00:30:46.614850 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:30:46.616291 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:30:46.617735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:30:46.636304 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:30:46.637982 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:30:46.639144 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:30:46.643825 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:30:46.646428 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:30:46.648204 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:30:46.656766 [debug] [MainThread]: Using postgres connection "master"
[0m00:30:46.657916 [debug] [MainThread]: On master: BEGIN
[0m00:30:46.658909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:30:46.667833 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:30:46.668867 [debug] [MainThread]: Using postgres connection "master"
[0m00:30:46.669765 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:30:46.674647 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m00:30:46.677758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a7485b3-e49d-4e6c-892e-7d2c7b28a767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7744b8f81270>]}
[0m00:30:46.678972 [debug] [MainThread]: On master: ROLLBACK
[0m00:30:46.680721 [debug] [MainThread]: Using postgres connection "master"
[0m00:30:46.681841 [debug] [MainThread]: On master: BEGIN
[0m00:30:46.683516 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:30:46.684329 [debug] [MainThread]: On master: COMMIT
[0m00:30:46.685068 [debug] [MainThread]: Using postgres connection "master"
[0m00:30:46.685770 [debug] [MainThread]: On master: COMMIT
[0m00:30:46.686702 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:30:46.687466 [debug] [MainThread]: On master: Close
[0m00:30:46.688676 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:30:46.689811 [info ] [MainThread]: 
[0m00:30:46.698845 [debug] [Thread-1 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2.048c3ad809
[0m00:30:46.699461 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:30:46.700098 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:30:46.700935 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:30:46.702347 [info ] [Thread-1 (]: 1 of 8 START test dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2  [RUN]
[0m00:30:46.705014 [info ] [Thread-2 (]: 2 of 8 START test not_null_stg_clientes_cidade ................................. [RUN]
[0m00:30:46.706604 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_clientes_email .................................. [RUN]
[0m00:30:46.708355 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_clientes_estado ................................. [RUN]
[0m00:30:46.710177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2.048c3ad809)
[0m00:30:46.711968 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73'
[0m00:30:46.714078 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_email.d1824e153a'
[0m00:30:46.716839 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_estado.33c8769c0b'
[0m00:30:46.719672 [debug] [Thread-1 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2.048c3ad809
[0m00:30:46.721274 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:30:46.722546 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:30:46.723999 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:30:46.739559 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2.048c3ad809"
[0m00:30:46.748663 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:30:46.755521 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:30:46.763029 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:30:46.769265 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2.048c3ad809 (compile): 00:30:46.724941 => 00:30:46.768744
[0m00:30:46.770671 [debug] [Thread-1 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2.048c3ad809
[0m00:30:46.771584 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (compile): 00:30:46.740406 => 00:30:46.771241
[0m00:30:46.772279 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (compile): 00:30:46.756665 => 00:30:46.771979
[0m00:30:46.778646 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (compile): 00:30:46.749523 => 00:30:46.778289
[0m00:30:46.790486 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2.048c3ad809"
[0m00:30:46.791035 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:30:46.792627 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:30:46.794081 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:30:46.798686 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:30:46.802284 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:30:46.805943 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:30:46.806518 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2.048c3ad809"
[0m00:30:46.809300 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2.048c3ad809: BEGIN
[0m00:30:46.810346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:46.813734 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:30:46.814498 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:30:46.815641 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: BEGIN
[0m00:30:46.816440 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:30:46.817275 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: BEGIN
[0m00:30:46.818237 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:30:46.819340 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: BEGIN
[0m00:30:46.820365 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:30:46.820804 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:30:46.822656 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:30:46.823713 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2.048c3ad809"
[0m00:30:46.826451 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2.048c3ad809: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2.048c3ad809"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_clientes"

where not(estado char_length("dbt"."public_dbt_test__audit"."dbt_utils_expression_is_true_s_9ba5abc52534630bbe12a7f6ebb64833".estado) = 2)


      
    ) dbt_internal_test
[0m00:30:46.828497 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "char_length"
LINE 15: where not(estado char_length("dbt"."public_dbt_test__audit"....
                          ^

[0m00:30:46.829673 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2.048c3ad809: ROLLBACK
[0m00:30:46.831346 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2.048c3ad809 (execute): 00:30:46.773048 => 00:30:46.831013
[0m00:30:46.832276 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:30:46.833496 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:30:46.833945 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:30:46.834413 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2.048c3ad809: Close
[0m00:30:46.835381 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:30:46.836313 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:30:46.837169 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:30:46.839801 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2 (models/stagking/stg_clientes.yml)
  syntax error at or near "char_length"
  LINE 15: where not(estado char_length("dbt"."public_dbt_test__audit"....
                            ^
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.yml/dbt_utils_expression_is_true_s_9ba5abc52534630bbe12a7f6ebb64833.sql
[0m00:30:46.840702 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_email.d1824e153a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from "dbt"."public"."stg_clientes"
where email is null



      
    ) dbt_internal_test
[0m00:30:46.841669 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select estado
from "dbt"."public"."stg_clientes"
where estado is null



      
    ) dbt_internal_test
[0m00:30:46.842573 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cidade
from "dbt"."public"."stg_clientes"
where cidade is null



      
    ) dbt_internal_test
[0m00:30:46.843642 [error] [Thread-1 (]: 1 of 8 ERROR dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2  [[31mERROR[0m in 0.13s]
[0m00:30:46.845942 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:30:46.846604 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:30:46.847336 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:30:46.848408 [debug] [Thread-1 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2.048c3ad809
[0m00:30:46.851026 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (execute): 00:30:46.803223 => 00:30:46.850738
[0m00:30:46.853101 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (execute): 00:30:46.799663 => 00:30:46.852813
[0m00:30:46.855027 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (execute): 00:30:46.796115 => 00:30:46.854784
[0m00:30:46.856071 [debug] [Thread-1 (]: Began running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:30:46.856990 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: ROLLBACK
[0m00:30:46.857868 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: ROLLBACK
[0m00:30:46.858736 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: ROLLBACK
[0m00:30:46.859676 [info ] [Thread-1 (]: 5 of 8 START test not_null_stg_clientes_id_cliente ............................. [RUN]
[0m00:30:46.861395 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: Close
[0m00:30:46.862747 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: Close
[0m00:30:46.864232 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: Close
[0m00:30:46.865858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2.048c3ad809, now test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2)
[0m00:30:46.868296 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_clientes_email ........................................ [[32mPASS[0m in 0.15s]
[0m00:30:46.871990 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_clientes_estado ....................................... [[32mPASS[0m in 0.16s]
[0m00:30:46.875444 [info ] [Thread-2 (]: 2 of 8 PASS not_null_stg_clientes_cidade ....................................... [[32mPASS[0m in 0.16s]
[0m00:30:46.878455 [debug] [Thread-1 (]: Began compiling node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:30:46.880531 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:30:46.882327 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:30:46.884218 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:30:46.890575 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:30:46.892060 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:30:46.893542 [debug] [Thread-4 (]: Began running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:30:46.895313 [debug] [Thread-2 (]: Began running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:30:46.898855 [info ] [Thread-3 (]: 6 of 8 START test not_null_stg_clientes_nome ................................... [RUN]
[0m00:30:46.900545 [info ] [Thread-4 (]: 7 of 8 START test unique_stg_clientes_email .................................... [RUN]
[0m00:30:46.902386 [info ] [Thread-2 (]: 8 of 8 START test unique_stg_clientes_id_cliente ............................... [RUN]
[0m00:30:46.904481 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_email.d1824e153a, now test.mage_case.not_null_stg_clientes_nome.04166b95e6)
[0m00:30:46.906812 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_estado.33c8769c0b, now test.mage_case.unique_stg_clientes_email.2b7c7e0aff)
[0m00:30:46.908598 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73, now test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3)
[0m00:30:46.909579 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (compile): 00:30:46.885359 => 00:30:46.909094
[0m00:30:46.910804 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:30:46.912199 [debug] [Thread-4 (]: Began compiling node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:30:46.913421 [debug] [Thread-2 (]: Began compiling node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:30:46.914428 [debug] [Thread-1 (]: Began executing node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:30:46.923672 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:30:46.934922 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:30:46.941449 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:30:46.945290 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:30:46.953083 [debug] [Thread-2 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (compile): 00:30:46.936185 => 00:30:46.952495
[0m00:30:46.955618 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (compile): 00:30:46.915262 => 00:30:46.954661
[0m00:30:46.956685 [debug] [Thread-2 (]: Began executing node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:30:46.957808 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (compile): 00:30:46.924792 => 00:30:46.957299
[0m00:30:46.959206 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:30:46.964041 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:30:46.964707 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:30:46.965937 [debug] [Thread-4 (]: Began executing node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:30:46.970003 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:30:46.972223 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: BEGIN
[0m00:30:46.975906 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:30:46.977651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:46.981572 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:30:46.987280 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:30:46.987941 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: BEGIN
[0m00:30:46.988509 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:30:46.989488 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:30:46.989930 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: BEGIN
[0m00:30:46.990869 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:30:46.991805 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: BEGIN
[0m00:30:46.992657 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:30:46.993514 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:30:46.995243 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:30:46.996509 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_cliente
from "dbt"."public"."stg_clientes"
where id_cliente is null



      
    ) dbt_internal_test
[0m00:30:47.000214 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:30:47.002537 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (execute): 00:30:46.942368 => 00:30:47.002249
[0m00:30:47.003628 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: ROLLBACK
[0m00:30:47.004790 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:30:47.005534 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: Close
[0m00:30:47.006482 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:30:47.007497 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:30:47.007917 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:30:47.009107 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stg_clientes_id_cliente ................................... [[32mPASS[0m in 0.14s]
[0m00:30:47.009929 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_cliente as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where id_cliente is not null
group by id_cliente
having count(*) > 1



      
    ) dbt_internal_test
[0m00:30:47.011013 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:30:47.012004 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:30:47.013178 [debug] [Thread-1 (]: Finished running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:30:47.014593 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_nome.04166b95e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome
from "dbt"."public"."stg_clientes"
where nome is null



      
    ) dbt_internal_test
[0m00:30:47.015340 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:30:47.015982 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where email is not null
group by email
having count(*) > 1



      
    ) dbt_internal_test
[0m00:30:47.020223 [debug] [Thread-2 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (execute): 00:30:46.960627 => 00:30:47.019891
[0m00:30:47.020920 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:30:47.023572 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: ROLLBACK
[0m00:30:47.024489 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:30:47.027019 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (execute): 00:30:46.967182 => 00:30:47.026693
[0m00:30:47.028629 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: Close
[0m00:30:47.030549 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (execute): 00:30:46.973124 => 00:30:47.030262
[0m00:30:47.031594 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: ROLLBACK
[0m00:30:47.033405 [info ] [Thread-2 (]: 8 of 8 PASS unique_stg_clientes_id_cliente ..................................... [[32mPASS[0m in 0.13s]
[0m00:30:47.034591 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: ROLLBACK
[0m00:30:47.036303 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: Close
[0m00:30:47.037498 [debug] [Thread-2 (]: Finished running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:30:47.038788 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: Close
[0m00:30:47.040215 [info ] [Thread-3 (]: 6 of 8 PASS not_null_stg_clientes_nome ......................................... [[32mPASS[0m in 0.14s]
[0m00:30:47.043039 [info ] [Thread-4 (]: 7 of 8 PASS unique_stg_clientes_email .......................................... [[32mPASS[0m in 0.14s]
[0m00:30:47.044852 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:30:47.046920 [debug] [Thread-4 (]: Finished running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:30:47.051904 [debug] [MainThread]: Using postgres connection "master"
[0m00:30:47.053119 [debug] [MainThread]: On master: BEGIN
[0m00:30:47.054118 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:30:47.065459 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:30:47.066853 [debug] [MainThread]: On master: COMMIT
[0m00:30:47.067986 [debug] [MainThread]: Using postgres connection "master"
[0m00:30:47.068971 [debug] [MainThread]: On master: COMMIT
[0m00:30:47.070176 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:30:47.071416 [debug] [MainThread]: On master: Close
[0m00:30:47.073525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:30:47.075986 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2' was properly closed.
[0m00:30:47.077242 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3' was properly closed.
[0m00:30:47.078516 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_clientes_nome.04166b95e6' was properly closed.
[0m00:30:47.079669 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_email.2b7c7e0aff' was properly closed.
[0m00:30:47.080630 [info ] [MainThread]: 
[0m00:30:47.081746 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m00:30:47.084897 [debug] [MainThread]: Command end result
[0m00:30:47.114599 [info ] [MainThread]: 
[0m00:30:47.116218 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:30:47.117641 [info ] [MainThread]: 
[0m00:30:47.120011 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_clientes_estado__char_length_this_estado_2 (models/stagking/stg_clientes.yml)
  syntax error at or near "char_length"
  LINE 15: where not(estado char_length("dbt"."public_dbt_test__audit"....
                            ^
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.yml/dbt_utils_expression_is_true_s_9ba5abc52534630bbe12a7f6ebb64833.sql
[0m00:30:47.122870 [info ] [MainThread]: 
[0m00:30:47.125568 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m00:30:47.128418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7744bc6a7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7744b8d8a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7744b8d894b0>]}
[0m00:30:47.130352 [debug] [MainThread]: Flushing usage events
[0m00:32:06.918885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fdcd1c3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fdcbce7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fdcd854760>]}


============================== 00:32:06.925313 | 0ba61e09-b2be-42e9-b638-d64905607bf5 ==============================
[0m00:32:06.925313 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:32:06.926574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:32:07.161570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ba61e09-b2be-42e9-b638-d64905607bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fdcbce7100>]}
[0m00:32:07.269011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ba61e09-b2be-42e9-b638-d64905607bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fdc9cf9270>]}
[0m00:32:07.271143 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:32:07.307111 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:32:08.158446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:32:08.159833 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/stg_clientes.yml
[0m00:32:08.582219 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.data_mart
- models.mage_case.staging
[0m00:32:08.591638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ba61e09-b2be-42e9-b638-d64905607bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fdc9bd6140>]}
[0m00:32:08.635516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ba61e09-b2be-42e9-b638-d64905607bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fdc99fa980>]}
[0m00:32:08.637309 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m00:32:08.638895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ba61e09-b2be-42e9-b638-d64905607bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fdc99fab00>]}
[0m00:32:08.644267 [info ] [MainThread]: 
[0m00:32:08.646519 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:32:08.650180 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m00:32:08.669678 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:32:08.671456 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:32:08.672772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:32:08.687595 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:32:08.688970 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:32:08.690065 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:32:08.695171 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:32:08.697572 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:32:08.699168 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:32:08.709364 [debug] [MainThread]: Using postgres connection "master"
[0m00:32:08.710987 [debug] [MainThread]: On master: BEGIN
[0m00:32:08.712173 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:32:08.723737 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:32:08.725100 [debug] [MainThread]: Using postgres connection "master"
[0m00:32:08.726392 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:32:08.733132 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m00:32:08.737124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ba61e09-b2be-42e9-b638-d64905607bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fdc99f9210>]}
[0m00:32:08.738681 [debug] [MainThread]: On master: ROLLBACK
[0m00:32:08.740223 [debug] [MainThread]: Using postgres connection "master"
[0m00:32:08.741222 [debug] [MainThread]: On master: BEGIN
[0m00:32:08.742589 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:32:08.743545 [debug] [MainThread]: On master: COMMIT
[0m00:32:08.744803 [debug] [MainThread]: Using postgres connection "master"
[0m00:32:08.745735 [debug] [MainThread]: On master: COMMIT
[0m00:32:08.746875 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:32:08.747799 [debug] [MainThread]: On master: Close
[0m00:32:08.749327 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:32:08.751122 [info ] [MainThread]: 
[0m00:32:08.762323 [debug] [Thread-1 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_2.649f2d32c8
[0m00:32:08.762917 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:32:08.763416 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:32:08.764002 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:32:08.765129 [info ] [Thread-1 (]: 1 of 8 START test dbt_utils_expression_is_true_stg_clientes_estado__char_length_2  [RUN]
[0m00:32:08.766800 [info ] [Thread-2 (]: 2 of 8 START test not_null_stg_clientes_cidade ................................. [RUN]
[0m00:32:08.768675 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_clientes_email .................................. [RUN]
[0m00:32:08.770447 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_clientes_estado ................................. [RUN]
[0m00:32:08.773072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_2.649f2d32c8)
[0m00:32:08.775063 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73'
[0m00:32:08.777814 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_email.d1824e153a'
[0m00:32:08.780449 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_estado.33c8769c0b'
[0m00:32:08.782391 [debug] [Thread-1 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_2.649f2d32c8
[0m00:32:08.784253 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:32:08.785996 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:32:08.787395 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:32:08.802388 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_2.649f2d32c8"
[0m00:32:08.813187 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:32:08.820976 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:32:08.829691 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:32:08.836572 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_2.649f2d32c8 (compile): 00:32:08.788525 => 00:32:08.835846
[0m00:32:08.838383 [debug] [Thread-1 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_2.649f2d32c8
[0m00:32:08.839490 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (compile): 00:32:08.822235 => 00:32:08.838843
[0m00:32:08.840364 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (compile): 00:32:08.814297 => 00:32:08.839984
[0m00:32:08.847069 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (compile): 00:32:08.803278 => 00:32:08.846558
[0m00:32:08.862468 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_2.649f2d32c8"
[0m00:32:08.863145 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:32:08.864728 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:32:08.866046 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:32:08.870968 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:32:08.875133 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:32:08.879111 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:32:08.879838 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_2.649f2d32c8"
[0m00:32:08.883354 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_2.649f2d32c8: BEGIN
[0m00:32:08.884762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:32:08.888936 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:32:08.889947 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:32:08.891203 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: BEGIN
[0m00:32:08.891965 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:32:08.892945 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: BEGIN
[0m00:32:08.894157 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:32:08.895379 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: BEGIN
[0m00:32:08.896361 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:32:08.896926 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:32:08.898552 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:32:08.900766 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_2.649f2d32c8"
[0m00:32:08.903558 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_2.649f2d32c8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_2.649f2d32c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_clientes"

where not(estado char_length() = 2)


      
    ) dbt_internal_test
[0m00:32:08.905477 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "char_length"
LINE 15: where not(estado char_length() = 2)
                          ^

[0m00:32:08.906786 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_2.649f2d32c8: ROLLBACK
[0m00:32:08.908400 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_2.649f2d32c8 (execute): 00:32:08.841358 => 00:32:08.908049
[0m00:32:08.909750 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_2.649f2d32c8: Close
[0m00:32:08.910453 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:32:08.910961 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:32:08.913990 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:32:08.914847 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:32:08.916468 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_stg_clientes_estado__char_length_2 (models/stagking/stg_clientes.yml)
  syntax error at or near "char_length"
  LINE 15: where not(estado char_length() = 2)
                            ^
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.yml/dbt_utils_expression_is_true_stg_clientes_estado__char_length_2.sql
[0m00:32:08.917779 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:32:08.919125 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:32:08.920219 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select estado
from "dbt"."public"."stg_clientes"
where estado is null



      
    ) dbt_internal_test
[0m00:32:08.921306 [error] [Thread-1 (]: 1 of 8 ERROR dbt_utils_expression_is_true_stg_clientes_estado__char_length_2 ... [[31mERROR[0m in 0.15s]
[0m00:32:08.922783 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cidade
from "dbt"."public"."stg_clientes"
where cidade is null



      
    ) dbt_internal_test
[0m00:32:08.923954 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_email.d1824e153a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from "dbt"."public"."stg_clientes"
where email is null



      
    ) dbt_internal_test
[0m00:32:08.925973 [debug] [Thread-1 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_2.649f2d32c8
[0m00:32:08.926543 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:32:08.928422 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:32:08.929387 [debug] [Thread-1 (]: Began running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:32:08.930273 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:32:08.934203 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (execute): 00:32:08.867697 => 00:32:08.933823
[0m00:32:08.937458 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (execute): 00:32:08.876162 => 00:32:08.936924
[0m00:32:08.938768 [info ] [Thread-1 (]: 5 of 8 START test not_null_stg_clientes_id_cliente ............................. [RUN]
[0m00:32:08.942460 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (execute): 00:32:08.872103 => 00:32:08.941850
[0m00:32:08.944227 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: ROLLBACK
[0m00:32:08.946111 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: ROLLBACK
[0m00:32:08.948369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_2.649f2d32c8, now test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2)
[0m00:32:08.950244 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: ROLLBACK
[0m00:32:08.952353 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: Close
[0m00:32:08.953818 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: Close
[0m00:32:08.954987 [debug] [Thread-1 (]: Began compiling node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:32:08.957180 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: Close
[0m00:32:08.959230 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_clientes_estado ....................................... [[32mPASS[0m in 0.18s]
[0m00:32:08.961842 [info ] [Thread-2 (]: 2 of 8 PASS not_null_stg_clientes_cidade ....................................... [[32mPASS[0m in 0.19s]
[0m00:32:08.971959 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:32:08.974040 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_clientes_email ........................................ [[32mPASS[0m in 0.20s]
[0m00:32:08.977266 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:32:08.979349 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:32:08.982250 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:32:08.984126 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:32:08.986316 [debug] [Thread-2 (]: Began running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:32:08.988573 [debug] [Thread-3 (]: Began running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:32:08.991402 [info ] [Thread-4 (]: 6 of 8 START test not_null_stg_clientes_nome ................................... [RUN]
[0m00:32:08.993877 [info ] [Thread-2 (]: 7 of 8 START test unique_stg_clientes_email .................................... [RUN]
[0m00:32:08.995120 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (compile): 00:32:08.963413 => 00:32:08.994611
[0m00:32:08.996784 [info ] [Thread-3 (]: 8 of 8 START test unique_stg_clientes_id_cliente ............................... [RUN]
[0m00:32:08.999369 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_estado.33c8769c0b, now test.mage_case.not_null_stg_clientes_nome.04166b95e6)
[0m00:32:09.001606 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73, now test.mage_case.unique_stg_clientes_email.2b7c7e0aff)
[0m00:32:09.003272 [debug] [Thread-1 (]: Began executing node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:32:09.005684 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_email.d1824e153a, now test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3)
[0m00:32:09.007521 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:32:09.009054 [debug] [Thread-2 (]: Began compiling node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:32:09.017367 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:32:09.019150 [debug] [Thread-3 (]: Began compiling node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:32:09.030126 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:32:09.040529 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:32:09.047837 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:32:09.054592 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:32:09.056379 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (compile): 00:32:09.020819 => 00:32:09.055748
[0m00:32:09.057299 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: BEGIN
[0m00:32:09.058247 [debug] [Thread-3 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (compile): 00:32:09.042196 => 00:32:09.057798
[0m00:32:09.058964 [debug] [Thread-2 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (compile): 00:32:09.031476 => 00:32:09.058665
[0m00:32:09.059860 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:32:09.061146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:32:09.062209 [debug] [Thread-3 (]: Began executing node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:32:09.063265 [debug] [Thread-2 (]: Began executing node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:32:09.067329 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:32:09.073561 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:32:09.077838 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:32:09.078946 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:32:09.082129 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:32:09.083437 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_cliente
from "dbt"."public"."stg_clientes"
where id_cliente is null



      
    ) dbt_internal_test
[0m00:32:09.086610 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:32:09.088383 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:32:09.089278 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:32:09.091466 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (execute): 00:32:09.010334 => 00:32:09.091065
[0m00:32:09.092241 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:32:09.093526 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: BEGIN
[0m00:32:09.094822 [debug] [Thread-3 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: BEGIN
[0m00:32:09.096070 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: ROLLBACK
[0m00:32:09.097266 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: BEGIN
[0m00:32:09.098622 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:32:09.100076 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:32:09.101596 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: Close
[0m00:32:09.102408 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:32:09.108593 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stg_clientes_id_cliente ................................... [[32mPASS[0m in 0.16s]
[0m00:32:09.117766 [debug] [Thread-1 (]: Finished running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:32:09.119525 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:32:09.120661 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:32:09.121161 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:32:09.122195 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:32:09.123237 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_nome.04166b95e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome
from "dbt"."public"."stg_clientes"
where nome is null



      
    ) dbt_internal_test
[0m00:32:09.124419 [debug] [Thread-3 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_cliente as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where id_cliente is not null
group by id_cliente
having count(*) > 1



      
    ) dbt_internal_test
[0m00:32:09.126480 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:32:09.126966 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:32:09.127733 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:32:09.128469 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:32:09.131279 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (execute): 00:32:09.064154 => 00:32:09.130886
[0m00:32:09.132731 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where email is not null
group by email
having count(*) > 1



      
    ) dbt_internal_test
[0m00:32:09.136430 [debug] [Thread-3 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (execute): 00:32:09.069364 => 00:32:09.135782
[0m00:32:09.138322 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: ROLLBACK
[0m00:32:09.140577 [debug] [Thread-3 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: ROLLBACK
[0m00:32:09.141583 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:32:09.143075 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: Close
[0m00:32:09.144516 [debug] [Thread-3 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: Close
[0m00:32:09.146594 [debug] [Thread-2 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (execute): 00:32:09.074853 => 00:32:09.146239
[0m00:32:09.148639 [info ] [Thread-4 (]: 6 of 8 PASS not_null_stg_clientes_nome ......................................... [[32mPASS[0m in 0.15s]
[0m00:32:09.151568 [info ] [Thread-3 (]: 8 of 8 PASS unique_stg_clientes_id_cliente ..................................... [[32mPASS[0m in 0.15s]
[0m00:32:09.153363 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: ROLLBACK
[0m00:32:09.155259 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:32:09.156933 [debug] [Thread-3 (]: Finished running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:32:09.158616 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: Close
[0m00:32:09.162556 [info ] [Thread-2 (]: 7 of 8 PASS unique_stg_clientes_email .......................................... [[32mPASS[0m in 0.16s]
[0m00:32:09.165823 [debug] [Thread-2 (]: Finished running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:32:09.170641 [debug] [MainThread]: Using postgres connection "master"
[0m00:32:09.172293 [debug] [MainThread]: On master: BEGIN
[0m00:32:09.173795 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:32:09.187954 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:32:09.189946 [debug] [MainThread]: On master: COMMIT
[0m00:32:09.191235 [debug] [MainThread]: Using postgres connection "master"
[0m00:32:09.192654 [debug] [MainThread]: On master: COMMIT
[0m00:32:09.194218 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:32:09.195515 [debug] [MainThread]: On master: Close
[0m00:32:09.197802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:32:09.199473 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2' was properly closed.
[0m00:32:09.200749 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_email.2b7c7e0aff' was properly closed.
[0m00:32:09.202245 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3' was properly closed.
[0m00:32:09.203555 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_clientes_nome.04166b95e6' was properly closed.
[0m00:32:09.205123 [info ] [MainThread]: 
[0m00:32:09.206715 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m00:32:09.210878 [debug] [MainThread]: Command end result
[0m00:32:09.238520 [info ] [MainThread]: 
[0m00:32:09.240911 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:32:09.242696 [info ] [MainThread]: 
[0m00:32:09.245434 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_clientes_estado__char_length_2 (models/stagking/stg_clientes.yml)
  syntax error at or near "char_length"
  LINE 15: where not(estado char_length() = 2)
                            ^
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.yml/dbt_utils_expression_is_true_stg_clientes_estado__char_length_2.sql
[0m00:32:09.247700 [info ] [MainThread]: 
[0m00:32:09.250320 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m00:32:09.253386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fdcd1c3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fdc88763b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fdc8875210>]}
[0m00:32:09.254946 [debug] [MainThread]: Flushing usage events
[0m00:33:46.412366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a159abdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a1487ec20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a160e8d30>]}


============================== 00:33:46.418305 | ce2938b7-a698-44d4-9787-103f9215811e ==============================
[0m00:33:46.418305 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:33:46.419532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:33:46.634071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce2938b7-a698-44d4-9787-103f9215811e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a1487ec20>]}
[0m00:33:46.733696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce2938b7-a698-44d4-9787-103f9215811e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a144c3ee0>]}
[0m00:33:46.735509 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:33:46.765242 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:33:47.545902 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:33:47.547223 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/stg_clientes.yml
[0m00:33:47.940909 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.staging
- models.mage_case.data_mart
[0m00:33:47.951506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce2938b7-a698-44d4-9787-103f9215811e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a127b1000>]}
[0m00:33:47.995798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce2938b7-a698-44d4-9787-103f9215811e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a1239a9b0>]}
[0m00:33:47.997057 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m00:33:47.998582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce2938b7-a698-44d4-9787-103f9215811e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a1239aad0>]}
[0m00:33:48.002473 [info ] [MainThread]: 
[0m00:33:48.004738 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:33:48.008103 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m00:33:48.025634 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:33:48.027272 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:33:48.028647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:48.041097 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:33:48.042535 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:33:48.043965 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:33:48.049007 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:33:48.051222 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:33:48.052309 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:33:48.061008 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:48.062378 [debug] [MainThread]: On master: BEGIN
[0m00:33:48.063899 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:48.074164 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:48.075392 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:48.076509 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:33:48.082444 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m00:33:48.085676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce2938b7-a698-44d4-9787-103f9215811e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a12399270>]}
[0m00:33:48.086673 [debug] [MainThread]: On master: ROLLBACK
[0m00:33:48.087765 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:48.088585 [debug] [MainThread]: On master: BEGIN
[0m00:33:48.089710 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:48.090462 [debug] [MainThread]: On master: COMMIT
[0m00:33:48.091228 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:48.091906 [debug] [MainThread]: On master: COMMIT
[0m00:33:48.092818 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:48.093543 [debug] [MainThread]: On master: Close
[0m00:33:48.094961 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:33:48.096033 [info ] [MainThread]: 
[0m00:33:48.104874 [debug] [Thread-1 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011
[0m00:33:48.105436 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:33:48.105978 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:33:48.106531 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:33:48.107285 [info ] [Thread-1 (]: 1 of 8 START test dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2  [RUN]
[0m00:33:48.108292 [info ] [Thread-2 (]: 2 of 8 START test not_null_stg_clientes_cidade ................................. [RUN]
[0m00:33:48.109719 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_clientes_email .................................. [RUN]
[0m00:33:48.111236 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_clientes_estado ................................. [RUN]
[0m00:33:48.113168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011)
[0m00:33:48.115028 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73'
[0m00:33:48.116750 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_email.d1824e153a'
[0m00:33:48.118297 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_estado.33c8769c0b'
[0m00:33:48.119605 [debug] [Thread-1 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011
[0m00:33:48.121183 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:33:48.122495 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:33:48.124187 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:33:48.137989 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011"
[0m00:33:48.148957 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:33:48.156131 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:33:48.163875 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:33:48.172426 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011 (compile): 00:33:48.125482 => 00:33:48.171976
[0m00:33:48.173277 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (compile): 00:33:48.138919 => 00:33:48.172951
[0m00:33:48.174787 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (compile): 00:33:48.150268 => 00:33:48.174251
[0m00:33:48.175396 [debug] [Thread-1 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011
[0m00:33:48.176868 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:33:48.177551 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (compile): 00:33:48.157216 => 00:33:48.177270
[0m00:33:48.178592 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:33:48.194633 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011"
[0m00:33:48.197914 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:33:48.199234 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:33:48.203018 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:33:48.208270 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:33:48.213445 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:33:48.214326 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011"
[0m00:33:48.215498 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:33:48.216090 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: BEGIN
[0m00:33:48.217293 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011: BEGIN
[0m00:33:48.217836 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:33:48.218575 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: BEGIN
[0m00:33:48.219459 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:33:48.220291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:33:48.221111 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: BEGIN
[0m00:33:48.221931 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:33:48.225370 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:33:48.232190 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:33:48.233355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:33:48.234033 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:33:48.234984 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:33:48.235454 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011"
[0m00:33:48.236644 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cidade
from "dbt"."public"."stg_clientes"
where cidade is null



      
    ) dbt_internal_test
[0m00:33:48.237121 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:33:48.237894 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:33:48.238965 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_clientes"

where not(estado char_length(estado) = 2)


      
    ) dbt_internal_test
[0m00:33:48.240402 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:33:48.240916 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:48.241612 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_email.d1824e153a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from "dbt"."public"."stg_clientes"
where email is null



      
    ) dbt_internal_test
[0m00:33:48.243074 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "char_length"
LINE 15: where not(estado char_length(estado) = 2)
                          ^

[0m00:33:48.243563 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select estado
from "dbt"."public"."stg_clientes"
where estado is null



      
    ) dbt_internal_test
[0m00:33:48.246215 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (execute): 00:33:48.195387 => 00:33:48.245915
[0m00:33:48.247668 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011: ROLLBACK
[0m00:33:48.248151 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:48.249465 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: ROLLBACK
[0m00:33:48.249930 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:48.251129 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011 (execute): 00:33:48.179379 => 00:33:48.250789
[0m00:33:48.252922 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (execute): 00:33:48.200336 => 00:33:48.252668
[0m00:33:48.253961 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: Close
[0m00:33:48.255601 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (execute): 00:33:48.205743 => 00:33:48.255350
[0m00:33:48.256478 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011: Close
[0m00:33:48.257257 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: ROLLBACK
[0m00:33:48.258745 [info ] [Thread-2 (]: 2 of 8 PASS not_null_stg_clientes_cidade ....................................... [[32mPASS[0m in 0.14s]
[0m00:33:48.259798 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: ROLLBACK
[0m00:33:48.262532 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: Close
[0m00:33:48.264240 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:33:48.265240 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2 (models/stagking/stg_clientes.yml)
  syntax error at or near "char_length"
  LINE 15: where not(estado char_length(estado) = 2)
                            ^
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.yml/dbt_utils_expression_is_true_s_8eb9cc185edfbc26f8cf0f06e318d10c.sql
[0m00:33:48.266200 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: Close
[0m00:33:48.267391 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_clientes_email ........................................ [[32mPASS[0m in 0.15s]
[0m00:33:48.268517 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:33:48.269838 [error] [Thread-1 (]: 1 of 8 ERROR dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2  [[31mERROR[0m in 0.16s]
[0m00:33:48.271824 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_clientes_estado ....................................... [[32mPASS[0m in 0.15s]
[0m00:33:48.273126 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:33:48.274327 [info ] [Thread-2 (]: 5 of 8 START test not_null_stg_clientes_id_cliente ............................. [RUN]
[0m00:33:48.275630 [debug] [Thread-1 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011
[0m00:33:48.276917 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:33:48.277943 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:33:48.279653 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73, now test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2)
[0m00:33:48.281397 [debug] [Thread-1 (]: Began running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:33:48.283335 [debug] [Thread-4 (]: Began running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:33:48.284533 [info ] [Thread-3 (]: 6 of 8 START test not_null_stg_clientes_nome ................................... [RUN]
[0m00:33:48.286057 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:33:48.288051 [info ] [Thread-1 (]: 7 of 8 START test unique_stg_clientes_email .................................... [RUN]
[0m00:33:48.290609 [info ] [Thread-4 (]: 8 of 8 START test unique_stg_clientes_id_cliente ............................... [RUN]
[0m00:33:48.292895 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_email.d1824e153a, now test.mage_case.not_null_stg_clientes_nome.04166b95e6)
[0m00:33:48.300680 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:33:48.301966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2.d841c8c011, now test.mage_case.unique_stg_clientes_email.2b7c7e0aff)
[0m00:33:48.303321 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_estado.33c8769c0b, now test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3)
[0m00:33:48.304220 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:33:48.306386 [debug] [Thread-1 (]: Began compiling node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:33:48.307584 [debug] [Thread-4 (]: Began compiling node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:33:48.318773 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:33:48.329946 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:33:48.330727 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (compile): 00:33:48.294115 => 00:33:48.330385
[0m00:33:48.338268 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:33:48.341703 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:33:48.346400 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:33:48.349677 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (compile): 00:33:48.331403 => 00:33:48.348461
[0m00:33:48.351088 [debug] [Thread-1 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (compile): 00:33:48.320184 => 00:33:48.350604
[0m00:33:48.351814 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (compile): 00:33:48.308432 => 00:33:48.351409
[0m00:33:48.353006 [debug] [Thread-4 (]: Began executing node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:33:48.353980 [debug] [Thread-1 (]: Began executing node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:33:48.355132 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:33:48.359206 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:33:48.359820 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:33:48.363458 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:33:48.367514 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:33:48.369473 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: BEGIN
[0m00:33:48.372151 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:33:48.374213 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:33:48.375245 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:33:48.376047 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:33:48.376934 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: BEGIN
[0m00:33:48.378139 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: BEGIN
[0m00:33:48.379128 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: BEGIN
[0m00:33:48.380076 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:33:48.381024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:33:48.382201 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:33:48.382727 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:33:48.387821 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:33:48.389104 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_cliente
from "dbt"."public"."stg_clientes"
where id_cliente is null



      
    ) dbt_internal_test
[0m00:33:48.391657 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:48.392726 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:33:48.393642 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:33:48.396268 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (execute): 00:33:48.343401 => 00:33:48.395966
[0m00:33:48.396794 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:33:48.397762 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:33:48.398660 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:33:48.399548 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: ROLLBACK
[0m00:33:48.400403 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:33:48.401364 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_cliente as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where id_cliente is not null
group by id_cliente
having count(*) > 1



      
    ) dbt_internal_test
[0m00:33:48.402220 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where email is not null
group by email
having count(*) > 1



      
    ) dbt_internal_test
[0m00:33:48.403375 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: Close
[0m00:33:48.404023 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_nome.04166b95e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome
from "dbt"."public"."stg_clientes"
where nome is null



      
    ) dbt_internal_test
[0m00:33:48.406202 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:48.406845 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:48.408298 [info ] [Thread-2 (]: 5 of 8 PASS not_null_stg_clientes_id_cliente ................................... [[32mPASS[0m in 0.13s]
[0m00:33:48.411485 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (execute): 00:33:48.356150 => 00:33:48.411123
[0m00:33:48.412029 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:33:48.413841 [debug] [Thread-1 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (execute): 00:33:48.360482 => 00:33:48.413594
[0m00:33:48.414970 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:33:48.415876 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: ROLLBACK
[0m00:33:48.417882 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (execute): 00:33:48.364562 => 00:33:48.417630
[0m00:33:48.418723 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: ROLLBACK
[0m00:33:48.420524 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: Close
[0m00:33:48.421129 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: ROLLBACK
[0m00:33:48.422090 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: Close
[0m00:33:48.423252 [info ] [Thread-4 (]: 8 of 8 PASS unique_stg_clientes_id_cliente ..................................... [[32mPASS[0m in 0.12s]
[0m00:33:48.424534 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: Close
[0m00:33:48.426325 [info ] [Thread-1 (]: 7 of 8 PASS unique_stg_clientes_email .......................................... [[32mPASS[0m in 0.12s]
[0m00:33:48.427889 [debug] [Thread-4 (]: Finished running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:33:48.430156 [info ] [Thread-3 (]: 6 of 8 PASS not_null_stg_clientes_nome ......................................... [[32mPASS[0m in 0.14s]
[0m00:33:48.432670 [debug] [Thread-1 (]: Finished running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:33:48.436560 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:33:48.441137 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:48.442272 [debug] [MainThread]: On master: BEGIN
[0m00:33:48.443254 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:33:48.453266 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:33:48.454416 [debug] [MainThread]: On master: COMMIT
[0m00:33:48.455747 [debug] [MainThread]: Using postgres connection "master"
[0m00:33:48.456987 [debug] [MainThread]: On master: COMMIT
[0m00:33:48.459045 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:33:48.462033 [debug] [MainThread]: On master: Close
[0m00:33:48.463947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:48.465422 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_email.2b7c7e0aff' was properly closed.
[0m00:33:48.466775 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2' was properly closed.
[0m00:33:48.467854 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_clientes_nome.04166b95e6' was properly closed.
[0m00:33:48.468806 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3' was properly closed.
[0m00:33:48.469664 [info ] [MainThread]: 
[0m00:33:48.470943 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m00:33:48.474457 [debug] [MainThread]: Command end result
[0m00:33:48.503238 [info ] [MainThread]: 
[0m00:33:48.505397 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:33:48.507239 [info ] [MainThread]: 
[0m00:33:48.509498 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_clientes_estado__char_length_estado_2 (models/stagking/stg_clientes.yml)
  syntax error at or near "char_length"
  LINE 15: where not(estado char_length(estado) = 2)
                            ^
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.yml/dbt_utils_expression_is_true_s_8eb9cc185edfbc26f8cf0f06e318d10c.sql
[0m00:33:48.511307 [info ] [MainThread]: 
[0m00:33:48.513334 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m00:33:48.516161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a159abdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a1400ed40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a10fab8b0>]}
[0m00:33:48.518053 [debug] [MainThread]: Flushing usage events
[0m00:34:53.924522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bf3fc9fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bf3e7c2c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bf40330d30>]}


============================== 00:34:53.930663 | 3dffbb9d-034a-4a70-8cb2-726913d0a2e3 ==============================
[0m00:34:53.930663 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:34:53.931911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:34:54.164043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3dffbb9d-034a-4a70-8cb2-726913d0a2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bf3e7c2c20>]}
[0m00:34:54.285060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3dffbb9d-034a-4a70-8cb2-726913d0a2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bf3e40fee0>]}
[0m00:34:54.287018 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:34:54.328840 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:34:55.123638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:34:55.124972 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/stg_clientes.yml
[0m00:34:55.524955 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.staging
- models.mage_case.data_mart
[0m00:34:55.533989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3dffbb9d-034a-4a70-8cb2-726913d0a2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bf3c8f5000>]}
[0m00:34:55.576848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3dffbb9d-034a-4a70-8cb2-726913d0a2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bf3c4d69b0>]}
[0m00:34:55.578348 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m00:34:55.579865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dffbb9d-034a-4a70-8cb2-726913d0a2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bf3c4d6ad0>]}
[0m00:34:55.584108 [info ] [MainThread]: 
[0m00:34:55.586657 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:34:55.589761 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m00:34:55.607279 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:34:55.608654 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:34:55.609828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:55.623057 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:34:55.624443 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:34:55.625695 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:34:55.630856 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:34:55.634304 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:34:55.636405 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:34:55.646162 [debug] [MainThread]: Using postgres connection "master"
[0m00:34:55.647684 [debug] [MainThread]: On master: BEGIN
[0m00:34:55.648659 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:34:55.659137 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:34:55.661145 [debug] [MainThread]: Using postgres connection "master"
[0m00:34:55.662525 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:34:55.668648 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m00:34:55.671841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dffbb9d-034a-4a70-8cb2-726913d0a2e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bf3c4d5270>]}
[0m00:34:55.673017 [debug] [MainThread]: On master: ROLLBACK
[0m00:34:55.674181 [debug] [MainThread]: Using postgres connection "master"
[0m00:34:55.675320 [debug] [MainThread]: On master: BEGIN
[0m00:34:55.676740 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:34:55.677776 [debug] [MainThread]: On master: COMMIT
[0m00:34:55.678557 [debug] [MainThread]: Using postgres connection "master"
[0m00:34:55.679339 [debug] [MainThread]: On master: COMMIT
[0m00:34:55.680212 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:34:55.680959 [debug] [MainThread]: On master: Close
[0m00:34:55.682229 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:34:55.683245 [info ] [MainThread]: 
[0m00:34:55.693055 [debug] [Thread-1 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_.5fc88ea9ac
[0m00:34:55.693870 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:34:55.694697 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:34:55.695373 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:34:55.696678 [info ] [Thread-1 (]: 1 of 8 START test dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_  [RUN]
[0m00:34:55.698803 [info ] [Thread-2 (]: 2 of 8 START test not_null_stg_clientes_cidade ................................. [RUN]
[0m00:34:55.700184 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_clientes_email .................................. [RUN]
[0m00:34:55.701619 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_clientes_estado ................................. [RUN]
[0m00:34:55.703437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_.5fc88ea9ac)
[0m00:34:55.705572 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73'
[0m00:34:55.707730 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_email.d1824e153a'
[0m00:34:55.709706 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_estado.33c8769c0b'
[0m00:34:55.711507 [debug] [Thread-1 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_.5fc88ea9ac
[0m00:34:55.713126 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:34:55.714370 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:34:55.715469 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:34:55.730422 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_.5fc88ea9ac"
[0m00:34:55.739851 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:34:55.745511 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:34:55.757151 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:34:55.765580 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (compile): 00:34:55.731211 => 00:34:55.764829
[0m00:34:55.767763 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_.5fc88ea9ac (compile): 00:34:55.716708 => 00:34:55.767125
[0m00:34:55.769315 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:34:55.770384 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (compile): 00:34:55.746655 => 00:34:55.769915
[0m00:34:55.773413 [debug] [Thread-1 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_.5fc88ea9ac
[0m00:34:55.775317 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (compile): 00:34:55.740817 => 00:34:55.774793
[0m00:34:55.798708 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:34:55.799415 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:34:55.805023 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_.5fc88ea9ac"
[0m00:34:55.806437 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:34:55.810201 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:34:55.815494 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:34:55.820529 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_.5fc88ea9ac"
[0m00:34:55.822670 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_.5fc88ea9ac: BEGIN
[0m00:34:55.823607 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:34:55.824174 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:34:55.825439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:55.826958 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: BEGIN
[0m00:34:55.827825 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:34:55.829012 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: BEGIN
[0m00:34:55.831422 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:34:55.832911 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: BEGIN
[0m00:34:55.834333 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:34:55.838252 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:34:55.844123 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:34:55.851667 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:34:55.852568 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:34:55.853127 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_.5fc88ea9ac"
[0m00:34:55.854257 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:34:55.855253 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:34:55.856688 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:34:55.857977 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_.5fc88ea9ac: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_.5fc88ea9ac"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_clientes"

where not(estado (char_length(estado) = 2))


      
    ) dbt_internal_test
[0m00:34:55.859262 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:34:55.860489 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cidade
from "dbt"."public"."stg_clientes"
where cidade is null



      
    ) dbt_internal_test
[0m00:34:55.861784 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_email.d1824e153a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from "dbt"."public"."stg_clientes"
where email is null



      
    ) dbt_internal_test
[0m00:34:55.863988 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select estado
from "dbt"."public"."stg_clientes"
where estado is null



      
    ) dbt_internal_test
[0m00:34:55.865254 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function estado(boolean) does not exist
LINE 15: where not(estado (char_length(estado) = 2))
                   ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:34:55.867335 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:34:55.868321 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:34:55.869025 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:34:55.869757 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_.5fc88ea9ac: ROLLBACK
[0m00:34:55.872571 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (execute): 00:34:55.775814 => 00:34:55.872268
[0m00:34:55.874942 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (execute): 00:34:55.812668 => 00:34:55.874663
[0m00:34:55.876997 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (execute): 00:34:55.807449 => 00:34:55.876736
[0m00:34:55.878296 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_.5fc88ea9ac (execute): 00:34:55.800548 => 00:34:55.878020
[0m00:34:55.878970 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: ROLLBACK
[0m00:34:55.879861 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: ROLLBACK
[0m00:34:55.880803 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: ROLLBACK
[0m00:34:55.881744 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_.5fc88ea9ac: Close
[0m00:34:55.882847 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: Close
[0m00:34:55.883725 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: Close
[0m00:34:55.884589 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: Close
[0m00:34:55.887974 [info ] [Thread-2 (]: 2 of 8 PASS not_null_stg_clientes_cidade ....................................... [[32mPASS[0m in 0.18s]
[0m00:34:55.890478 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_clientes_email ........................................ [[32mPASS[0m in 0.18s]
[0m00:34:55.892188 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_ (models/stagking/stg_clientes.yml)
  function estado(boolean) does not exist
  LINE 15: where not(estado (char_length(estado) = 2))
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.yml/dbt_utils_expression_is_true_s_88a6770c85e7d759df9c7d112bf35d57.sql
[0m00:34:55.893627 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_clientes_estado ....................................... [[32mPASS[0m in 0.18s]
[0m00:34:55.895070 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:34:55.896628 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:34:55.897910 [error] [Thread-1 (]: 1 of 8 ERROR dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_  [[31mERROR[0m in 0.19s]
[0m00:34:55.899602 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:34:55.901222 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:34:55.902986 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:34:55.905334 [debug] [Thread-1 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_.5fc88ea9ac
[0m00:34:55.907441 [debug] [Thread-4 (]: Began running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:34:55.908931 [info ] [Thread-2 (]: 5 of 8 START test not_null_stg_clientes_id_cliente ............................. [RUN]
[0m00:34:55.911347 [info ] [Thread-3 (]: 6 of 8 START test not_null_stg_clientes_nome ................................... [RUN]
[0m00:34:55.913280 [debug] [Thread-1 (]: Began running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:34:55.914858 [info ] [Thread-4 (]: 7 of 8 START test unique_stg_clientes_email .................................... [RUN]
[0m00:34:55.917493 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73, now test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2)
[0m00:34:55.919867 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_email.d1824e153a, now test.mage_case.not_null_stg_clientes_nome.04166b95e6)
[0m00:34:55.921258 [info ] [Thread-1 (]: 8 of 8 START test unique_stg_clientes_id_cliente ............................... [RUN]
[0m00:34:55.923165 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_estado.33c8769c0b, now test.mage_case.unique_stg_clientes_email.2b7c7e0aff)
[0m00:34:55.924565 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:34:55.926023 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:34:55.928093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_.5fc88ea9ac, now test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3)
[0m00:34:55.929318 [debug] [Thread-4 (]: Began compiling node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:34:55.936696 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:34:55.944485 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:34:55.946025 [debug] [Thread-1 (]: Began compiling node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:34:55.957222 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:34:55.965611 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:34:55.971924 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (compile): 00:34:55.930215 => 00:34:55.971331
[0m00:34:55.972902 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (compile): 00:34:55.937476 => 00:34:55.972409
[0m00:34:55.974190 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:34:55.975206 [debug] [Thread-1 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (compile): 00:34:55.959980 => 00:34:55.974793
[0m00:34:55.976353 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (compile): 00:34:55.948560 => 00:34:55.975616
[0m00:34:55.977375 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:34:55.983488 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:34:55.984926 [debug] [Thread-1 (]: Began executing node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:34:55.986067 [debug] [Thread-4 (]: Began executing node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:34:55.989890 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:34:55.995280 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:34:55.999217 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:34:56.000664 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:34:56.002809 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:34:56.003937 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: BEGIN
[0m00:34:56.004963 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:34:56.005818 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: BEGIN
[0m00:34:56.007253 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:34:56.007801 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:34:56.008841 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: BEGIN
[0m00:34:56.009892 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:34:56.011910 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: BEGIN
[0m00:34:56.013081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:56.015467 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:34:56.020878 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:34:56.020487 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:34:56.022014 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_cliente
from "dbt"."public"."stg_clientes"
where id_cliente is null



      
    ) dbt_internal_test
[0m00:34:56.023099 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:34:56.024618 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:34:56.025341 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:34:56.026533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:34:56.027062 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:34:56.027578 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_nome.04166b95e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome
from "dbt"."public"."stg_clientes"
where nome is null



      
    ) dbt_internal_test
[0m00:34:56.030148 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (execute): 00:34:55.978729 => 00:34:56.029853
[0m00:34:56.031244 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:34:56.032471 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:34:56.034379 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: ROLLBACK
[0m00:34:56.034940 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:34:56.035972 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_cliente as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where id_cliente is not null
group by id_cliente
having count(*) > 1



      
    ) dbt_internal_test
[0m00:34:56.037045 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where email is not null
group by email
having count(*) > 1



      
    ) dbt_internal_test
[0m00:34:56.038546 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: Close
[0m00:34:56.040942 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (execute): 00:34:55.986962 => 00:34:56.040554
[0m00:34:56.044675 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:34:56.044093 [info ] [Thread-2 (]: 5 of 8 PASS not_null_stg_clientes_id_cliente ................................... [[32mPASS[0m in 0.13s]
[0m00:34:56.045587 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:34:56.046413 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: ROLLBACK
[0m00:34:56.048670 [debug] [Thread-1 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (execute): 00:34:55.991664 => 00:34:56.048409
[0m00:34:56.050064 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:34:56.052089 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (execute): 00:34:55.996286 => 00:34:56.051818
[0m00:34:56.053397 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: Close
[0m00:34:56.054080 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: ROLLBACK
[0m00:34:56.055534 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: ROLLBACK
[0m00:34:56.057053 [info ] [Thread-3 (]: 6 of 8 PASS not_null_stg_clientes_nome ......................................... [[32mPASS[0m in 0.14s]
[0m00:34:56.058181 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: Close
[0m00:34:56.059349 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: Close
[0m00:34:56.060770 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:34:56.062666 [info ] [Thread-1 (]: 8 of 8 PASS unique_stg_clientes_id_cliente ..................................... [[32mPASS[0m in 0.13s]
[0m00:34:56.064522 [info ] [Thread-4 (]: 7 of 8 PASS unique_stg_clientes_email .......................................... [[32mPASS[0m in 0.14s]
[0m00:34:56.066824 [debug] [Thread-1 (]: Finished running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:34:56.068011 [debug] [Thread-4 (]: Finished running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:34:56.072157 [debug] [MainThread]: Using postgres connection "master"
[0m00:34:56.073714 [debug] [MainThread]: On master: BEGIN
[0m00:34:56.074668 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:34:56.085815 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:34:56.086966 [debug] [MainThread]: On master: COMMIT
[0m00:34:56.087831 [debug] [MainThread]: Using postgres connection "master"
[0m00:34:56.088772 [debug] [MainThread]: On master: COMMIT
[0m00:34:56.090097 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:34:56.091333 [debug] [MainThread]: On master: Close
[0m00:34:56.092575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:56.093755 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3' was properly closed.
[0m00:34:56.094804 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2' was properly closed.
[0m00:34:56.095809 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_clientes_nome.04166b95e6' was properly closed.
[0m00:34:56.097101 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_email.2b7c7e0aff' was properly closed.
[0m00:34:56.099144 [info ] [MainThread]: 
[0m00:34:56.101183 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m00:34:56.104836 [debug] [MainThread]: Command end result
[0m00:34:56.138452 [info ] [MainThread]: 
[0m00:34:56.140034 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:34:56.141910 [info ] [MainThread]: 
[0m00:34:56.143828 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_clientes_estado___char_length_estado_2_ (models/stagking/stg_clientes.yml)
  function estado(boolean) does not exist
  LINE 15: where not(estado (char_length(estado) = 2))
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/mage_case/models/stagking/stg_clientes.yml/dbt_utils_expression_is_true_s_88a6770c85e7d759df9c7d112bf35d57.sql
[0m00:34:56.145707 [info ] [MainThread]: 
[0m00:34:56.147308 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m00:34:56.149676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bf3fc9fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bf3e152d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bf3b0da140>]}
[0m00:34:56.150927 [debug] [MainThread]: Flushing usage events
[0m00:37:59.916168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77324ad33310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77324b738e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77324b472260>]}


============================== 00:37:59.922481 | 995fb2d8-e938-4b95-9fb0-5de6918fe49b ==============================
[0m00:37:59.922481 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:37:59.923615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:38:00.137104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '995fb2d8-e938-4b95-9fb0-5de6918fe49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77324b738e50>]}
[0m00:38:00.232827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '995fb2d8-e938-4b95-9fb0-5de6918fe49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77324984bb80>]}
[0m00:38:00.234527 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:38:00.261451 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:38:01.035943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:38:01.037403 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/stg_clientes.yml
[0m00:38:01.421548 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.staging
- models.mage_case.data_mart
[0m00:38:01.430287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '995fb2d8-e938-4b95-9fb0-5de6918fe49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773247b8ebf0>]}
[0m00:38:01.472336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '995fb2d8-e938-4b95-9fb0-5de6918fe49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77324771a9b0>]}
[0m00:38:01.474023 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m00:38:01.475499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '995fb2d8-e938-4b95-9fb0-5de6918fe49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77324771ab30>]}
[0m00:38:01.479173 [info ] [MainThread]: 
[0m00:38:01.481720 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:38:01.485478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m00:38:01.502196 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:38:01.503840 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:38:01.505441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:01.518309 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:38:01.519662 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:38:01.520752 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:38:01.525944 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:38:01.528464 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:38:01.530293 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:38:01.541381 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:01.542671 [debug] [MainThread]: On master: BEGIN
[0m00:38:01.544088 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:01.555426 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:38:01.556698 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:01.558247 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:38:01.565943 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m00:38:01.569431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '995fb2d8-e938-4b95-9fb0-5de6918fe49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773247719270>]}
[0m00:38:01.570847 [debug] [MainThread]: On master: ROLLBACK
[0m00:38:01.572361 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:01.573322 [debug] [MainThread]: On master: BEGIN
[0m00:38:01.574925 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:38:01.575981 [debug] [MainThread]: On master: COMMIT
[0m00:38:01.576902 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:01.578129 [debug] [MainThread]: On master: COMMIT
[0m00:38:01.579374 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:01.580471 [debug] [MainThread]: On master: Close
[0m00:38:01.582012 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:38:01.584019 [info ] [MainThread]: 
[0m00:38:01.597376 [debug] [Thread-1 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2.5c71f92ed3
[0m00:38:01.598671 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:38:01.599705 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:38:01.600654 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:38:01.603138 [info ] [Thread-1 (]: 1 of 8 START test dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2  [RUN]
[0m00:38:01.606145 [info ] [Thread-2 (]: 2 of 8 START test not_null_stg_clientes_cidade ................................. [RUN]
[0m00:38:01.609694 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_clientes_email .................................. [RUN]
[0m00:38:01.612339 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_clientes_estado ................................. [RUN]
[0m00:38:01.615252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2.5c71f92ed3)
[0m00:38:01.617829 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73'
[0m00:38:01.620595 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_email.d1824e153a'
[0m00:38:01.624340 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_estado.33c8769c0b'
[0m00:38:01.626428 [debug] [Thread-1 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2.5c71f92ed3
[0m00:38:01.628393 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:38:01.633503 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:38:01.636871 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:38:01.675596 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2.5c71f92ed3"
[0m00:38:01.680589 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:38:01.688727 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:38:01.701583 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:38:01.711641 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2.5c71f92ed3 (compile): 00:38:01.640880 => 00:38:01.711023
[0m00:38:01.713624 [debug] [Thread-1 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2.5c71f92ed3
[0m00:38:01.715718 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (compile): 00:38:01.663930 => 00:38:01.715173
[0m00:38:01.716855 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (compile): 00:38:01.681329 => 00:38:01.716346
[0m00:38:01.723671 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (compile): 00:38:01.689781 => 00:38:01.723164
[0m00:38:01.744861 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2.5c71f92ed3"
[0m00:38:01.745449 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:38:01.746519 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:38:01.747475 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:38:01.752203 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:38:01.756135 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:38:01.760491 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:38:01.761802 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2.5c71f92ed3"
[0m00:38:01.765952 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2.5c71f92ed3: BEGIN
[0m00:38:01.767241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:38:01.771206 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:38:01.772068 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:38:01.776890 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: BEGIN
[0m00:38:01.777617 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:38:01.778160 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:38:01.778808 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: BEGIN
[0m00:38:01.779801 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:38:01.780765 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: BEGIN
[0m00:38:01.781633 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2.5c71f92ed3"
[0m00:38:01.782485 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:38:01.784054 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:38:01.785013 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2.5c71f92ed3: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2.5c71f92ed3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_clientes"

where not(estado  IS NULL AND char_length(estado) = 2)


      
    ) dbt_internal_test
[0m00:38:01.789232 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:01.792272 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2.5c71f92ed3 (execute): 00:38:01.717533 => 00:38:01.791961
[0m00:38:01.793306 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2.5c71f92ed3: ROLLBACK
[0m00:38:01.793764 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:38:01.794818 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2.5c71f92ed3: Close
[0m00:38:01.795395 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:38:01.796224 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:38:01.796662 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:38:01.798151 [error] [Thread-1 (]: 1 of 8 FAIL 10 dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2  [[31mFAIL 10[0m in 0.18s]
[0m00:38:01.799009 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:38:01.800069 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:38:01.801172 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_email.d1824e153a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from "dbt"."public"."stg_clientes"
where email is null



      
    ) dbt_internal_test
[0m00:38:01.802315 [debug] [Thread-1 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2.5c71f92ed3
[0m00:38:01.803263 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cidade
from "dbt"."public"."stg_clientes"
where cidade is null



      
    ) dbt_internal_test
[0m00:38:01.804152 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select estado
from "dbt"."public"."stg_clientes"
where estado is null



      
    ) dbt_internal_test
[0m00:38:01.805753 [debug] [Thread-1 (]: Began running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:38:01.806322 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:01.808278 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:01.809302 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:01.808774 [info ] [Thread-1 (]: 5 of 8 START test not_null_stg_clientes_id_cliente ............................. [RUN]
[0m00:38:01.811710 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (execute): 00:38:01.753255 => 00:38:01.811392
[0m00:38:01.814261 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (execute): 00:38:01.748762 => 00:38:01.813868
[0m00:38:01.817184 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (execute): 00:38:01.757248 => 00:38:01.816691
[0m00:38:01.819681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2.5c71f92ed3, now test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2)
[0m00:38:01.821080 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: ROLLBACK
[0m00:38:01.822509 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: ROLLBACK
[0m00:38:01.823638 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: ROLLBACK
[0m00:38:01.824934 [debug] [Thread-1 (]: Began compiling node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:38:01.826552 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: Close
[0m00:38:01.827692 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: Close
[0m00:38:01.829033 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: Close
[0m00:38:01.835252 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:38:01.837129 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_clientes_email ........................................ [[32mPASS[0m in 0.22s]
[0m00:38:01.839368 [info ] [Thread-2 (]: 2 of 8 PASS not_null_stg_clientes_cidade ....................................... [[32mPASS[0m in 0.22s]
[0m00:38:01.842044 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_clientes_estado ....................................... [[32mPASS[0m in 0.22s]
[0m00:38:01.844632 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:38:01.846314 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:38:01.847816 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:38:01.848945 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:38:01.850087 [debug] [Thread-2 (]: Began running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:38:01.851692 [debug] [Thread-4 (]: Began running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:38:01.853016 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (compile): 00:38:01.830025 => 00:38:01.852621
[0m00:38:01.853591 [info ] [Thread-3 (]: 6 of 8 START test not_null_stg_clientes_nome ................................... [RUN]
[0m00:38:01.855036 [info ] [Thread-2 (]: 7 of 8 START test unique_stg_clientes_email .................................... [RUN]
[0m00:38:01.857004 [info ] [Thread-4 (]: 8 of 8 START test unique_stg_clientes_id_cliente ............................... [RUN]
[0m00:38:01.858866 [debug] [Thread-1 (]: Began executing node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:38:01.861619 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_email.d1824e153a, now test.mage_case.not_null_stg_clientes_nome.04166b95e6)
[0m00:38:01.864082 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73, now test.mage_case.unique_stg_clientes_email.2b7c7e0aff)
[0m00:38:01.866272 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_estado.33c8769c0b, now test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3)
[0m00:38:01.874354 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:38:01.875774 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:38:01.876942 [debug] [Thread-2 (]: Began compiling node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:38:01.878055 [debug] [Thread-4 (]: Began compiling node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:38:01.886904 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:38:01.896784 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:38:01.902759 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:38:01.903406 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:38:01.906236 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: BEGIN
[0m00:38:01.907552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:38:01.909784 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (compile): 00:38:01.880129 => 00:38:01.909178
[0m00:38:01.911506 [debug] [Thread-2 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (compile): 00:38:01.888072 => 00:38:01.910983
[0m00:38:01.916342 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:38:01.917235 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (compile): 00:38:01.898061 => 00:38:01.916782
[0m00:38:01.918555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:38:01.919147 [debug] [Thread-2 (]: Began executing node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:38:01.923231 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:38:01.924531 [debug] [Thread-4 (]: Began executing node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:38:01.925824 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:38:01.930040 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:38:01.935480 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:38:01.936739 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_cliente
from "dbt"."public"."stg_clientes"
where id_cliente is null



      
    ) dbt_internal_test
[0m00:38:01.940795 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:01.941722 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:38:01.942390 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:38:01.944490 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (execute): 00:38:01.867945 => 00:38:01.944195
[0m00:38:01.945398 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:38:01.946118 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: BEGIN
[0m00:38:01.947145 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: BEGIN
[0m00:38:01.948063 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: ROLLBACK
[0m00:38:01.948957 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: BEGIN
[0m00:38:01.949902 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:38:01.950784 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:38:01.951805 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: Close
[0m00:38:01.952377 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:38:01.955443 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stg_clientes_id_cliente ................................... [[32mPASS[0m in 0.14s]
[0m00:38:01.958625 [debug] [Thread-1 (]: Finished running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:38:01.964637 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:38:01.965218 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:38:01.966214 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:38:01.966712 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:38:01.968268 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:38:01.969600 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:38:01.970841 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where email is not null
group by email
having count(*) > 1



      
    ) dbt_internal_test
[0m00:38:01.972259 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_nome.04166b95e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome
from "dbt"."public"."stg_clientes"
where nome is null



      
    ) dbt_internal_test
[0m00:38:01.973445 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_cliente as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where id_cliente is not null
group by id_cliente
having count(*) > 1



      
    ) dbt_internal_test
[0m00:38:01.976093 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:01.977115 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:01.980452 [debug] [Thread-2 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (execute): 00:38:01.927063 => 00:38:01.980084
[0m00:38:01.981171 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:01.984045 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (execute): 00:38:01.920133 => 00:38:01.983648
[0m00:38:01.985519 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: ROLLBACK
[0m00:38:01.987985 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (execute): 00:38:01.932651 => 00:38:01.987657
[0m00:38:01.989316 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: ROLLBACK
[0m00:38:01.990752 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: Close
[0m00:38:01.991681 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: ROLLBACK
[0m00:38:01.993211 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: Close
[0m00:38:01.994866 [info ] [Thread-2 (]: 7 of 8 PASS unique_stg_clientes_email .......................................... [[32mPASS[0m in 0.13s]
[0m00:38:01.996391 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: Close
[0m00:38:01.998252 [info ] [Thread-3 (]: 6 of 8 PASS not_null_stg_clientes_nome ......................................... [[32mPASS[0m in 0.14s]
[0m00:38:01.999875 [debug] [Thread-2 (]: Finished running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:38:02.002524 [info ] [Thread-4 (]: 8 of 8 PASS unique_stg_clientes_id_cliente ..................................... [[32mPASS[0m in 0.14s]
[0m00:38:02.004584 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:38:02.008580 [debug] [Thread-4 (]: Finished running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:38:02.014539 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:02.016870 [debug] [MainThread]: On master: BEGIN
[0m00:38:02.018706 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:38:02.032290 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:38:02.034018 [debug] [MainThread]: On master: COMMIT
[0m00:38:02.035692 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:02.037096 [debug] [MainThread]: On master: COMMIT
[0m00:38:02.038509 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:02.039793 [debug] [MainThread]: On master: Close
[0m00:38:02.041685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:02.044219 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2' was properly closed.
[0m00:38:02.045341 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_email.2b7c7e0aff' was properly closed.
[0m00:38:02.046684 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_clientes_nome.04166b95e6' was properly closed.
[0m00:38:02.047837 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3' was properly closed.
[0m00:38:02.049857 [info ] [MainThread]: 
[0m00:38:02.052198 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m00:38:02.056045 [debug] [MainThread]: Command end result
[0m00:38:02.084406 [info ] [MainThread]: 
[0m00:38:02.086461 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:38:02.089662 [info ] [MainThread]: 
[0m00:38:02.091963 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_clientes_estado___IS_NULL_AND_char_length_estado_2 (models/stagking/stg_clientes.yml)[0m
[0m00:38:02.095533 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m00:38:02.097885 [info ] [MainThread]: 
[0m00:38:02.100231 [info ] [MainThread]:   compiled Code at target/compiled/mage_case/models/stagking/stg_clientes.yml/dbt_utils_expression_is_true_s_6646d2cd5483c9aae94bb97272dbb441.sql
[0m00:38:02.102276 [info ] [MainThread]: 
[0m00:38:02.105023 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m00:38:02.108675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77324ad33310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77324652b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7732464b7a90>]}
[0m00:38:02.111966 [debug] [MainThread]: Flushing usage events
[0m00:38:23.835199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7747dc647df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7747db16ac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7747dccc8d30>]}


============================== 00:38:23.841417 | 26f46e60-0f0b-4a7e-abe2-6faac2e216fd ==============================
[0m00:38:23.841417 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:38:23.842579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:38:24.055153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26f46e60-0f0b-4a7e-abe2-6faac2e216fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7747db16ac20>]}
[0m00:38:24.153725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26f46e60-0f0b-4a7e-abe2-6faac2e216fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7747dadabee0>]}
[0m00:38:24.155620 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:38:24.186667 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:38:24.991438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:38:24.992649 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/stg_clientes.yml
[0m00:38:25.370367 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.data_mart
- models.mage_case.staging
[0m00:38:25.379242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26f46e60-0f0b-4a7e-abe2-6faac2e216fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7747d9291000>]}
[0m00:38:25.418101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26f46e60-0f0b-4a7e-abe2-6faac2e216fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7747d8f929b0>]}
[0m00:38:25.419411 [info ] [MainThread]: Found 4 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m00:38:25.420979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26f46e60-0f0b-4a7e-abe2-6faac2e216fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7747d8f92ad0>]}
[0m00:38:25.425342 [info ] [MainThread]: 
[0m00:38:25.427552 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:38:25.430715 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m00:38:25.447591 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:38:25.448984 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:38:25.450282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:25.466418 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:38:25.467870 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:38:25.469261 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:38:25.474736 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:38:25.477226 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:38:25.478339 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:38:25.487497 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:25.488789 [debug] [MainThread]: On master: BEGIN
[0m00:38:25.489995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:38:25.499831 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:38:25.500999 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:25.502107 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:38:25.507803 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m00:38:25.510928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26f46e60-0f0b-4a7e-abe2-6faac2e216fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7747d8f91270>]}
[0m00:38:25.512041 [debug] [MainThread]: On master: ROLLBACK
[0m00:38:25.513331 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:25.514307 [debug] [MainThread]: On master: BEGIN
[0m00:38:25.515371 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:38:25.516209 [debug] [MainThread]: On master: COMMIT
[0m00:38:25.516951 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:25.517702 [debug] [MainThread]: On master: COMMIT
[0m00:38:25.518561 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:25.519455 [debug] [MainThread]: On master: Close
[0m00:38:25.520861 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:38:25.521978 [info ] [MainThread]: 
[0m00:38:25.530820 [debug] [Thread-1 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:38:25.531371 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:38:25.531904 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:38:25.532387 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:38:25.533142 [info ] [Thread-1 (]: 1 of 8 START test dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2  [RUN]
[0m00:38:25.534174 [info ] [Thread-2 (]: 2 of 8 START test not_null_stg_clientes_cidade ................................. [RUN]
[0m00:38:25.535736 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_clientes_email .................................. [RUN]
[0m00:38:25.537200 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_clientes_estado ................................. [RUN]
[0m00:38:25.538958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23)
[0m00:38:25.541088 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73'
[0m00:38:25.543160 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_email.d1824e153a'
[0m00:38:25.545558 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_estado.33c8769c0b'
[0m00:38:25.546909 [debug] [Thread-1 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:38:25.548326 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:38:25.549406 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:38:25.550746 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:38:25.566188 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:38:25.575768 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:38:25.583341 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:38:25.590743 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:38:25.597288 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23 (compile): 00:38:25.552876 => 00:38:25.596709
[0m00:38:25.599294 [debug] [Thread-1 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:38:25.600458 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (compile): 00:38:25.584388 => 00:38:25.599895
[0m00:38:25.601780 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (compile): 00:38:25.576904 => 00:38:25.601200
[0m00:38:25.608464 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (compile): 00:38:25.566934 => 00:38:25.608080
[0m00:38:25.621113 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:38:25.622058 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:38:25.623539 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:38:25.624948 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:38:25.629877 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:38:25.633427 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:38:25.637008 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:38:25.637592 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:38:25.640367 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: BEGIN
[0m00:38:25.641485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:38:25.645075 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:38:25.645941 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:38:25.647000 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: BEGIN
[0m00:38:25.647564 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:38:25.648370 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: BEGIN
[0m00:38:25.649276 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:38:25.650136 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: BEGIN
[0m00:38:25.651003 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:38:25.651857 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:38:25.653022 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:38:25.654841 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:38:25.656672 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_clientes"

where not(estado  IS NOT NULL AND char_length(estado) = 2)


      
    ) dbt_internal_test
[0m00:38:25.658987 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:25.662140 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23 (execute): 00:38:25.602846 => 00:38:25.661817
[0m00:38:25.662638 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:38:25.663582 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:38:25.664084 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: ROLLBACK
[0m00:38:25.664922 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:38:25.665599 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:38:25.666515 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:38:25.667564 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: Close
[0m00:38:25.668140 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:38:25.669052 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select estado
from "dbt"."public"."stg_clientes"
where estado is null



      
    ) dbt_internal_test
[0m00:38:25.669941 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cidade
from "dbt"."public"."stg_clientes"
where cidade is null



      
    ) dbt_internal_test
[0m00:38:25.671414 [info ] [Thread-1 (]: 1 of 8 PASS dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2  [[32mPASS[0m in 0.13s]
[0m00:38:25.672328 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_email.d1824e153a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from "dbt"."public"."stg_clientes"
where email is null



      
    ) dbt_internal_test
[0m00:38:25.674740 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:25.675365 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:25.676129 [debug] [Thread-1 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:38:25.678921 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (execute): 00:38:25.626661 => 00:38:25.678636
[0m00:38:25.679395 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:25.681244 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (execute): 00:38:25.634248 => 00:38:25.680974
[0m00:38:25.682250 [debug] [Thread-1 (]: Began running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:38:25.683222 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: ROLLBACK
[0m00:38:25.685234 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (execute): 00:38:25.630827 => 00:38:25.684919
[0m00:38:25.686167 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: ROLLBACK
[0m00:38:25.687087 [info ] [Thread-1 (]: 5 of 8 START test not_null_stg_clientes_id_cliente ............................. [RUN]
[0m00:38:25.688536 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: Close
[0m00:38:25.689593 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: ROLLBACK
[0m00:38:25.691129 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: Close
[0m00:38:25.692355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23, now test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2)
[0m00:38:25.694493 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_clientes_estado ....................................... [[32mPASS[0m in 0.15s]
[0m00:38:25.696019 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: Close
[0m00:38:25.698627 [info ] [Thread-2 (]: 2 of 8 PASS not_null_stg_clientes_cidade ....................................... [[32mPASS[0m in 0.16s]
[0m00:38:25.700324 [debug] [Thread-1 (]: Began compiling node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:38:25.702153 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:38:25.705126 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_clientes_email ........................................ [[32mPASS[0m in 0.16s]
[0m00:38:25.707169 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:38:25.714338 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:38:25.715697 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:38:25.717397 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:38:25.718966 [debug] [Thread-2 (]: Began running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:38:25.721084 [info ] [Thread-4 (]: 6 of 8 START test not_null_stg_clientes_nome ................................... [RUN]
[0m00:38:25.722754 [debug] [Thread-3 (]: Began running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:38:25.724091 [info ] [Thread-2 (]: 7 of 8 START test unique_stg_clientes_email .................................... [RUN]
[0m00:38:25.725748 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_estado.33c8769c0b, now test.mage_case.not_null_stg_clientes_nome.04166b95e6)
[0m00:38:25.727249 [info ] [Thread-3 (]: 8 of 8 START test unique_stg_clientes_id_cliente ............................... [RUN]
[0m00:38:25.729294 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73, now test.mage_case.unique_stg_clientes_email.2b7c7e0aff)
[0m00:38:25.730418 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (compile): 00:38:25.708407 => 00:38:25.729940
[0m00:38:25.731872 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:38:25.733656 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_email.d1824e153a, now test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3)
[0m00:38:25.735435 [debug] [Thread-2 (]: Began compiling node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:38:25.737479 [debug] [Thread-1 (]: Began executing node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:38:25.746548 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:38:25.747929 [debug] [Thread-3 (]: Began compiling node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:38:25.757317 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:38:25.761725 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:38:25.771077 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:38:25.774867 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (compile): 00:38:25.738677 => 00:38:25.774193
[0m00:38:25.776941 [debug] [Thread-2 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (compile): 00:38:25.749008 => 00:38:25.776449
[0m00:38:25.777705 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:38:25.778431 [debug] [Thread-3 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (compile): 00:38:25.764069 => 00:38:25.778092
[0m00:38:25.779539 [debug] [Thread-2 (]: Began executing node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:38:25.783776 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:38:25.784535 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:38:25.785647 [debug] [Thread-3 (]: Began executing node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:38:25.789771 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:38:25.791645 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: BEGIN
[0m00:38:25.796310 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:38:25.798444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:38:25.801637 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:38:25.803055 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:38:25.803783 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: BEGIN
[0m00:38:25.804504 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:38:25.805486 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: BEGIN
[0m00:38:25.806445 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:38:25.807362 [debug] [Thread-3 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: BEGIN
[0m00:38:25.808257 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:38:25.809805 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:38:25.810678 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:38:25.812510 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:38:25.815103 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_cliente
from "dbt"."public"."stg_clientes"
where id_cliente is null



      
    ) dbt_internal_test
[0m00:38:25.817684 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:25.818247 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:38:25.820249 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (execute): 00:38:25.758464 => 00:38:25.819970
[0m00:38:25.821319 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:38:25.821835 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:38:25.822769 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:38:25.823220 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: ROLLBACK
[0m00:38:25.824148 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:38:25.825192 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_nome.04166b95e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome
from "dbt"."public"."stg_clientes"
where nome is null



      
    ) dbt_internal_test
[0m00:38:25.826027 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:38:25.827098 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: Close
[0m00:38:25.827707 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where email is not null
group by email
having count(*) > 1



      
    ) dbt_internal_test
[0m00:38:25.829419 [debug] [Thread-3 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_cliente as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where id_cliente is not null
group by id_cliente
having count(*) > 1



      
    ) dbt_internal_test
[0m00:38:25.830004 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:25.831337 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stg_clientes_id_cliente ................................... [[32mPASS[0m in 0.14s]
[0m00:38:25.833783 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:25.835636 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (execute): 00:38:25.780456 => 00:38:25.835302
[0m00:38:25.836130 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:38:25.837241 [debug] [Thread-1 (]: Finished running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:38:25.839218 [debug] [Thread-2 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (execute): 00:38:25.786815 => 00:38:25.838968
[0m00:38:25.840143 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: ROLLBACK
[0m00:38:25.842177 [debug] [Thread-3 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (execute): 00:38:25.792698 => 00:38:25.841919
[0m00:38:25.843950 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: ROLLBACK
[0m00:38:25.845166 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: Close
[0m00:38:25.845800 [debug] [Thread-3 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: ROLLBACK
[0m00:38:25.846835 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: Close
[0m00:38:25.847965 [info ] [Thread-4 (]: 6 of 8 PASS not_null_stg_clientes_nome ......................................... [[32mPASS[0m in 0.12s]
[0m00:38:25.849295 [debug] [Thread-3 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: Close
[0m00:38:25.851320 [info ] [Thread-2 (]: 7 of 8 PASS unique_stg_clientes_email .......................................... [[32mPASS[0m in 0.12s]
[0m00:38:25.853681 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:38:25.856165 [info ] [Thread-3 (]: 8 of 8 PASS unique_stg_clientes_id_cliente ..................................... [[32mPASS[0m in 0.12s]
[0m00:38:25.858399 [debug] [Thread-2 (]: Finished running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:38:25.861032 [debug] [Thread-3 (]: Finished running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:38:25.865538 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:25.866795 [debug] [MainThread]: On master: BEGIN
[0m00:38:25.867652 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:38:25.877386 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:38:25.880018 [debug] [MainThread]: On master: COMMIT
[0m00:38:25.881660 [debug] [MainThread]: Using postgres connection "master"
[0m00:38:25.882827 [debug] [MainThread]: On master: COMMIT
[0m00:38:25.884392 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:38:25.885672 [debug] [MainThread]: On master: Close
[0m00:38:25.887055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:25.888033 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2' was properly closed.
[0m00:38:25.888948 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_email.2b7c7e0aff' was properly closed.
[0m00:38:25.889910 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3' was properly closed.
[0m00:38:25.890864 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_clientes_nome.04166b95e6' was properly closed.
[0m00:38:25.891764 [info ] [MainThread]: 
[0m00:38:25.892850 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m00:38:25.896165 [debug] [MainThread]: Command end result
[0m00:38:25.927397 [info ] [MainThread]: 
[0m00:38:25.929030 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:38:25.930731 [info ] [MainThread]: 
[0m00:38:25.932850 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m00:38:25.936456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7747dc647df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7747dce4ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7747daaead40>]}
[0m00:38:25.938210 [debug] [MainThread]: Flushing usage events
[0m00:40:40.737503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63a05a0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f639f0b9fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f639f0b8a90>]}


============================== 00:40:40.743553 | 3f184fb2-3755-4adf-809a-7fdc45654391 ==============================
[0m00:40:40.743553 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:40:40.744657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:40:40.974956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f184fb2-3755-4adf-809a-7fdc45654391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f639ec06e60>]}
[0m00:40:41.077427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f184fb2-3755-4adf-809a-7fdc45654391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f639ebca3b0>]}
[0m00:40:41.079400 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:40:41.108355 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:40:41.971740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:40:41.973027 [debug] [MainThread]: Partial parsing: added file: mage_case://models/stagking/stg_itens_vendas.yml
[0m00:40:41.974031 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/stg_itens_vendas.sql
[0m00:40:42.360273 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.data_mart
- models.mage_case.staging
[0m00:40:42.369728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f184fb2-3755-4adf-809a-7fdc45654391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f639d2844f0>]}
[0m00:40:42.408947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f184fb2-3755-4adf-809a-7fdc45654391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f639d0aaa70>]}
[0m00:40:42.410299 [info ] [MainThread]: Found 4 models, 15 tests, 4 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m00:40:42.411824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f184fb2-3755-4adf-809a-7fdc45654391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f639d0aace0>]}
[0m00:40:42.415617 [info ] [MainThread]: 
[0m00:40:42.417855 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:40:42.421388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:40:42.438677 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:40:42.440001 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:40:42.441098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:40:42.457265 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m00:40:42.459641 [debug] [ThreadPool]: On list_dbt: Close
[0m00:40:42.463127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_public)
[0m00:40:42.471206 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:40:42.472710 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:40:42.474355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:40:42.486059 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:40:42.487372 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:40:42.488277 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:40:42.492707 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:40:42.494782 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:40:42.495876 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:40:42.503843 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:42.504999 [debug] [MainThread]: On master: BEGIN
[0m00:40:42.505847 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:40:42.515435 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:40:42.516735 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:42.517739 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:40:42.523684 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m00:40:42.526525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f184fb2-3755-4adf-809a-7fdc45654391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f637fdce560>]}
[0m00:40:42.527563 [debug] [MainThread]: On master: ROLLBACK
[0m00:40:42.528560 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:42.529306 [debug] [MainThread]: On master: BEGIN
[0m00:40:42.530447 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:40:42.531446 [debug] [MainThread]: On master: COMMIT
[0m00:40:42.532310 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:42.533151 [debug] [MainThread]: On master: COMMIT
[0m00:40:42.534223 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:40:42.535012 [debug] [MainThread]: On master: Close
[0m00:40:42.536186 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:40:42.537238 [info ] [MainThread]: 
[0m00:40:42.546039 [debug] [Thread-1 (]: Began running node model.mage_case.stg_clientes
[0m00:40:42.546888 [debug] [Thread-2 (]: Began running node model.mage_case.stg_itens_vendas
[0m00:40:42.547406 [debug] [Thread-3 (]: Began running node model.mage_case.stg_produtos
[0m00:40:42.547931 [debug] [Thread-4 (]: Began running node model.mage_case.stg_vendas
[0m00:40:42.548767 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_clientes ................................ [RUN]
[0m00:40:42.550852 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_itens_vendas ............................ [RUN]
[0m00:40:42.553004 [info ] [Thread-3 (]: 3 of 4 START sql view model public.stg_produtos ................................ [RUN]
[0m00:40:42.555673 [info ] [Thread-4 (]: 4 of 4 START sql view model public.stg_vendas .................................. [RUN]
[0m00:40:42.558393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now model.mage_case.stg_clientes)
[0m00:40:42.560514 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.mage_case.stg_itens_vendas'
[0m00:40:42.562426 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.mage_case.stg_produtos'
[0m00:40:42.564919 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.mage_case.stg_vendas'
[0m00:40:42.566739 [debug] [Thread-1 (]: Began compiling node model.mage_case.stg_clientes
[0m00:40:42.567899 [debug] [Thread-2 (]: Began compiling node model.mage_case.stg_itens_vendas
[0m00:40:42.568865 [debug] [Thread-3 (]: Began compiling node model.mage_case.stg_produtos
[0m00:40:42.569812 [debug] [Thread-4 (]: Began compiling node model.mage_case.stg_vendas
[0m00:40:42.580961 [debug] [Thread-1 (]: Writing injected SQL for node "model.mage_case.stg_clientes"
[0m00:40:42.586374 [debug] [Thread-2 (]: Writing injected SQL for node "model.mage_case.stg_itens_vendas"
[0m00:40:42.591152 [debug] [Thread-3 (]: Writing injected SQL for node "model.mage_case.stg_produtos"
[0m00:40:42.598170 [debug] [Thread-4 (]: Writing injected SQL for node "model.mage_case.stg_vendas"
[0m00:40:42.604478 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (compile): 00:40:42.570713 => 00:40:42.603989
[0m00:40:42.605486 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (compile): 00:40:42.588037 => 00:40:42.605021
[0m00:40:42.607314 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (compile): 00:40:42.582171 => 00:40:42.606884
[0m00:40:42.607875 [debug] [Thread-1 (]: Began executing node model.mage_case.stg_clientes
[0m00:40:42.608469 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (compile): 00:40:42.592481 => 00:40:42.608200
[0m00:40:42.609300 [debug] [Thread-3 (]: Began executing node model.mage_case.stg_produtos
[0m00:40:42.610295 [debug] [Thread-2 (]: Began executing node model.mage_case.stg_itens_vendas
[0m00:40:42.634562 [debug] [Thread-4 (]: Began executing node model.mage_case.stg_vendas
[0m00:40:42.649711 [debug] [Thread-1 (]: Writing runtime sql for node "model.mage_case.stg_clientes"
[0m00:40:42.656006 [debug] [Thread-3 (]: Writing runtime sql for node "model.mage_case.stg_produtos"
[0m00:40:42.661898 [debug] [Thread-2 (]: Writing runtime sql for node "model.mage_case.stg_itens_vendas"
[0m00:40:42.668150 [debug] [Thread-4 (]: Writing runtime sql for node "model.mage_case.stg_vendas"
[0m00:40:42.675410 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:40:42.676188 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:40:42.677270 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: BEGIN
[0m00:40:42.678034 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:40:42.678694 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:40:42.679437 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: BEGIN
[0m00:40:42.680367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:42.681350 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: BEGIN
[0m00:40:42.682442 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: BEGIN
[0m00:40:42.683442 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:40:42.685353 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:40:42.686311 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:40:42.693589 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:40:42.695795 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:40:42.696295 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:40:42.697628 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:40:42.698210 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:40:42.698702 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:40:42.699891 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */

  create view "dbt"."public"."stg_clientes__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT 
        *
    FROM
        "dbt"."public"."clientes"
)

SELECT
    id_cliente,
    nome,
    email,
    cidade,
    estado
FROM
    source
  );
[0m00:40:42.700833 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:40:42.701860 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:40:42.702779 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */

  create view "dbt"."public"."stg_itens_vendas__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT 
        *
    FROM
        "dbt"."public"."itens_vendas"
)

SELECT
    id_venda,
    id_produto,
    quantidade,
    preco_unitario
FROM
    source
  );
[0m00:40:42.704388 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */

  create view "dbt"."public"."stg_vendas__dbt_tmp"
    
    
  as (
    

select *
from vendas
  );
[0m00:40:42.706111 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */

  create view "dbt"."public"."stg_produtos__dbt_tmp"
    
    
  as (
    

select *
from produtos
  );
[0m00:40:42.706980 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:40:42.709908 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:40:42.715975 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:40:42.716515 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:40:42.719814 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:40:42.723975 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:40:42.728524 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:40:42.733219 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:40:42.734364 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */
alter table "dbt"."public"."stg_clientes" rename to "stg_clientes__dbt_backup"
[0m00:40:42.735805 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
alter table "dbt"."public"."stg_itens_vendas" rename to "stg_itens_vendas__dbt_backup"
[0m00:40:42.736923 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
alter table "dbt"."public"."stg_vendas" rename to "stg_vendas__dbt_backup"
[0m00:40:42.737981 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
alter table "dbt"."public"."stg_produtos" rename to "stg_produtos__dbt_backup"
[0m00:40:42.739415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:40:42.739891 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:40:42.741154 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:40:42.742157 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:40:42.746250 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:40:42.751511 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:40:42.756942 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:40:42.761449 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:40:42.762771 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */
alter table "dbt"."public"."stg_clientes__dbt_tmp" rename to "stg_clientes"
[0m00:40:42.763940 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
alter table "dbt"."public"."stg_itens_vendas__dbt_tmp" rename to "stg_itens_vendas"
[0m00:40:42.765101 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
alter table "dbt"."public"."stg_vendas__dbt_tmp" rename to "stg_vendas"
[0m00:40:42.766863 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
alter table "dbt"."public"."stg_produtos__dbt_tmp" rename to "stg_produtos"
[0m00:40:42.768818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:40:42.770713 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:40:42.771990 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:40:42.773278 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:40:42.792062 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: COMMIT
[0m00:40:42.794161 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: COMMIT
[0m00:40:42.797231 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: COMMIT
[0m00:40:42.800549 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: COMMIT
[0m00:40:42.802126 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:40:42.803627 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:40:42.804870 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:40:42.805760 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:40:42.806768 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: COMMIT
[0m00:40:42.807836 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: COMMIT
[0m00:40:42.808727 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: COMMIT
[0m00:40:42.809593 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: COMMIT
[0m00:40:42.811554 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:40:42.812059 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:40:42.813122 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m00:40:42.813691 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:40:42.821746 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."stg_clientes__dbt_backup"
[0m00:40:42.825382 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_itens_vendas__dbt_backup"
[0m00:40:42.829060 [debug] [Thread-4 (]: Applying DROP to: "dbt"."public"."stg_vendas__dbt_backup"
[0m00:40:42.832975 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_produtos__dbt_backup"
[0m00:40:42.839791 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:40:42.841579 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:40:42.843593 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:40:42.845319 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:40:42.846512 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */
drop view if exists "dbt"."public"."stg_clientes__dbt_backup" cascade
[0m00:40:42.847464 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
drop view if exists "dbt"."public"."stg_itens_vendas__dbt_backup" cascade
[0m00:40:42.848507 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
drop view if exists "dbt"."public"."stg_vendas__dbt_backup" cascade
[0m00:40:42.849342 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
drop view if exists "dbt"."public"."stg_produtos__dbt_backup" cascade
[0m00:40:42.851842 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:40:42.852437 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:40:42.852951 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:40:42.855278 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (execute): 00:40:42.611122 => 00:40:42.855038
[0m00:40:42.855759 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:40:42.857600 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (execute): 00:40:42.657365 => 00:40:42.857378
[0m00:40:42.859709 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (execute): 00:40:42.663180 => 00:40:42.859489
[0m00:40:42.860611 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: Close
[0m00:40:42.862615 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (execute): 00:40:42.650966 => 00:40:42.862334
[0m00:40:42.863527 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: Close
[0m00:40:42.864376 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: Close
[0m00:40:42.865795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f184fb2-3755-4adf-809a-7fdc45654391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f639cf4e350>]}
[0m00:40:42.866943 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: Close
[0m00:40:42.868884 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f184fb2-3755-4adf-809a-7fdc45654391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f637fb66ad0>]}
[0m00:40:42.870573 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f184fb2-3755-4adf-809a-7fdc45654391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f637fcb7550>]}
[0m00:40:42.871884 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.stg_clientes ........................... [[32mCREATE VIEW[0m in 0.31s]
[0m00:40:42.873672 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f184fb2-3755-4adf-809a-7fdc45654391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f637fd995a0>]}
[0m00:40:42.874959 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.stg_itens_vendas ....................... [[32mCREATE VIEW[0m in 0.31s]
[0m00:40:42.876476 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.stg_vendas ............................. [[32mCREATE VIEW[0m in 0.31s]
[0m00:40:42.877814 [debug] [Thread-1 (]: Finished running node model.mage_case.stg_clientes
[0m00:40:42.879085 [info ] [Thread-3 (]: 3 of 4 OK created sql view model public.stg_produtos ........................... [[32mCREATE VIEW[0m in 0.31s]
[0m00:40:42.880241 [debug] [Thread-2 (]: Finished running node model.mage_case.stg_itens_vendas
[0m00:40:42.881636 [debug] [Thread-4 (]: Finished running node model.mage_case.stg_vendas
[0m00:40:42.883739 [debug] [Thread-3 (]: Finished running node model.mage_case.stg_produtos
[0m00:40:42.887960 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:42.888963 [debug] [MainThread]: On master: BEGIN
[0m00:40:42.889897 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:40:42.900906 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:40:42.902249 [debug] [MainThread]: On master: COMMIT
[0m00:40:42.903221 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:42.904047 [debug] [MainThread]: On master: COMMIT
[0m00:40:42.905127 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:40:42.905929 [debug] [MainThread]: On master: Close
[0m00:40:42.907180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:40:42.908208 [debug] [MainThread]: Connection 'model.mage_case.stg_clientes' was properly closed.
[0m00:40:42.909079 [debug] [MainThread]: Connection 'model.mage_case.stg_itens_vendas' was properly closed.
[0m00:40:42.909827 [debug] [MainThread]: Connection 'model.mage_case.stg_produtos' was properly closed.
[0m00:40:42.910708 [debug] [MainThread]: Connection 'model.mage_case.stg_vendas' was properly closed.
[0m00:40:42.911717 [info ] [MainThread]: 
[0m00:40:42.912827 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m00:40:42.915200 [debug] [MainThread]: Command end result
[0m00:40:42.941328 [info ] [MainThread]: 
[0m00:40:42.943042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:40:42.944870 [info ] [MainThread]: 
[0m00:40:42.947417 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:40:42.951664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63a05a0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f637fd995a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f637fb66ad0>]}
[0m00:40:42.953561 [debug] [MainThread]: Flushing usage events
[0m00:40:49.433781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fb805cdcf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fb7f0f30d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fb80c507c0>]}


============================== 00:40:49.440828 | daf7c9b6-a6cf-4b5c-8130-1bac46b1e729 ==============================
[0m00:40:49.440828 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:40:49.442131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:40:49.658085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'daf7c9b6-a6cf-4b5c-8130-1bac46b1e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fb7f0f30d0>]}
[0m00:40:49.775279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'daf7c9b6-a6cf-4b5c-8130-1bac46b1e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fb7e9f4b80>]}
[0m00:40:49.777030 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:40:49.804358 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:40:50.550752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:40:50.551592 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:40:50.552692 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.data_mart
- models.mage_case.staging
[0m00:40:50.559406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'daf7c9b6-a6cf-4b5c-8130-1bac46b1e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fb7ce5da50>]}
[0m00:40:50.595017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'daf7c9b6-a6cf-4b5c-8130-1bac46b1e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fb7ce200a0>]}
[0m00:40:50.596551 [info ] [MainThread]: Found 4 models, 15 tests, 4 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m00:40:50.598078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daf7c9b6-a6cf-4b5c-8130-1bac46b1e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fb7ce20160>]}
[0m00:40:50.602921 [info ] [MainThread]: 
[0m00:40:50.605322 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:40:50.608930 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m00:40:50.625308 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:40:50.626862 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:40:50.628458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:40:50.641300 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:40:50.642833 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:40:50.644158 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:40:50.649227 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:40:50.651815 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:40:50.653114 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:40:50.660857 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:50.661992 [debug] [MainThread]: On master: BEGIN
[0m00:40:50.662999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:40:50.671509 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:40:50.672668 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:50.673668 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:40:50.678627 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m00:40:50.681264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daf7c9b6-a6cf-4b5c-8130-1bac46b1e729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fb7ce5e920>]}
[0m00:40:50.682224 [debug] [MainThread]: On master: ROLLBACK
[0m00:40:50.683424 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:50.684180 [debug] [MainThread]: On master: BEGIN
[0m00:40:50.685295 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:40:50.686102 [debug] [MainThread]: On master: COMMIT
[0m00:40:50.686962 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:50.687685 [debug] [MainThread]: On master: COMMIT
[0m00:40:50.688587 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:40:50.689315 [debug] [MainThread]: On master: Close
[0m00:40:50.690741 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:40:50.691863 [info ] [MainThread]: 
[0m00:40:50.700707 [debug] [Thread-1 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:40:50.701346 [debug] [Thread-2 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0.a5f7aa486c
[0m00:40:50.701892 [debug] [Thread-3 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0.0daf58cd83
[0m00:40:50.702408 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:40:50.703322 [info ] [Thread-1 (]: 1 of 15 START test dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2  [RUN]
[0m00:40:50.705013 [info ] [Thread-2 (]: 2 of 15 START test dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0  [RUN]
[0m00:40:50.707027 [info ] [Thread-3 (]: 3 of 15 START test dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0  [RUN]
[0m00:40:50.708741 [info ] [Thread-4 (]: 4 of 15 START test not_null_stg_clientes_cidade ................................ [RUN]
[0m00:40:50.711500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23)
[0m00:40:50.714182 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0.a5f7aa486c'
[0m00:40:50.717093 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0.0daf58cd83'
[0m00:40:50.719436 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73'
[0m00:40:50.720901 [debug] [Thread-1 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:40:50.722349 [debug] [Thread-2 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0.a5f7aa486c
[0m00:40:50.724060 [debug] [Thread-3 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0.0daf58cd83
[0m00:40:50.725200 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:40:50.761155 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:40:50.762825 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0.a5f7aa486c"
[0m00:40:50.769449 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0.0daf58cd83"
[0m00:40:50.777743 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:40:50.784789 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23 (compile): 00:40:50.726047 => 00:40:50.784185
[0m00:40:50.785521 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (compile): 00:40:50.770599 => 00:40:50.785170
[0m00:40:50.786434 [debug] [Thread-1 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:40:50.787578 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:40:50.788270 [debug] [Thread-2 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0.a5f7aa486c (compile): 00:40:50.747717 => 00:40:50.787945
[0m00:40:50.794900 [debug] [Thread-3 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0.0daf58cd83 (compile): 00:40:50.764092 => 00:40:50.794375
[0m00:40:50.806340 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:40:50.809644 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:40:50.811274 [debug] [Thread-2 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0.a5f7aa486c
[0m00:40:50.812486 [debug] [Thread-3 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0.0daf58cd83
[0m00:40:50.818239 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0.a5f7aa486c"
[0m00:40:50.821420 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0.0daf58cd83"
[0m00:40:50.823155 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:40:50.823876 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:40:50.825555 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: BEGIN
[0m00:40:50.826525 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: BEGIN
[0m00:40:50.827627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:50.828559 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:40:50.830470 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0.a5f7aa486c"
[0m00:40:50.833057 [debug] [Thread-2 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0.a5f7aa486c: BEGIN
[0m00:40:50.834612 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0.0daf58cd83"
[0m00:40:50.835348 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:40:50.836788 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0.0daf58cd83: BEGIN
[0m00:40:50.839135 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:40:50.841658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:40:50.843213 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:40:50.844770 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_clientes"

where not(estado  IS NOT NULL AND char_length(estado) = 2)


      
    ) dbt_internal_test
[0m00:40:50.845402 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:40:50.847654 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:40:50.848927 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:40:50.849909 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:40:50.852557 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23 (execute): 00:40:50.789120 => 00:40:50.852220
[0m00:40:50.853063 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:40:50.854233 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cidade
from "dbt"."public"."stg_clientes"
where cidade is null



      
    ) dbt_internal_test
[0m00:40:50.855662 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0.a5f7aa486c"
[0m00:40:50.856836 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: ROLLBACK
[0m00:40:50.857935 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0.0daf58cd83"
[0m00:40:50.859408 [debug] [Thread-2 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0.a5f7aa486c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0.a5f7aa486c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_itens_vendas"

where not(preco_unitario preco_unitario >= 0)


      
    ) dbt_internal_test
[0m00:40:50.859878 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:40:50.860798 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: Close
[0m00:40:50.861586 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0.0daf58cd83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0.0daf58cd83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_itens_vendas"

where not(quantidade quantidade > 0)


      
    ) dbt_internal_test
[0m00:40:50.863000 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "preco_unitario"
LINE 15: where not(preco_unitario preco_unitario >= 0)
                                  ^

[0m00:40:50.864739 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (execute): 00:40:50.807061 => 00:40:50.864480
[0m00:40:50.866159 [info ] [Thread-1 (]: 1 of 15 PASS dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2  [[32mPASS[0m in 0.16s]
[0m00:40:50.867604 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "quantidade"
LINE 15: where not(quantidade quantidade > 0)
                              ^

[0m00:40:50.868496 [debug] [Thread-2 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0.a5f7aa486c: ROLLBACK
[0m00:40:50.869497 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: ROLLBACK
[0m00:40:50.870755 [debug] [Thread-1 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:40:50.871779 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0.0daf58cd83: ROLLBACK
[0m00:40:50.873168 [debug] [Thread-2 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0.a5f7aa486c (execute): 00:40:50.814754 => 00:40:50.872880
[0m00:40:50.874058 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: Close
[0m00:40:50.874990 [debug] [Thread-1 (]: Began running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:40:50.876331 [debug] [Thread-3 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0.0daf58cd83 (execute): 00:40:50.819161 => 00:40:50.876056
[0m00:40:50.876942 [debug] [Thread-2 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0.a5f7aa486c: Close
[0m00:40:50.878416 [info ] [Thread-4 (]: 4 of 15 PASS not_null_stg_clientes_cidade ...................................... [[32mPASS[0m in 0.16s]
[0m00:40:50.879339 [info ] [Thread-1 (]: 5 of 15 START test not_null_stg_clientes_email ................................. [RUN]
[0m00:40:50.880789 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0.0daf58cd83: Close
[0m00:40:50.884134 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:40:50.886324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23, now test.mage_case.not_null_stg_clientes_email.d1824e153a)
[0m00:40:50.889386 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0 (models/stagking/stg_itens_vendas.yml)
  syntax error at or near "preco_unitario"
  LINE 15: where not(preco_unitario preco_unitario >= 0)
                                    ^
  compiled Code at target/run/mage_case/models/stagking/stg_itens_vendas.yml/dbt_utils_expression_is_true_s_d65b6bf87b989703aab8d9a4ef5b3de4.sql
[0m00:40:50.891516 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0 (models/stagking/stg_itens_vendas.yml)
  syntax error at or near "quantidade"
  LINE 15: where not(quantidade quantidade > 0)
                                ^
  compiled Code at target/run/mage_case/models/stagking/stg_itens_vendas.yml/dbt_utils_expression_is_true_s_fd85d5c8aedb1f4b054f07e84a450d86.sql
[0m00:40:50.892863 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:40:50.894712 [debug] [Thread-1 (]: Began compiling node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:40:50.897236 [error] [Thread-2 (]: 2 of 15 ERROR dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0  [[31mERROR[0m in 0.18s]
[0m00:40:50.899380 [error] [Thread-3 (]: 3 of 15 ERROR dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0  [[31mERROR[0m in 0.18s]
[0m00:40:50.901036 [info ] [Thread-4 (]: 6 of 15 START test not_null_stg_clientes_estado ................................ [RUN]
[0m00:40:50.908333 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:40:50.909672 [debug] [Thread-2 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0.a5f7aa486c
[0m00:40:50.911449 [debug] [Thread-3 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0.0daf58cd83
[0m00:40:50.913114 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73, now test.mage_case.not_null_stg_clientes_estado.33c8769c0b)
[0m00:40:50.915040 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:40:50.916197 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:40:50.917352 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:40:50.918421 [info ] [Thread-2 (]: 7 of 15 START test not_null_stg_clientes_id_cliente ............................ [RUN]
[0m00:40:50.920181 [info ] [Thread-3 (]: 8 of 15 START test not_null_stg_clientes_nome .................................. [RUN]
[0m00:40:50.931052 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:40:50.932119 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (compile): 00:40:50.902143 => 00:40:50.931621
[0m00:40:50.933280 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0.a5f7aa486c, now test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2)
[0m00:40:50.935313 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0.0daf58cd83, now test.mage_case.not_null_stg_clientes_nome.04166b95e6)
[0m00:40:50.937609 [debug] [Thread-1 (]: Began executing node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:40:50.939180 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:40:50.940986 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:40:50.945653 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:40:50.955641 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:40:50.956401 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (compile): 00:40:50.921425 => 00:40:50.956012
[0m00:40:50.966282 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:40:50.969936 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:40:51.025655 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:40:51.028358 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (compile): 00:40:50.948454 => 00:40:51.027696
[0m00:40:51.029790 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (compile): 00:40:50.957445 => 00:40:51.029367
[0m00:40:51.030502 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:40:51.032206 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:40:51.033642 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:40:51.035088 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: BEGIN
[0m00:40:51.039677 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:40:51.040384 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:40:51.044057 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:40:51.045399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:51.047411 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: BEGIN
[0m00:40:51.050159 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:51.052815 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:40:51.054738 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: BEGIN
[0m00:40:51.055501 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:40:51.056458 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:51.057444 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: BEGIN
[0m00:40:51.059720 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:51.060313 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:40:51.062091 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:40:51.062908 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:40:51.064293 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:40:51.065602 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_email.d1824e153a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from "dbt"."public"."stg_clientes"
where email is null



      
    ) dbt_internal_test
[0m00:40:51.066800 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select estado
from "dbt"."public"."stg_clientes"
where estado is null



      
    ) dbt_internal_test
[0m00:40:51.068054 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:40:51.069682 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:40:51.071107 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:40:51.072499 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:40:51.073075 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:40:51.075368 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (execute): 00:40:50.942000 => 00:40:51.075064
[0m00:40:51.076616 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:40:51.077838 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_cliente
from "dbt"."public"."stg_clientes"
where id_cliente is null



      
    ) dbt_internal_test
[0m00:40:51.080197 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (execute): 00:40:50.972005 => 00:40:51.079886
[0m00:40:51.081525 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: ROLLBACK
[0m00:40:51.082737 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_nome.04166b95e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome
from "dbt"."public"."stg_clientes"
where nome is null



      
    ) dbt_internal_test
[0m00:40:51.084422 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: ROLLBACK
[0m00:40:51.085118 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:40:51.086427 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: Close
[0m00:40:51.088487 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: Close
[0m00:40:51.089063 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:40:51.091609 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (execute): 00:40:51.036228 => 00:40:51.091199
[0m00:40:51.093582 [info ] [Thread-1 (]: 5 of 15 PASS not_null_stg_clientes_email ....................................... [[32mPASS[0m in 0.21s]
[0m00:40:51.095766 [info ] [Thread-4 (]: 6 of 15 PASS not_null_stg_clientes_estado ...................................... [[32mPASS[0m in 0.18s]
[0m00:40:51.098896 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (execute): 00:40:51.041174 => 00:40:51.098436
[0m00:40:51.100429 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: ROLLBACK
[0m00:40:51.102527 [debug] [Thread-1 (]: Finished running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:40:51.104448 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:40:51.105903 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: ROLLBACK
[0m00:40:51.107599 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: Close
[0m00:40:51.108712 [debug] [Thread-1 (]: Began running node test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750
[0m00:40:51.110184 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9
[0m00:40:51.111820 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: Close
[0m00:40:51.113371 [info ] [Thread-2 (]: 7 of 15 PASS not_null_stg_clientes_id_cliente .................................. [[32mPASS[0m in 0.18s]
[0m00:40:51.114798 [info ] [Thread-1 (]: 9 of 15 START test not_null_stg_itens_vendas_id_produto ........................ [RUN]
[0m00:40:51.117133 [info ] [Thread-4 (]: 10 of 15 START test not_null_stg_itens_vendas_id_venda ......................... [RUN]
[0m00:40:51.119868 [info ] [Thread-3 (]: 8 of 15 PASS not_null_stg_clientes_nome ........................................ [[32mPASS[0m in 0.19s]
[0m00:40:51.122079 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:40:51.124595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_email.d1824e153a, now test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750)
[0m00:40:51.128320 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_estado.33c8769c0b, now test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9)
[0m00:40:51.132321 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:40:51.135721 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014
[0m00:40:51.138119 [debug] [Thread-1 (]: Began compiling node test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750
[0m00:40:51.140533 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9
[0m00:40:51.142979 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8
[0m00:40:51.145040 [info ] [Thread-2 (]: 11 of 15 START test not_null_stg_itens_vendas_preco_unitario ................... [RUN]
[0m00:40:51.156027 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"
[0m00:40:51.167289 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"
[0m00:40:51.169146 [info ] [Thread-3 (]: 12 of 15 START test not_null_stg_itens_vendas_quantidade ....................... [RUN]
[0m00:40:51.172319 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2, now test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014)
[0m00:40:51.179303 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_nome.04166b95e6, now test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8)
[0m00:40:51.181956 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014
[0m00:40:51.184005 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8
[0m00:40:51.197556 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"
[0m00:40:51.205506 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"
[0m00:40:51.206617 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9 (compile): 00:40:51.157391 => 00:40:51.206091
[0m00:40:51.208387 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750 (compile): 00:40:51.147207 => 00:40:51.207795
[0m00:40:51.210840 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9
[0m00:40:51.213014 [debug] [Thread-1 (]: Began executing node test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750
[0m00:40:51.214341 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014 (compile): 00:40:51.185590 => 00:40:51.213674
[0m00:40:51.219193 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"
[0m00:40:51.225350 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"
[0m00:40:51.226210 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8 (compile): 00:40:51.198874 => 00:40:51.225850
[0m00:40:51.227568 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014
[0m00:40:51.231101 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8
[0m00:40:51.236709 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"
[0m00:40:51.243229 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"
[0m00:40:51.244253 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"
[0m00:40:51.245001 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"
[0m00:40:51.248498 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9: BEGIN
[0m00:40:51.252312 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750: BEGIN
[0m00:40:51.255073 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:51.258236 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"
[0m00:40:51.259173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:51.262421 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014: BEGIN
[0m00:40:51.263477 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"
[0m00:40:51.269186 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:51.273441 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8: BEGIN
[0m00:40:51.276702 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:40:51.277442 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:40:51.280406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:40:51.281396 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"
[0m00:40:51.284116 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"
[0m00:40:51.285882 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_venda
from "dbt"."public"."stg_itens_vendas"
where id_venda is null



      
    ) dbt_internal_test
[0m00:40:51.287105 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:40:51.287960 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_produto
from "dbt"."public"."stg_itens_vendas"
where id_produto is null



      
    ) dbt_internal_test
[0m00:40:51.290094 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:40:51.291240 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"
[0m00:40:51.293970 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:40:51.294622 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:40:51.296708 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9 (execute): 00:40:51.215899 => 00:40:51.296400
[0m00:40:51.297810 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select preco_unitario
from "dbt"."public"."stg_itens_vendas"
where preco_unitario is null



      
    ) dbt_internal_test
[0m00:40:51.300571 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750 (execute): 00:40:51.220824 => 00:40:51.300207
[0m00:40:51.301746 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"
[0m00:40:51.302749 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9: ROLLBACK
[0m00:40:51.304378 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750: ROLLBACK
[0m00:40:51.304904 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:40:51.305996 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quantidade
from "dbt"."public"."stg_itens_vendas"
where quantidade is null



      
    ) dbt_internal_test
[0m00:40:51.307675 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9: Close
[0m00:40:51.308717 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750: Close
[0m00:40:51.310889 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014 (execute): 00:40:51.232206 => 00:40:51.310531
[0m00:40:51.315504 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:40:51.313906 [info ] [Thread-4 (]: 10 of 15 PASS not_null_stg_itens_vendas_id_venda ............................... [[32mPASS[0m in 0.19s]
[0m00:40:51.318339 [info ] [Thread-1 (]: 9 of 15 PASS not_null_stg_itens_vendas_id_produto .............................. [[32mPASS[0m in 0.19s]
[0m00:40:51.321870 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014: ROLLBACK
[0m00:40:51.324576 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8 (execute): 00:40:51.238730 => 00:40:51.324209
[0m00:40:51.325969 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9
[0m00:40:51.327737 [debug] [Thread-1 (]: Finished running node test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750
[0m00:40:51.329252 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014: Close
[0m00:40:51.330130 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8: ROLLBACK
[0m00:40:51.331325 [debug] [Thread-4 (]: Began running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:40:51.332513 [debug] [Thread-1 (]: Began running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:40:51.334770 [info ] [Thread-2 (]: 11 of 15 PASS not_null_stg_itens_vendas_preco_unitario ......................... [[32mPASS[0m in 0.16s]
[0m00:40:51.336707 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8: Close
[0m00:40:51.338025 [info ] [Thread-4 (]: 13 of 15 START test unique_stg_clientes_email .................................. [RUN]
[0m00:40:51.339331 [info ] [Thread-1 (]: 14 of 15 START test unique_stg_clientes_id_cliente ............................. [RUN]
[0m00:40:51.342209 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014
[0m00:40:51.346360 [info ] [Thread-3 (]: 12 of 15 PASS not_null_stg_itens_vendas_quantidade ............................. [[32mPASS[0m in 0.17s]
[0m00:40:51.349145 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9, now test.mage_case.unique_stg_clientes_email.2b7c7e0aff)
[0m00:40:51.351187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750, now test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3)
[0m00:40:51.352904 [debug] [Thread-2 (]: Began running node test.mage_case.unique_stg_itens_vendas_id_venda.29241ef415
[0m00:40:51.355228 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8
[0m00:40:51.357313 [debug] [Thread-4 (]: Began compiling node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:40:51.358511 [debug] [Thread-1 (]: Began compiling node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:40:51.360076 [info ] [Thread-2 (]: 15 of 15 START test unique_stg_itens_vendas_id_venda ........................... [RUN]
[0m00:40:51.377554 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:40:51.386680 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:40:51.388179 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014, now test.mage_case.unique_stg_itens_vendas_id_venda.29241ef415)
[0m00:40:51.393226 [debug] [Thread-2 (]: Began compiling node test.mage_case.unique_stg_itens_vendas_id_venda.29241ef415
[0m00:40:51.405097 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.unique_stg_itens_vendas_id_venda.29241ef415"
[0m00:40:51.407369 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (compile): 00:40:51.364647 => 00:40:51.406877
[0m00:40:51.408142 [debug] [Thread-1 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (compile): 00:40:51.378326 => 00:40:51.407736
[0m00:40:51.409230 [debug] [Thread-4 (]: Began executing node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:40:51.410953 [debug] [Thread-1 (]: Began executing node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:40:51.415593 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:40:51.420418 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:40:51.421266 [debug] [Thread-2 (]: Timing info for test.mage_case.unique_stg_itens_vendas_id_venda.29241ef415 (compile): 00:40:51.394629 => 00:40:51.420932
[0m00:40:51.424435 [debug] [Thread-2 (]: Began executing node test.mage_case.unique_stg_itens_vendas_id_venda.29241ef415
[0m00:40:51.431149 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.unique_stg_itens_vendas_id_venda.29241ef415"
[0m00:40:51.433469 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:40:51.434732 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:40:51.435836 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: BEGIN
[0m00:40:51.436929 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: BEGIN
[0m00:40:51.438158 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:40:51.439553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:40:51.441800 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.unique_stg_itens_vendas_id_venda.29241ef415"
[0m00:40:51.445260 [debug] [Thread-2 (]: On test.mage_case.unique_stg_itens_vendas_id_venda.29241ef415: BEGIN
[0m00:40:51.446896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:40:51.452731 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:40:51.455685 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:40:51.456478 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:40:51.457956 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:40:51.459586 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where email is not null
group by email
having count(*) > 1



      
    ) dbt_internal_test
[0m00:40:51.461067 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:40:51.461640 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_cliente as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where id_cliente is not null
group by id_cliente
having count(*) > 1



      
    ) dbt_internal_test
[0m00:40:51.464330 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:40:51.465410 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.unique_stg_itens_vendas_id_venda.29241ef415"
[0m00:40:51.468336 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:40:51.471039 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (execute): 00:40:51.412168 => 00:40:51.470691
[0m00:40:51.472470 [debug] [Thread-2 (]: On test.mage_case.unique_stg_itens_vendas_id_venda.29241ef415: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_itens_vendas_id_venda.29241ef415"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_venda as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_itens_vendas"
where id_venda is not null
group by id_venda
having count(*) > 1



      
    ) dbt_internal_test
[0m00:40:51.475522 [debug] [Thread-1 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (execute): 00:40:51.417076 => 00:40:51.474826
[0m00:40:51.476971 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: ROLLBACK
[0m00:40:51.478880 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: ROLLBACK
[0m00:40:51.479935 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:40:51.482476 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: Close
[0m00:40:51.483890 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: Close
[0m00:40:51.486146 [debug] [Thread-2 (]: Timing info for test.mage_case.unique_stg_itens_vendas_id_venda.29241ef415 (execute): 00:40:51.425695 => 00:40:51.485779
[0m00:40:51.490105 [info ] [Thread-4 (]: 13 of 15 PASS unique_stg_clientes_email ........................................ [[32mPASS[0m in 0.14s]
[0m00:40:51.492845 [info ] [Thread-1 (]: 14 of 15 PASS unique_stg_clientes_id_cliente ................................... [[32mPASS[0m in 0.14s]
[0m00:40:51.497133 [debug] [Thread-2 (]: On test.mage_case.unique_stg_itens_vendas_id_venda.29241ef415: ROLLBACK
[0m00:40:51.499045 [debug] [Thread-4 (]: Finished running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:40:51.500827 [debug] [Thread-1 (]: Finished running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:40:51.502862 [debug] [Thread-2 (]: On test.mage_case.unique_stg_itens_vendas_id_venda.29241ef415: Close
[0m00:40:51.506447 [error] [Thread-2 (]: 15 of 15 FAIL 4 unique_stg_itens_vendas_id_venda ............................... [[31mFAIL 4[0m in 0.12s]
[0m00:40:51.509531 [debug] [Thread-2 (]: Finished running node test.mage_case.unique_stg_itens_vendas_id_venda.29241ef415
[0m00:40:51.515230 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:51.516614 [debug] [MainThread]: On master: BEGIN
[0m00:40:51.518264 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:40:51.530630 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:40:51.532036 [debug] [MainThread]: On master: COMMIT
[0m00:40:51.533321 [debug] [MainThread]: Using postgres connection "master"
[0m00:40:51.534421 [debug] [MainThread]: On master: COMMIT
[0m00:40:51.536136 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:40:51.537211 [debug] [MainThread]: On master: Close
[0m00:40:51.538648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:40:51.539850 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3' was properly closed.
[0m00:40:51.541031 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_itens_vendas_id_venda.29241ef415' was properly closed.
[0m00:40:51.542163 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8' was properly closed.
[0m00:40:51.543432 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_email.2b7c7e0aff' was properly closed.
[0m00:40:51.544708 [info ] [MainThread]: 
[0m00:40:51.546436 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m00:40:51.551848 [debug] [MainThread]: Command end result
[0m00:40:51.586235 [info ] [MainThread]: 
[0m00:40:51.587977 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m00:40:51.589916 [info ] [MainThread]: 
[0m00:40:51.594788 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario__preco_unitario_0 (models/stagking/stg_itens_vendas.yml)
  syntax error at or near "preco_unitario"
  LINE 15: where not(preco_unitario preco_unitario >= 0)
                                    ^
  compiled Code at target/run/mage_case/models/stagking/stg_itens_vendas.yml/dbt_utils_expression_is_true_s_d65b6bf87b989703aab8d9a4ef5b3de4.sql
[0m00:40:51.597351 [info ] [MainThread]: 
[0m00:40:51.600416 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_itens_vendas_quantidade__quantidade_0 (models/stagking/stg_itens_vendas.yml)
  syntax error at or near "quantidade"
  LINE 15: where not(quantidade quantidade > 0)
                                ^
  compiled Code at target/run/mage_case/models/stagking/stg_itens_vendas.yml/dbt_utils_expression_is_true_s_fd85d5c8aedb1f4b054f07e84a450d86.sql
[0m00:40:51.602445 [info ] [MainThread]: 
[0m00:40:51.604689 [error] [MainThread]: [31mFailure in test unique_stg_itens_vendas_id_venda (models/stagking/stg_itens_vendas.yml)[0m
[0m00:40:51.607121 [error] [MainThread]:   Got 4 results, configured to fail if != 0
[0m00:40:51.609035 [info ] [MainThread]: 
[0m00:40:51.610829 [info ] [MainThread]:   compiled Code at target/compiled/mage_case/models/stagking/stg_itens_vendas.yml/unique_stg_itens_vendas_id_venda.sql
[0m00:40:51.613351 [info ] [MainThread]: 
[0m00:40:51.617262 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=3 SKIP=0 TOTAL=15
[0m00:40:51.620449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fb805cdcf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fb7d2ae470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fb7d2ad630>]}
[0m00:40:51.622823 [debug] [MainThread]: Flushing usage events
[0m00:42:03.448249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771967a17310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77196821ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77196809a260>]}


============================== 00:42:03.454540 | 3d05d19f-5c1d-4ecd-b554-bbc4ad4b3eb6 ==============================
[0m00:42:03.454540 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:42:03.455923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:42:03.735294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d05d19f-5c1d-4ecd-b554-bbc4ad4b3eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77196821ce50>]}
[0m00:42:03.842761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d05d19f-5c1d-4ecd-b554-bbc4ad4b3eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77196617bb80>]}
[0m00:42:03.844653 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:42:03.872711 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:42:04.673600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:42:04.674924 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/stg_itens_vendas.yml
[0m00:42:05.054363 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.data_mart
- models.mage_case.staging
[0m00:42:05.063788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d05d19f-5c1d-4ecd-b554-bbc4ad4b3eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7719643a0760>]}
[0m00:42:05.103034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d05d19f-5c1d-4ecd-b554-bbc4ad4b3eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7719645b63e0>]}
[0m00:42:05.104321 [info ] [MainThread]: Found 4 models, 14 tests, 4 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m00:42:05.105961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d05d19f-5c1d-4ecd-b554-bbc4ad4b3eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7719645b5090>]}
[0m00:42:05.110087 [info ] [MainThread]: 
[0m00:42:05.112278 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:42:05.115645 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m00:42:05.131951 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:42:05.133399 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:42:05.134755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:42:05.149085 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:42:05.150505 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:42:05.151680 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:42:05.157473 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:42:05.159964 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:42:05.161339 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:42:05.169114 [debug] [MainThread]: Using postgres connection "master"
[0m00:42:05.170735 [debug] [MainThread]: On master: BEGIN
[0m00:42:05.171883 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:42:05.182563 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:42:05.184114 [debug] [MainThread]: Using postgres connection "master"
[0m00:42:05.185241 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:42:05.191412 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m00:42:05.194386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d05d19f-5c1d-4ecd-b554-bbc4ad4b3eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771964274130>]}
[0m00:42:05.195557 [debug] [MainThread]: On master: ROLLBACK
[0m00:42:05.196655 [debug] [MainThread]: Using postgres connection "master"
[0m00:42:05.197544 [debug] [MainThread]: On master: BEGIN
[0m00:42:05.198743 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:42:05.199508 [debug] [MainThread]: On master: COMMIT
[0m00:42:05.200433 [debug] [MainThread]: Using postgres connection "master"
[0m00:42:05.201192 [debug] [MainThread]: On master: COMMIT
[0m00:42:05.202145 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:42:05.202892 [debug] [MainThread]: On master: Close
[0m00:42:05.204080 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:42:05.206627 [info ] [MainThread]: 
[0m00:42:05.215875 [debug] [Thread-1 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:42:05.216512 [debug] [Thread-2 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629
[0m00:42:05.217067 [debug] [Thread-3 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665
[0m00:42:05.217749 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:42:05.218586 [info ] [Thread-1 (]: 1 of 14 START test dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2  [RUN]
[0m00:42:05.220092 [info ] [Thread-2 (]: 2 of 14 START test dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0  [RUN]
[0m00:42:05.222596 [info ] [Thread-3 (]: 3 of 14 START test dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0  [RUN]
[0m00:42:05.224905 [info ] [Thread-4 (]: 4 of 14 START test not_null_stg_clientes_cidade ................................ [RUN]
[0m00:42:05.226740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23)
[0m00:42:05.228796 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629'
[0m00:42:05.231486 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665'
[0m00:42:05.233580 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73'
[0m00:42:05.234870 [debug] [Thread-1 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:42:05.236053 [debug] [Thread-2 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629
[0m00:42:05.237683 [debug] [Thread-3 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665
[0m00:42:05.239314 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:42:05.253350 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:42:05.261379 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629"
[0m00:42:05.268032 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665"
[0m00:42:05.279535 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:42:05.287241 [debug] [Thread-3 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665 (compile): 00:42:05.262579 => 00:42:05.286727
[0m00:42:05.288143 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23 (compile): 00:42:05.240216 => 00:42:05.287697
[0m00:42:05.289015 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (compile): 00:42:05.269186 => 00:42:05.288650
[0m00:42:05.290034 [debug] [Thread-3 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665
[0m00:42:05.291286 [debug] [Thread-2 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629 (compile): 00:42:05.254124 => 00:42:05.290829
[0m00:42:05.292176 [debug] [Thread-1 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:42:05.293669 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:42:05.313968 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665"
[0m00:42:05.314532 [debug] [Thread-2 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629
[0m00:42:05.318567 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:42:05.322873 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:42:05.327583 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629"
[0m00:42:05.332707 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:42:05.333539 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665"
[0m00:42:05.334049 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:42:05.335074 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: BEGIN
[0m00:42:05.336370 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629"
[0m00:42:05.336948 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665: BEGIN
[0m00:42:05.338017 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: BEGIN
[0m00:42:05.339105 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:42:05.340115 [debug] [Thread-2 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629: BEGIN
[0m00:42:05.341323 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:42:05.342591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:42:05.344464 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:42:05.353443 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:42:05.354487 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:42:05.355450 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cidade
from "dbt"."public"."stg_clientes"
where cidade is null



      
    ) dbt_internal_test
[0m00:42:05.355972 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:42:05.357371 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665"
[0m00:42:05.358061 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:42:05.359284 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:42:05.359817 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_itens_vendas"

where not(quantidade > 0)


      
    ) dbt_internal_test
[0m00:42:05.360256 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:42:05.363164 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (execute): 00:42:05.319829 => 00:42:05.362896
[0m00:42:05.364324 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:42:05.365841 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629"
[0m00:42:05.366416 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:42:05.367225 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: ROLLBACK
[0m00:42:05.368115 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_clientes"

where not(estado  IS NOT NULL AND char_length(estado) = 2)


      
    ) dbt_internal_test
[0m00:42:05.368965 [debug] [Thread-2 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_itens_vendas"

where not(preco_unitario >= 0)


      
    ) dbt_internal_test
[0m00:42:05.371100 [debug] [Thread-3 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665 (execute): 00:42:05.294925 => 00:42:05.370835
[0m00:42:05.372229 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: Close
[0m00:42:05.373889 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665: ROLLBACK
[0m00:42:05.374380 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:42:05.375848 [info ] [Thread-4 (]: 4 of 14 PASS not_null_stg_clientes_cidade ...................................... [[32mPASS[0m in 0.14s]
[0m00:42:05.376637 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:42:05.378107 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665: Close
[0m00:42:05.380136 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23 (execute): 00:42:05.315977 => 00:42:05.379785
[0m00:42:05.381410 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:42:05.383328 [debug] [Thread-2 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629 (execute): 00:42:05.325059 => 00:42:05.383058
[0m00:42:05.384740 [info ] [Thread-3 (]: 3 of 14 PASS dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0 ...... [[32mPASS[0m in 0.15s]
[0m00:42:05.385676 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: ROLLBACK
[0m00:42:05.387024 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:42:05.388067 [debug] [Thread-2 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629: ROLLBACK
[0m00:42:05.389486 [debug] [Thread-3 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665
[0m00:42:05.390930 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: Close
[0m00:42:05.391790 [info ] [Thread-4 (]: 5 of 14 START test not_null_stg_clientes_email ................................. [RUN]
[0m00:42:05.393498 [debug] [Thread-2 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629: Close
[0m00:42:05.395154 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:42:05.397990 [info ] [Thread-1 (]: 1 of 14 PASS dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2  [[32mPASS[0m in 0.17s]
[0m00:42:05.400337 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73, now test.mage_case.not_null_stg_clientes_email.d1824e153a)
[0m00:42:05.402968 [info ] [Thread-2 (]: 2 of 14 PASS dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0 .. [[32mPASS[0m in 0.17s]
[0m00:42:05.405592 [info ] [Thread-3 (]: 6 of 14 START test not_null_stg_clientes_estado ................................ [RUN]
[0m00:42:05.407646 [debug] [Thread-1 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:42:05.409252 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:42:05.411048 [debug] [Thread-2 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629
[0m00:42:05.413123 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665, now test.mage_case.not_null_stg_clientes_estado.33c8769c0b)
[0m00:42:05.414899 [debug] [Thread-1 (]: Began running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:42:05.422159 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:42:05.424019 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:42:05.425840 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:42:05.427841 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_clientes_id_cliente ............................ [RUN]
[0m00:42:05.430598 [info ] [Thread-2 (]: 8 of 14 START test not_null_stg_clientes_nome .................................. [RUN]
[0m00:42:05.439818 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:42:05.441329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23, now test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2)
[0m00:42:05.443548 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629, now test.mage_case.not_null_stg_clientes_nome.04166b95e6)
[0m00:42:05.446248 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (compile): 00:42:05.416069 => 00:42:05.445398
[0m00:42:05.448019 [debug] [Thread-1 (]: Began compiling node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:42:05.449400 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:42:05.451103 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:42:05.461453 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:42:05.462624 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (compile): 00:42:05.431930 => 00:42:05.462104
[0m00:42:05.469545 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:42:05.473861 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:42:05.476630 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:42:05.483828 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:42:05.486100 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (compile): 00:42:05.452497 => 00:42:05.485577
[0m00:42:05.486871 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (compile): 00:42:05.463823 => 00:42:05.486509
[0m00:42:05.488112 [debug] [Thread-1 (]: Began executing node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:42:05.489878 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:42:05.490876 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:42:05.495109 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:42:05.495796 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:42:05.499511 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:42:05.500767 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: BEGIN
[0m00:42:05.502509 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: BEGIN
[0m00:42:05.504215 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:42:05.505546 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:42:05.507351 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:42:05.508705 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:42:05.510146 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: BEGIN
[0m00:42:05.511442 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: BEGIN
[0m00:42:05.512539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:42:05.513614 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:42:05.516432 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:42:05.517808 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:42:05.518370 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:42:05.519305 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_email.d1824e153a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from "dbt"."public"."stg_clientes"
where email is null



      
    ) dbt_internal_test
[0m00:42:05.520241 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:42:05.522121 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select estado
from "dbt"."public"."stg_clientes"
where estado is null



      
    ) dbt_internal_test
[0m00:42:05.522657 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:42:05.523969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:42:05.524688 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:42:05.526412 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (execute): 00:42:05.470804 => 00:42:05.526138
[0m00:42:05.526849 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:42:05.527760 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:42:05.529700 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (execute): 00:42:05.479414 => 00:42:05.529451
[0m00:42:05.530589 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: ROLLBACK
[0m00:42:05.531426 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:42:05.532265 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_cliente
from "dbt"."public"."stg_clientes"
where id_cliente is null



      
    ) dbt_internal_test
[0m00:42:05.533067 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: ROLLBACK
[0m00:42:05.534176 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: Close
[0m00:42:05.534779 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_nome.04166b95e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome
from "dbt"."public"."stg_clientes"
where nome is null



      
    ) dbt_internal_test
[0m00:42:05.536355 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: Close
[0m00:42:05.536854 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:42:05.537888 [info ] [Thread-4 (]: 5 of 14 PASS not_null_stg_clientes_email ....................................... [[32mPASS[0m in 0.14s]
[0m00:42:05.541709 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:42:05.541062 [info ] [Thread-3 (]: 6 of 14 PASS not_null_stg_clientes_estado ...................................... [[32mPASS[0m in 0.13s]
[0m00:42:05.543915 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (execute): 00:42:05.491794 => 00:42:05.543622
[0m00:42:05.545099 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:42:05.547066 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (execute): 00:42:05.496560 => 00:42:05.546811
[0m00:42:05.548136 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:42:05.549024 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: ROLLBACK
[0m00:42:05.550272 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750
[0m00:42:05.551328 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: ROLLBACK
[0m00:42:05.552437 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9
[0m00:42:05.554131 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: Close
[0m00:42:05.555239 [info ] [Thread-4 (]: 9 of 14 START test not_null_stg_itens_vendas_id_produto ........................ [RUN]
[0m00:42:05.556803 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: Close
[0m00:42:05.558046 [info ] [Thread-3 (]: 10 of 14 START test not_null_stg_itens_vendas_id_venda ......................... [RUN]
[0m00:42:05.560260 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_clientes_id_cliente .................................. [[32mPASS[0m in 0.12s]
[0m00:42:05.562273 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_email.d1824e153a, now test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750)
[0m00:42:05.564668 [info ] [Thread-2 (]: 8 of 14 PASS not_null_stg_clientes_nome ........................................ [[32mPASS[0m in 0.12s]
[0m00:42:05.567535 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_estado.33c8769c0b, now test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9)
[0m00:42:05.569625 [debug] [Thread-1 (]: Finished running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:42:05.571120 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750
[0m00:42:05.573208 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:42:05.574456 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9
[0m00:42:05.576264 [debug] [Thread-1 (]: Began running node test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014
[0m00:42:05.585624 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"
[0m00:42:05.587036 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8
[0m00:42:05.594846 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"
[0m00:42:05.596389 [info ] [Thread-1 (]: 11 of 14 START test not_null_stg_itens_vendas_preco_unitario ................... [RUN]
[0m00:42:05.599464 [info ] [Thread-2 (]: 12 of 14 START test not_null_stg_itens_vendas_quantidade ....................... [RUN]
[0m00:42:05.602596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2, now test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014)
[0m00:42:05.604657 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_nome.04166b95e6, now test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8)
[0m00:42:05.606630 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750 (compile): 00:42:05.577562 => 00:42:05.606189
[0m00:42:05.607312 [debug] [Thread-1 (]: Began compiling node test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014
[0m00:42:05.607931 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9 (compile): 00:42:05.588166 => 00:42:05.607641
[0m00:42:05.608749 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8
[0m00:42:05.610427 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750
[0m00:42:05.618771 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"
[0m00:42:05.620201 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9
[0m00:42:05.627627 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"
[0m00:42:05.633467 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"
[0m00:42:05.639648 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"
[0m00:42:05.648362 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014 (compile): 00:42:05.611688 => 00:42:05.647525
[0m00:42:05.649436 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8 (compile): 00:42:05.621275 => 00:42:05.648908
[0m00:42:05.651299 [debug] [Thread-1 (]: Began executing node test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014
[0m00:42:05.652430 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"
[0m00:42:05.653816 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8
[0m00:42:05.654539 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"
[0m00:42:05.660124 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"
[0m00:42:05.661668 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9: BEGIN
[0m00:42:05.665964 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"
[0m00:42:05.667485 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750: BEGIN
[0m00:42:05.669702 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:42:05.671460 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:42:05.677376 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"
[0m00:42:05.678757 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"
[0m00:42:05.679833 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014: BEGIN
[0m00:42:05.681381 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8: BEGIN
[0m00:42:05.683000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:42:05.684494 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:42:05.685447 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:42:05.687080 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:42:05.689413 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"
[0m00:42:05.694697 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"
[0m00:42:05.696875 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_venda
from "dbt"."public"."stg_itens_vendas"
where id_venda is null



      
    ) dbt_internal_test
[0m00:42:05.700121 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:42:05.701730 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_produto
from "dbt"."public"."stg_itens_vendas"
where id_produto is null



      
    ) dbt_internal_test
[0m00:42:05.705484 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:42:05.706486 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"
[0m00:42:05.707623 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:42:05.713141 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9 (execute): 00:42:05.635983 => 00:42:05.712601
[0m00:42:05.714247 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:42:05.715794 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select preco_unitario
from "dbt"."public"."stg_itens_vendas"
where preco_unitario is null



      
    ) dbt_internal_test
[0m00:42:05.717563 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"
[0m00:42:05.719610 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9: ROLLBACK
[0m00:42:05.723039 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750 (execute): 00:42:05.629080 => 00:42:05.722485
[0m00:42:05.726035 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:42:05.727450 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quantidade
from "dbt"."public"."stg_itens_vendas"
where quantidade is null



      
    ) dbt_internal_test
[0m00:42:05.729931 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9: Close
[0m00:42:05.731489 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750: ROLLBACK
[0m00:42:05.735965 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014 (execute): 00:42:05.655810 => 00:42:05.735390
[0m00:42:05.741561 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:42:05.740485 [info ] [Thread-3 (]: 10 of 14 PASS not_null_stg_itens_vendas_id_venda ............................... [[32mPASS[0m in 0.17s]
[0m00:42:05.743484 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750: Close
[0m00:42:05.745106 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014: ROLLBACK
[0m00:42:05.748571 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8 (execute): 00:42:05.662947 => 00:42:05.747985
[0m00:42:05.750655 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9
[0m00:42:05.752787 [info ] [Thread-4 (]: 9 of 14 PASS not_null_stg_itens_vendas_id_produto .............................. [[32mPASS[0m in 0.19s]
[0m00:42:05.754559 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014: Close
[0m00:42:05.756877 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8: ROLLBACK
[0m00:42:05.759898 [debug] [Thread-3 (]: Began running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:42:05.762381 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750
[0m00:42:05.765063 [info ] [Thread-1 (]: 11 of 14 PASS not_null_stg_itens_vendas_preco_unitario ......................... [[32mPASS[0m in 0.16s]
[0m00:42:05.769409 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8: Close
[0m00:42:05.770879 [info ] [Thread-3 (]: 13 of 14 START test unique_stg_clientes_email .................................. [RUN]
[0m00:42:05.773901 [debug] [Thread-4 (]: Began running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:42:05.776927 [debug] [Thread-1 (]: Finished running node test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014
[0m00:42:05.780522 [info ] [Thread-2 (]: 12 of 14 PASS not_null_stg_itens_vendas_quantidade ............................. [[32mPASS[0m in 0.18s]
[0m00:42:05.784067 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9, now test.mage_case.unique_stg_clientes_email.2b7c7e0aff)
[0m00:42:05.786841 [info ] [Thread-4 (]: 14 of 14 START test unique_stg_clientes_id_cliente ............................. [RUN]
[0m00:42:05.790604 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8
[0m00:42:05.792508 [debug] [Thread-3 (]: Began compiling node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:42:05.795196 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750, now test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3)
[0m00:42:05.817935 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:42:05.819081 [debug] [Thread-4 (]: Began compiling node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:42:05.829887 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:42:05.835748 [debug] [Thread-3 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (compile): 00:42:05.798035 => 00:42:05.835316
[0m00:42:05.837223 [debug] [Thread-3 (]: Began executing node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:42:05.837973 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (compile): 00:42:05.823201 => 00:42:05.837651
[0m00:42:05.842665 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:42:05.844252 [debug] [Thread-4 (]: Began executing node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:42:05.849701 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:42:05.855087 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:42:05.856086 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:42:05.856818 [debug] [Thread-3 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: BEGIN
[0m00:42:05.857911 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: BEGIN
[0m00:42:05.858908 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:42:05.860034 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:42:05.869706 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:42:05.870663 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:42:05.871334 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:42:05.872288 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:42:05.873184 [debug] [Thread-3 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where email is not null
group by email
having count(*) > 1



      
    ) dbt_internal_test
[0m00:42:05.874080 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_cliente as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where id_cliente is not null
group by id_cliente
having count(*) > 1



      
    ) dbt_internal_test
[0m00:42:05.876040 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:42:05.876448 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:42:05.878433 [debug] [Thread-3 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (execute): 00:42:05.838708 => 00:42:05.878144
[0m00:42:05.880314 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (execute): 00:42:05.846212 => 00:42:05.880062
[0m00:42:05.881248 [debug] [Thread-3 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: ROLLBACK
[0m00:42:05.882308 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: ROLLBACK
[0m00:42:05.883384 [debug] [Thread-3 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: Close
[0m00:42:05.884126 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: Close
[0m00:42:05.885283 [info ] [Thread-3 (]: 13 of 14 PASS unique_stg_clientes_email ........................................ [[32mPASS[0m in 0.10s]
[0m00:42:05.887015 [info ] [Thread-4 (]: 14 of 14 PASS unique_stg_clientes_id_cliente ................................... [[32mPASS[0m in 0.09s]
[0m00:42:05.889548 [debug] [Thread-3 (]: Finished running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:42:05.890720 [debug] [Thread-4 (]: Finished running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:42:05.894288 [debug] [MainThread]: Using postgres connection "master"
[0m00:42:05.895168 [debug] [MainThread]: On master: BEGIN
[0m00:42:05.895974 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:42:05.907390 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:42:05.908765 [debug] [MainThread]: On master: COMMIT
[0m00:42:05.909950 [debug] [MainThread]: Using postgres connection "master"
[0m00:42:05.911083 [debug] [MainThread]: On master: COMMIT
[0m00:42:05.912640 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:42:05.914122 [debug] [MainThread]: On master: Close
[0m00:42:05.916011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:42:05.918422 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014' was properly closed.
[0m00:42:05.919378 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8' was properly closed.
[0m00:42:05.920168 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_email.2b7c7e0aff' was properly closed.
[0m00:42:05.920997 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3' was properly closed.
[0m00:42:05.922501 [info ] [MainThread]: 
[0m00:42:05.923993 [info ] [MainThread]: Finished running 14 tests in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m00:42:05.928118 [debug] [MainThread]: Command end result
[0m00:42:05.956087 [info ] [MainThread]: 
[0m00:42:05.959746 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:42:05.962144 [info ] [MainThread]: 
[0m00:42:05.964487 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m00:42:05.967751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771967a17310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77196429aef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7719645b63e0>]}
[0m00:42:05.969348 [debug] [MainThread]: Flushing usage events
[0m00:44:05.401179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f88ed3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f879f7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f89560760>]}


============================== 00:44:05.407374 | a3109fb4-04e1-4291-8af0-ea0cdca70fe2 ==============================
[0m00:44:05.407374 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:44:05.408445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:44:05.618905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3109fb4-04e1-4291-8af0-ea0cdca70fe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f879f7100>]}
[0m00:44:05.716367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3109fb4-04e1-4291-8af0-ea0cdca70fe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f859fcf10>]}
[0m00:44:05.718133 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:44:05.742737 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:44:06.544496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:44:06.545643 [debug] [MainThread]: Partial parsing: added file: mage_case://models/stagking/stg_produtos.yml
[0m00:44:06.546511 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/stg_produtos.sql
[0m00:44:06.930127 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.staging
- models.mage_case.data_mart
[0m00:44:06.938665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3109fb4-04e1-4291-8af0-ea0cdca70fe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f8572e9b0>]}
[0m00:44:06.983005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3109fb4-04e1-4291-8af0-ea0cdca70fe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f856ffeb0>]}
[0m00:44:06.984773 [info ] [MainThread]: Found 4 models, 20 tests, 4 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m00:44:06.986337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3109fb4-04e1-4291-8af0-ea0cdca70fe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f856fff70>]}
[0m00:44:06.990874 [info ] [MainThread]: 
[0m00:44:06.993058 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:44:06.996399 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:44:07.013055 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:44:07.014759 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:44:07.016000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:44:07.028939 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m00:44:07.032050 [debug] [ThreadPool]: On list_dbt: Close
[0m00:44:07.036305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_public)
[0m00:44:07.046502 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:44:07.048169 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:44:07.049342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:44:07.059489 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:44:07.061297 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:44:07.062939 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:44:07.066809 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:44:07.069107 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:44:07.070228 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:44:07.077826 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:07.079097 [debug] [MainThread]: On master: BEGIN
[0m00:44:07.080056 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:44:07.089747 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:44:07.090862 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:07.091770 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:44:07.097655 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m00:44:07.100577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3109fb4-04e1-4291-8af0-ea0cdca70fe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f8572c820>]}
[0m00:44:07.101750 [debug] [MainThread]: On master: ROLLBACK
[0m00:44:07.103218 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:07.104535 [debug] [MainThread]: On master: BEGIN
[0m00:44:07.106103 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:44:07.107035 [debug] [MainThread]: On master: COMMIT
[0m00:44:07.107745 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:07.108423 [debug] [MainThread]: On master: COMMIT
[0m00:44:07.109263 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:44:07.110021 [debug] [MainThread]: On master: Close
[0m00:44:07.111115 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:44:07.112149 [info ] [MainThread]: 
[0m00:44:07.121506 [debug] [Thread-1 (]: Began running node model.mage_case.stg_clientes
[0m00:44:07.122078 [debug] [Thread-2 (]: Began running node model.mage_case.stg_itens_vendas
[0m00:44:07.122550 [debug] [Thread-3 (]: Began running node model.mage_case.stg_produtos
[0m00:44:07.123047 [debug] [Thread-4 (]: Began running node model.mage_case.stg_vendas
[0m00:44:07.123819 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_clientes ................................ [RUN]
[0m00:44:07.124938 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_itens_vendas ............................ [RUN]
[0m00:44:07.126321 [info ] [Thread-3 (]: 3 of 4 START sql view model public.stg_produtos ................................ [RUN]
[0m00:44:07.127688 [info ] [Thread-4 (]: 4 of 4 START sql view model public.stg_vendas .................................. [RUN]
[0m00:44:07.129269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now model.mage_case.stg_clientes)
[0m00:44:07.131740 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.mage_case.stg_itens_vendas'
[0m00:44:07.134516 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.mage_case.stg_produtos'
[0m00:44:07.137186 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.mage_case.stg_vendas'
[0m00:44:07.138672 [debug] [Thread-1 (]: Began compiling node model.mage_case.stg_clientes
[0m00:44:07.139696 [debug] [Thread-2 (]: Began compiling node model.mage_case.stg_itens_vendas
[0m00:44:07.140585 [debug] [Thread-3 (]: Began compiling node model.mage_case.stg_produtos
[0m00:44:07.141599 [debug] [Thread-4 (]: Began compiling node model.mage_case.stg_vendas
[0m00:44:07.151333 [debug] [Thread-1 (]: Writing injected SQL for node "model.mage_case.stg_clientes"
[0m00:44:07.156833 [debug] [Thread-2 (]: Writing injected SQL for node "model.mage_case.stg_itens_vendas"
[0m00:44:07.163565 [debug] [Thread-3 (]: Writing injected SQL for node "model.mage_case.stg_produtos"
[0m00:44:07.167919 [debug] [Thread-4 (]: Writing injected SQL for node "model.mage_case.stg_vendas"
[0m00:44:07.174250 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (compile): 00:44:07.142500 => 00:44:07.173781
[0m00:44:07.175149 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (compile): 00:44:07.152361 => 00:44:07.174697
[0m00:44:07.176897 [debug] [Thread-1 (]: Began executing node model.mage_case.stg_clientes
[0m00:44:07.178315 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (compile): 00:44:07.158681 => 00:44:07.177661
[0m00:44:07.179098 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (compile): 00:44:07.164868 => 00:44:07.178769
[0m00:44:07.180432 [debug] [Thread-2 (]: Began executing node model.mage_case.stg_itens_vendas
[0m00:44:07.203699 [debug] [Thread-3 (]: Began executing node model.mage_case.stg_produtos
[0m00:44:07.222196 [debug] [Thread-1 (]: Writing runtime sql for node "model.mage_case.stg_clientes"
[0m00:44:07.223250 [debug] [Thread-4 (]: Began executing node model.mage_case.stg_vendas
[0m00:44:07.229620 [debug] [Thread-2 (]: Writing runtime sql for node "model.mage_case.stg_itens_vendas"
[0m00:44:07.235706 [debug] [Thread-3 (]: Writing runtime sql for node "model.mage_case.stg_produtos"
[0m00:44:07.244431 [debug] [Thread-4 (]: Writing runtime sql for node "model.mage_case.stg_vendas"
[0m00:44:07.249175 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:44:07.250557 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:44:07.251288 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: BEGIN
[0m00:44:07.251921 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:44:07.252512 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:44:07.253317 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: BEGIN
[0m00:44:07.254299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:07.255181 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: BEGIN
[0m00:44:07.256176 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: BEGIN
[0m00:44:07.257127 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:44:07.258905 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:44:07.260005 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:44:07.267484 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:07.269065 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:44:07.270445 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */

  create view "dbt"."public"."stg_clientes__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT 
        *
    FROM
        "dbt"."public"."clientes"
)

SELECT
    id_cliente,
    nome,
    email,
    cidade,
    estado
FROM
    source
  );
[0m00:44:07.271287 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:07.271843 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:07.272279 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:07.273698 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:44:07.274628 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:44:07.275454 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:44:07.275898 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:44:07.276773 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */

  create view "dbt"."public"."stg_itens_vendas__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT 
        *
    FROM
        "dbt"."public"."itens_vendas"
)

SELECT
    id_venda,
    id_produto,
    quantidade,
    preco_unitario
FROM
    source
  );
[0m00:44:07.277675 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */

  create view "dbt"."public"."stg_vendas__dbt_tmp"
    
    
  as (
    

select *
from vendas
  );
[0m00:44:07.285468 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:44:07.286530 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */

  create view "dbt"."public"."stg_produtos__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT 
        *
    FROM
        "dbt"."public"."produtos"
)

SELECT
    id_produto,
    nome_produto,
    categoria,
    preco
FROM
    source
  );
[0m00:44:07.289013 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */
alter table "dbt"."public"."stg_clientes" rename to "stg_clientes__dbt_backup"
[0m00:44:07.289603 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:44:07.290028 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:44:07.291829 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:44:07.296087 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:44:07.296590 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:44:07.300875 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:44:07.304878 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:44:07.306168 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
alter table "dbt"."public"."stg_itens_vendas" rename to "stg_itens_vendas__dbt_backup"
[0m00:44:07.310670 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:44:07.311847 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
alter table "dbt"."public"."stg_vendas" rename to "stg_vendas__dbt_backup"
[0m00:44:07.313163 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */
alter table "dbt"."public"."stg_clientes__dbt_tmp" rename to "stg_clientes"
[0m00:44:07.315175 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:44:07.315675 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
alter table "dbt"."public"."stg_produtos" rename to "stg_produtos__dbt_backup"
[0m00:44:07.317364 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:44:07.318758 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:44:07.323068 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:44:07.324995 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:44:07.328675 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:44:07.347272 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: COMMIT
[0m00:44:07.347851 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
alter table "dbt"."public"."stg_itens_vendas__dbt_tmp" rename to "stg_itens_vendas"
[0m00:44:07.352793 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:44:07.354171 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
alter table "dbt"."public"."stg_vendas__dbt_tmp" rename to "stg_vendas"
[0m00:44:07.355550 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:44:07.357541 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:44:07.358007 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
alter table "dbt"."public"."stg_produtos__dbt_tmp" rename to "stg_produtos"
[0m00:44:07.359419 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:44:07.360025 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: COMMIT
[0m00:44:07.362624 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: COMMIT
[0m00:44:07.363978 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:44:07.366230 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: COMMIT
[0m00:44:07.367798 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:44:07.368258 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:44:07.370736 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: COMMIT
[0m00:44:07.371672 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:44:07.372549 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: COMMIT
[0m00:44:07.380448 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."stg_clientes__dbt_backup"
[0m00:44:07.381320 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:44:07.382369 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: COMMIT
[0m00:44:07.388397 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:44:07.388994 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:44:07.389898 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: COMMIT
[0m00:44:07.391548 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */
drop view if exists "dbt"."public"."stg_clientes__dbt_backup" cascade
[0m00:44:07.392054 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m00:44:07.395441 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_itens_vendas__dbt_backup"
[0m00:44:07.397121 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:44:07.401881 [debug] [Thread-4 (]: Applying DROP to: "dbt"."public"."stg_vendas__dbt_backup"
[0m00:44:07.402397 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:44:07.403687 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:44:07.407365 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_produtos__dbt_backup"
[0m00:44:07.408986 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:44:07.411189 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (execute): 00:44:07.181594 => 00:44:07.410953
[0m00:44:07.412217 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
drop view if exists "dbt"."public"."stg_itens_vendas__dbt_backup" cascade
[0m00:44:07.413763 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:44:07.414626 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
drop view if exists "dbt"."public"."stg_vendas__dbt_backup" cascade
[0m00:44:07.415497 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: Close
[0m00:44:07.416880 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
drop view if exists "dbt"."public"."stg_produtos__dbt_backup" cascade
[0m00:44:07.417816 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:44:07.419501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3109fb4-04e1-4291-8af0-ea0cdca70fe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f84567820>]}
[0m00:44:07.420187 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:44:07.422987 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (execute): 00:44:07.224601 => 00:44:07.422696
[0m00:44:07.423485 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:44:07.424524 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.stg_clientes ........................... [[32mCREATE VIEW[0m in 0.29s]
[0m00:44:07.426951 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (execute): 00:44:07.238063 => 00:44:07.426716
[0m00:44:07.428020 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: Close
[0m00:44:07.430228 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (execute): 00:44:07.231015 => 00:44:07.429962
[0m00:44:07.431323 [debug] [Thread-1 (]: Finished running node model.mage_case.stg_clientes
[0m00:44:07.432250 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: Close
[0m00:44:07.433724 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3109fb4-04e1-4291-8af0-ea0cdca70fe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f844c5000>]}
[0m00:44:07.434603 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: Close
[0m00:44:07.437029 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3109fb4-04e1-4291-8af0-ea0cdca70fe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f85611930>]}
[0m00:44:07.438602 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.stg_itens_vendas ....................... [[32mCREATE VIEW[0m in 0.30s]
[0m00:44:07.441283 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3109fb4-04e1-4291-8af0-ea0cdca70fe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f8448c0d0>]}
[0m00:44:07.443267 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.stg_vendas ............................. [[32mCREATE VIEW[0m in 0.30s]
[0m00:44:07.445811 [debug] [Thread-2 (]: Finished running node model.mage_case.stg_itens_vendas
[0m00:44:07.447966 [info ] [Thread-3 (]: 3 of 4 OK created sql view model public.stg_produtos ........................... [[32mCREATE VIEW[0m in 0.31s]
[0m00:44:07.450630 [debug] [Thread-4 (]: Finished running node model.mage_case.stg_vendas
[0m00:44:07.453804 [debug] [Thread-3 (]: Finished running node model.mage_case.stg_produtos
[0m00:44:07.458547 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:07.459925 [debug] [MainThread]: On master: BEGIN
[0m00:44:07.461071 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:44:07.471422 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:44:07.473077 [debug] [MainThread]: On master: COMMIT
[0m00:44:07.474559 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:07.476482 [debug] [MainThread]: On master: COMMIT
[0m00:44:07.478648 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:44:07.479974 [debug] [MainThread]: On master: Close
[0m00:44:07.481972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:44:07.483229 [debug] [MainThread]: Connection 'model.mage_case.stg_clientes' was properly closed.
[0m00:44:07.484177 [debug] [MainThread]: Connection 'model.mage_case.stg_itens_vendas' was properly closed.
[0m00:44:07.485296 [debug] [MainThread]: Connection 'model.mage_case.stg_produtos' was properly closed.
[0m00:44:07.486237 [debug] [MainThread]: Connection 'model.mage_case.stg_vendas' was properly closed.
[0m00:44:07.487417 [info ] [MainThread]: 
[0m00:44:07.489101 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m00:44:07.492512 [debug] [MainThread]: Command end result
[0m00:44:07.521357 [info ] [MainThread]: 
[0m00:44:07.522829 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:44:07.524579 [info ] [MainThread]: 
[0m00:44:07.526370 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:44:07.529652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f88ed3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f859fcf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8f859b8d00>]}
[0m00:44:07.531942 [debug] [MainThread]: Flushing usage events
[0m00:44:14.204433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757859f28e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757858695fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757858694a90>]}


============================== 00:44:14.211381 | 74daf87c-b931-49e2-af90-26ed3e102023 ==============================
[0m00:44:14.211381 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:44:14.213396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:44:14.532585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74daf87c-b931-49e2-af90-26ed3e102023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578583dee60>]}
[0m00:44:14.693285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74daf87c-b931-49e2-af90-26ed3e102023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578583a63b0>]}
[0m00:44:14.695946 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:44:14.742525 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:44:15.826532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:44:15.827644 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:44:15.829170 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.data_mart
- models.mage_case.staging
[0m00:44:15.836495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74daf87c-b931-49e2-af90-26ed3e102023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578567c80d0>]}
[0m00:44:15.877165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74daf87c-b931-49e2-af90-26ed3e102023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757856781060>]}
[0m00:44:15.879277 [info ] [MainThread]: Found 4 models, 20 tests, 4 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m00:44:15.881147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74daf87c-b931-49e2-af90-26ed3e102023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757856782e30>]}
[0m00:44:15.886821 [info ] [MainThread]: 
[0m00:44:15.889088 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:44:15.893344 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m00:44:15.911764 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:44:15.913611 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:44:15.915024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:44:15.930442 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:44:15.931922 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:44:15.933589 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:44:15.939518 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:44:15.943135 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:44:15.944958 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:44:15.954908 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:15.956479 [debug] [MainThread]: On master: BEGIN
[0m00:44:15.957837 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:44:15.971405 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:44:15.973008 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:15.974842 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:44:15.984022 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m00:44:15.987896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74daf87c-b931-49e2-af90-26ed3e102023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757856781750>]}
[0m00:44:15.990107 [debug] [MainThread]: On master: ROLLBACK
[0m00:44:15.992062 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:15.993754 [debug] [MainThread]: On master: BEGIN
[0m00:44:15.995844 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:44:15.997037 [debug] [MainThread]: On master: COMMIT
[0m00:44:15.998087 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:15.998910 [debug] [MainThread]: On master: COMMIT
[0m00:44:15.999875 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:44:16.000693 [debug] [MainThread]: On master: Close
[0m00:44:16.002404 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:44:16.003873 [info ] [MainThread]: 
[0m00:44:16.015621 [debug] [Thread-1 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:44:16.016284 [debug] [Thread-2 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629
[0m00:44:16.016836 [debug] [Thread-3 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665
[0m00:44:16.017463 [debug] [Thread-4 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f
[0m00:44:16.018339 [info ] [Thread-1 (]: 1 of 20 START test dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2  [RUN]
[0m00:44:16.019778 [info ] [Thread-2 (]: 2 of 20 START test dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0  [RUN]
[0m00:44:16.021274 [info ] [Thread-3 (]: 3 of 20 START test dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0  [RUN]
[0m00:44:16.023259 [info ] [Thread-4 (]: 4 of 20 START test dbt_utils_expression_is_true_stg_produtos_preco___0 ......... [RUN]
[0m00:44:16.027616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23)
[0m00:44:16.029871 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629'
[0m00:44:16.031855 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665'
[0m00:44:16.034016 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f'
[0m00:44:16.035789 [debug] [Thread-1 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:44:16.037566 [debug] [Thread-2 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629
[0m00:44:16.039180 [debug] [Thread-3 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665
[0m00:44:16.040416 [debug] [Thread-4 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f
[0m00:44:16.076361 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629"
[0m00:44:16.073681 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:44:16.083795 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665"
[0m00:44:16.089846 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f"
[0m00:44:16.098825 [debug] [Thread-3 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665 (compile): 00:44:16.077831 => 00:44:16.098124
[0m00:44:16.099891 [debug] [Thread-2 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629 (compile): 00:44:16.063517 => 00:44:16.099430
[0m00:44:16.101055 [debug] [Thread-3 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665
[0m00:44:16.102123 [debug] [Thread-4 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f (compile): 00:44:16.084831 => 00:44:16.101624
[0m00:44:16.102886 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23 (compile): 00:44:16.041262 => 00:44:16.102594
[0m00:44:16.103658 [debug] [Thread-2 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629
[0m00:44:16.123867 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665"
[0m00:44:16.124421 [debug] [Thread-4 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f
[0m00:44:16.126080 [debug] [Thread-1 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:44:16.131245 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629"
[0m00:44:16.138194 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f"
[0m00:44:16.143618 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:44:16.145716 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665"
[0m00:44:16.148578 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665: BEGIN
[0m00:44:16.149786 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:44:16.151898 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629"
[0m00:44:16.153780 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:44:16.154863 [debug] [Thread-2 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629: BEGIN
[0m00:44:16.156864 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f"
[0m00:44:16.157744 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: BEGIN
[0m00:44:16.159663 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:44:16.161608 [debug] [Thread-4 (]: On test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f: BEGIN
[0m00:44:16.162905 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:16.163478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:16.166103 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:44:16.167747 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665"
[0m00:44:16.171466 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_itens_vendas"

where not(quantidade > 0)


      
    ) dbt_internal_test
[0m00:44:16.175576 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:16.176155 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:16.179802 [debug] [Thread-3 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665 (execute): 00:44:16.104838 => 00:44:16.179392
[0m00:44:16.181722 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:16.182863 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:16.183442 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629"
[0m00:44:16.185005 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665: ROLLBACK
[0m00:44:16.186191 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:44:16.188398 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f"
[0m00:44:16.189605 [debug] [Thread-2 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_itens_vendas"

where not(preco_unitario >= 0)


      
    ) dbt_internal_test
[0m00:44:16.190827 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665: Close
[0m00:44:16.191497 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_clientes"

where not(estado  IS NOT NULL AND char_length(estado) = 2)


      
    ) dbt_internal_test
[0m00:44:16.192392 [debug] [Thread-4 (]: On test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_produtos"

where not(preco >= 0)


      
    ) dbt_internal_test
[0m00:44:16.194978 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:16.194406 [info ] [Thread-3 (]: 3 of 20 PASS dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0 ...... [[32mPASS[0m in 0.16s]
[0m00:44:16.197265 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:16.198119 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:16.200239 [debug] [Thread-2 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629 (execute): 00:44:16.127304 => 00:44:16.199890
[0m00:44:16.201504 [debug] [Thread-3 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665
[0m00:44:16.204060 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23 (execute): 00:44:16.139432 => 00:44:16.203660
[0m00:44:16.206598 [debug] [Thread-4 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f (execute): 00:44:16.133912 => 00:44:16.206250
[0m00:44:16.208008 [debug] [Thread-2 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629: ROLLBACK
[0m00:44:16.209149 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:44:16.210342 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: ROLLBACK
[0m00:44:16.211797 [debug] [Thread-4 (]: On test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f: ROLLBACK
[0m00:44:16.213017 [debug] [Thread-2 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629: Close
[0m00:44:16.213675 [info ] [Thread-3 (]: 5 of 20 START test not_null_stg_clientes_cidade ................................ [RUN]
[0m00:44:16.214960 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: Close
[0m00:44:16.216117 [debug] [Thread-4 (]: On test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f: Close
[0m00:44:16.217764 [info ] [Thread-2 (]: 2 of 20 PASS dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0 .. [[32mPASS[0m in 0.19s]
[0m00:44:16.219155 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665, now test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73)
[0m00:44:16.221011 [info ] [Thread-1 (]: 1 of 20 PASS dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2  [[32mPASS[0m in 0.19s]
[0m00:44:16.224384 [info ] [Thread-4 (]: 4 of 20 PASS dbt_utils_expression_is_true_stg_produtos_preco___0 ............... [[32mPASS[0m in 0.19s]
[0m00:44:16.227484 [debug] [Thread-2 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629
[0m00:44:16.228724 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:44:16.230213 [debug] [Thread-1 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:44:16.231451 [debug] [Thread-4 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f
[0m00:44:16.233226 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:44:16.247651 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:44:16.248898 [debug] [Thread-1 (]: Began running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:44:16.250714 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:44:16.252210 [info ] [Thread-2 (]: 6 of 20 START test not_null_stg_clientes_email ................................. [RUN]
[0m00:44:16.254236 [info ] [Thread-1 (]: 7 of 20 START test not_null_stg_clientes_estado ................................ [RUN]
[0m00:44:16.255783 [info ] [Thread-4 (]: 8 of 20 START test not_null_stg_clientes_id_cliente ............................ [RUN]
[0m00:44:16.257545 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629, now test.mage_case.not_null_stg_clientes_email.d1824e153a)
[0m00:44:16.259671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23, now test.mage_case.not_null_stg_clientes_estado.33c8769c0b)
[0m00:44:16.261731 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f, now test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2)
[0m00:44:16.263731 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:44:16.264979 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (compile): 00:44:16.234706 => 00:44:16.264565
[0m00:44:16.265999 [debug] [Thread-1 (]: Began compiling node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:44:16.267131 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:44:16.275518 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:44:16.276862 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:44:16.284447 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:44:16.291221 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:44:16.302368 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:44:16.305824 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (compile): 00:44:16.268186 => 00:44:16.305149
[0m00:44:16.308492 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (compile): 00:44:16.278090 => 00:44:16.307942
[0m00:44:16.309661 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:44:16.310270 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (compile): 00:44:16.285476 => 00:44:16.309989
[0m00:44:16.311529 [debug] [Thread-1 (]: Began executing node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:44:16.362064 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:44:16.363846 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:44:16.365581 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:44:16.369203 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:44:16.375252 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:44:16.376988 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: BEGIN
[0m00:44:16.380825 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:44:16.383383 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:44:16.384401 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:44:16.386062 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:44:16.386961 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: BEGIN
[0m00:44:16.388626 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: BEGIN
[0m00:44:16.390015 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: BEGIN
[0m00:44:16.391447 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:44:16.393184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:16.394804 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:16.395919 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:44:16.402052 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:44:16.406739 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cidade
from "dbt"."public"."stg_clientes"
where cidade is null



      
    ) dbt_internal_test
[0m00:44:16.411062 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:16.413188 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:16.416450 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (execute): 00:44:16.292959 => 00:44:16.415843
[0m00:44:16.418116 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:16.419782 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:44:16.420562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:16.422065 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: ROLLBACK
[0m00:44:16.423794 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:44:16.425686 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_email.d1824e153a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from "dbt"."public"."stg_clientes"
where email is null



      
    ) dbt_internal_test
[0m00:44:16.427466 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:44:16.429635 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: Close
[0m00:44:16.431162 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_cliente
from "dbt"."public"."stg_clientes"
where id_cliente is null



      
    ) dbt_internal_test
[0m00:44:16.433692 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select estado
from "dbt"."public"."stg_clientes"
where estado is null



      
    ) dbt_internal_test
[0m00:44:16.434612 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:16.437120 [info ] [Thread-3 (]: 5 of 20 PASS not_null_stg_clientes_cidade ...................................... [[32mPASS[0m in 0.22s]
[0m00:44:16.443170 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:16.447214 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:16.450879 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (execute): 00:44:16.312351 => 00:44:16.450369
[0m00:44:16.454131 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:44:16.458609 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (execute): 00:44:16.371407 => 00:44:16.457970
[0m00:44:16.471771 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (execute): 00:44:16.366023 => 00:44:16.471156
[0m00:44:16.476463 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: ROLLBACK
[0m00:44:16.486405 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:44:16.491585 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: ROLLBACK
[0m00:44:16.498178 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: ROLLBACK
[0m00:44:16.503159 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: Close
[0m00:44:16.505270 [info ] [Thread-3 (]: 9 of 20 START test not_null_stg_clientes_nome .................................. [RUN]
[0m00:44:16.510443 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: Close
[0m00:44:16.513067 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: Close
[0m00:44:16.516652 [info ] [Thread-2 (]: 6 of 20 PASS not_null_stg_clientes_email ....................................... [[32mPASS[0m in 0.26s]
[0m00:44:16.521713 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73, now test.mage_case.not_null_stg_clientes_nome.04166b95e6)
[0m00:44:16.526874 [info ] [Thread-4 (]: 8 of 20 PASS not_null_stg_clientes_id_cliente .................................. [[32mPASS[0m in 0.27s]
[0m00:44:16.530455 [info ] [Thread-1 (]: 7 of 20 PASS not_null_stg_clientes_estado ...................................... [[32mPASS[0m in 0.27s]
[0m00:44:16.533043 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:44:16.534936 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:44:16.538368 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:44:16.541794 [debug] [Thread-1 (]: Finished running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:44:16.545390 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750
[0m00:44:16.558693 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:44:16.562062 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9
[0m00:44:16.566704 [debug] [Thread-1 (]: Began running node test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014
[0m00:44:16.568862 [info ] [Thread-2 (]: 10 of 20 START test not_null_stg_itens_vendas_id_produto ....................... [RUN]
[0m00:44:16.574727 [info ] [Thread-4 (]: 11 of 20 START test not_null_stg_itens_vendas_id_venda ......................... [RUN]
[0m00:44:16.578497 [info ] [Thread-1 (]: 12 of 20 START test not_null_stg_itens_vendas_preco_unitario ................... [RUN]
[0m00:44:16.582017 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_email.d1824e153a, now test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750)
[0m00:44:16.585013 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2, now test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9)
[0m00:44:16.587758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_estado.33c8769c0b, now test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014)
[0m00:44:16.589764 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750
[0m00:44:16.592097 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9
[0m00:44:16.593258 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (compile): 00:44:16.547318 => 00:44:16.592732
[0m00:44:16.594749 [debug] [Thread-1 (]: Began compiling node test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014
[0m00:44:16.607983 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"
[0m00:44:16.622995 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"
[0m00:44:16.624166 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:44:16.637008 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"
[0m00:44:16.645628 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:44:16.651882 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9 (compile): 00:44:16.610792 => 00:44:16.651201
[0m00:44:16.652934 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750 (compile): 00:44:16.596169 => 00:44:16.652552
[0m00:44:16.654846 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9
[0m00:44:16.657137 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014 (compile): 00:44:16.625556 => 00:44:16.655871
[0m00:44:16.659015 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750
[0m00:44:16.665107 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"
[0m00:44:16.666987 [debug] [Thread-1 (]: Began executing node test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014
[0m00:44:16.668403 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:44:16.672580 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"
[0m00:44:16.681154 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"
[0m00:44:16.682848 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: BEGIN
[0m00:44:16.685976 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"
[0m00:44:16.687670 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:44:16.689267 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"
[0m00:44:16.691683 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9: BEGIN
[0m00:44:16.696684 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750: BEGIN
[0m00:44:16.697728 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"
[0m00:44:16.699047 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:44:16.700476 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:44:16.702371 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014: BEGIN
[0m00:44:16.706986 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:16.708310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:16.710579 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:44:16.714399 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_nome.04166b95e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome
from "dbt"."public"."stg_clientes"
where nome is null



      
    ) dbt_internal_test
[0m00:44:16.716132 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:16.718907 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"
[0m00:44:16.720060 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:16.721034 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:16.726462 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_venda
from "dbt"."public"."stg_itens_vendas"
where id_venda is null



      
    ) dbt_internal_test
[0m00:44:16.729132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:16.732818 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (execute): 00:44:16.639828 => 00:44:16.732371
[0m00:44:16.734463 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"
[0m00:44:16.737855 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:16.740398 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"
[0m00:44:16.743359 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: ROLLBACK
[0m00:44:16.745340 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_produto
from "dbt"."public"."stg_itens_vendas"
where id_produto is null



      
    ) dbt_internal_test
[0m00:44:16.750039 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9 (execute): 00:44:16.660936 => 00:44:16.749375
[0m00:44:16.752532 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select preco_unitario
from "dbt"."public"."stg_itens_vendas"
where preco_unitario is null



      
    ) dbt_internal_test
[0m00:44:16.755155 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: Close
[0m00:44:16.756773 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9: ROLLBACK
[0m00:44:16.757373 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:16.761725 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:16.760653 [info ] [Thread-3 (]: 9 of 20 PASS not_null_stg_clientes_nome ........................................ [[32mPASS[0m in 0.24s]
[0m00:44:16.763609 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9: Close
[0m00:44:16.766230 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750 (execute): 00:44:16.669370 => 00:44:16.765776
[0m00:44:16.770080 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014 (execute): 00:44:16.674568 => 00:44:16.769529
[0m00:44:16.772077 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:44:16.774340 [info ] [Thread-4 (]: 11 of 20 PASS not_null_stg_itens_vendas_id_venda ............................... [[32mPASS[0m in 0.19s]
[0m00:44:16.775666 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750: ROLLBACK
[0m00:44:16.777608 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014: ROLLBACK
[0m00:44:16.779386 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8
[0m00:44:16.781572 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9
[0m00:44:16.783680 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750: Close
[0m00:44:16.784947 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014: Close
[0m00:44:16.786027 [info ] [Thread-3 (]: 13 of 20 START test not_null_stg_itens_vendas_quantidade ....................... [RUN]
[0m00:44:16.788350 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576
[0m00:44:16.792527 [info ] [Thread-2 (]: 10 of 20 PASS not_null_stg_itens_vendas_id_produto ............................. [[32mPASS[0m in 0.21s]
[0m00:44:16.798722 [info ] [Thread-1 (]: 12 of 20 PASS not_null_stg_itens_vendas_preco_unitario ......................... [[32mPASS[0m in 0.21s]
[0m00:44:16.803859 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_nome.04166b95e6, now test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8)
[0m00:44:16.806194 [info ] [Thread-4 (]: 14 of 20 START test not_null_stg_produtos_categoria ............................ [RUN]
[0m00:44:16.809610 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750
[0m00:44:16.812456 [debug] [Thread-1 (]: Finished running node test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014
[0m00:44:16.815580 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8
[0m00:44:16.818292 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9, now test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576)
[0m00:44:16.819808 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4
[0m00:44:16.821984 [debug] [Thread-1 (]: Began running node test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120
[0m00:44:16.833821 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"
[0m00:44:16.836145 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576
[0m00:44:16.838744 [info ] [Thread-2 (]: 15 of 20 START test not_null_stg_produtos_id_produto ........................... [RUN]
[0m00:44:16.840973 [info ] [Thread-1 (]: 16 of 20 START test not_null_stg_produtos_nome_produto ......................... [RUN]
[0m00:44:16.858169 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576"
[0m00:44:16.861558 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750, now test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4)
[0m00:44:16.864153 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8 (compile): 00:44:16.824407 => 00:44:16.863122
[0m00:44:16.867968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014, now test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120)
[0m00:44:16.871992 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4
[0m00:44:16.873711 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8
[0m00:44:16.875730 [debug] [Thread-1 (]: Began compiling node test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120
[0m00:44:16.888260 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4"
[0m00:44:16.896161 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576 (compile): 00:44:16.846240 => 00:44:16.895632
[0m00:44:16.897709 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"
[0m00:44:16.908258 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120"
[0m00:44:16.911863 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576
[0m00:44:16.920535 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576"
[0m00:44:16.923252 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4 (compile): 00:44:16.877575 => 00:44:16.922615
[0m00:44:16.925402 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4
[0m00:44:16.928945 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120 (compile): 00:44:16.899253 => 00:44:16.928174
[0m00:44:16.935726 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"
[0m00:44:16.937235 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4"
[0m00:44:16.940231 [debug] [Thread-1 (]: Began executing node test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120
[0m00:44:16.946649 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8: BEGIN
[0m00:44:16.947487 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576"
[0m00:44:16.958437 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120"
[0m00:44:16.959975 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:44:16.961882 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576: BEGIN
[0m00:44:16.963068 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4"
[0m00:44:16.966840 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:44:16.968888 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4: BEGIN
[0m00:44:16.972194 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:44:16.980411 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120"
[0m00:44:16.982144 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:16.982960 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120: BEGIN
[0m00:44:16.984398 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"
[0m00:44:16.985707 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:16.986590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:16.988163 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:16.989325 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quantidade
from "dbt"."public"."stg_itens_vendas"
where quantidade is null



      
    ) dbt_internal_test
[0m00:44:16.990871 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576"
[0m00:44:16.993053 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4"
[0m00:44:16.995851 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select categoria
from "dbt"."public"."stg_produtos"
where categoria is null



      
    ) dbt_internal_test
[0m00:44:16.996707 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:16.997835 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_produto
from "dbt"."public"."stg_produtos"
where id_produto is null



      
    ) dbt_internal_test
[0m00:44:17.002049 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8 (execute): 00:44:16.890425 => 00:44:17.001667
[0m00:44:17.002828 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:17.004964 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:17.005762 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:17.006768 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8: ROLLBACK
[0m00:44:17.009365 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576 (execute): 00:44:16.915629 => 00:44:17.008999
[0m00:44:17.010884 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120"
[0m00:44:17.013546 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4 (execute): 00:44:16.929741 => 00:44:17.013129
[0m00:44:17.014992 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8: Close
[0m00:44:17.015807 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576: ROLLBACK
[0m00:44:17.017297 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome_produto
from "dbt"."public"."stg_produtos"
where nome_produto is null



      
    ) dbt_internal_test
[0m00:44:17.018802 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4: ROLLBACK
[0m00:44:17.020684 [info ] [Thread-3 (]: 13 of 20 PASS not_null_stg_itens_vendas_quantidade ............................. [[32mPASS[0m in 0.22s]
[0m00:44:17.022402 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576: Close
[0m00:44:17.025629 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:17.026621 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4: Close
[0m00:44:17.027941 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8
[0m00:44:17.030252 [info ] [Thread-4 (]: 14 of 20 PASS not_null_stg_produtos_categoria .................................. [[32mPASS[0m in 0.21s]
[0m00:44:17.033656 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120 (execute): 00:44:16.949937 => 00:44:17.033145
[0m00:44:17.036308 [info ] [Thread-2 (]: 15 of 20 PASS not_null_stg_produtos_id_produto ................................. [[32mPASS[0m in 0.18s]
[0m00:44:17.040077 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_produtos_preco.d32f7aebfa
[0m00:44:17.042954 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576
[0m00:44:17.044940 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120: ROLLBACK
[0m00:44:17.047519 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4
[0m00:44:17.049627 [info ] [Thread-3 (]: 17 of 20 START test not_null_stg_produtos_preco ................................ [RUN]
[0m00:44:17.051958 [debug] [Thread-4 (]: Began running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:44:17.054242 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120: Close
[0m00:44:17.055999 [debug] [Thread-2 (]: Began running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:44:17.058377 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8, now test.mage_case.not_null_stg_produtos_preco.d32f7aebfa)
[0m00:44:17.059942 [info ] [Thread-4 (]: 18 of 20 START test unique_stg_clientes_email .................................. [RUN]
[0m00:44:17.062771 [info ] [Thread-1 (]: 16 of 20 PASS not_null_stg_produtos_nome_produto ............................... [[32mPASS[0m in 0.20s]
[0m00:44:17.066149 [info ] [Thread-2 (]: 19 of 20 START test unique_stg_clientes_id_cliente ............................. [RUN]
[0m00:44:17.068063 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_produtos_preco.d32f7aebfa
[0m00:44:17.071324 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576, now test.mage_case.unique_stg_clientes_email.2b7c7e0aff)
[0m00:44:17.076032 [debug] [Thread-1 (]: Finished running node test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120
[0m00:44:17.080128 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4, now test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3)
[0m00:44:17.095566 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_produtos_preco.d32f7aebfa"
[0m00:44:17.097859 [debug] [Thread-4 (]: Began compiling node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:44:17.101104 [debug] [Thread-1 (]: Began running node test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c
[0m00:44:17.102963 [debug] [Thread-2 (]: Began compiling node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:44:17.129534 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:44:17.132210 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_produtos_preco.d32f7aebfa (compile): 00:44:17.081900 => 00:44:17.131590
[0m00:44:17.130863 [info ] [Thread-1 (]: 20 of 20 START test unique_stg_produtos_id_produto ............................. [RUN]
[0m00:44:17.146762 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:44:17.150049 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_produtos_preco.d32f7aebfa
[0m00:44:17.152641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120, now test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c)
[0m00:44:17.165311 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_produtos_preco.d32f7aebfa"
[0m00:44:17.167717 [debug] [Thread-1 (]: Began compiling node test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c
[0m00:44:17.170514 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (compile): 00:44:17.105642 => 00:44:17.169881
[0m00:44:17.179669 [debug] [Thread-2 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (compile): 00:44:17.135789 => 00:44:17.178990
[0m00:44:17.184665 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c"
[0m00:44:17.186071 [debug] [Thread-4 (]: Began executing node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:44:17.187472 [debug] [Thread-2 (]: Began executing node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:44:17.188209 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_produtos_preco.d32f7aebfa"
[0m00:44:17.197805 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:44:17.204876 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:44:17.206554 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_produtos_preco.d32f7aebfa: BEGIN
[0m00:44:17.207792 [debug] [Thread-1 (]: Timing info for test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c (compile): 00:44:17.173571 => 00:44:17.207356
[0m00:44:17.211563 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:44:17.213793 [debug] [Thread-1 (]: Began executing node test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c
[0m00:44:17.216439 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:44:17.222012 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c"
[0m00:44:17.222728 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:44:17.224422 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: BEGIN
[0m00:44:17.228411 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: BEGIN
[0m00:44:17.229368 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:17.230932 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:44:17.232451 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:44:17.234090 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_produtos_preco.d32f7aebfa"
[0m00:44:17.239044 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_produtos_preco.d32f7aebfa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_produtos_preco.d32f7aebfa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select preco
from "dbt"."public"."stg_produtos"
where preco is null



      
    ) dbt_internal_test
[0m00:44:17.240105 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c"
[0m00:44:17.242559 [debug] [Thread-1 (]: On test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c: BEGIN
[0m00:44:17.243378 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:17.245530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:17.251938 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_produtos_preco.d32f7aebfa (execute): 00:44:17.157399 => 00:44:17.251242
[0m00:44:17.256993 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:17.258196 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:17.266815 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_produtos_preco.d32f7aebfa: ROLLBACK
[0m00:44:17.271320 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:44:17.279691 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:44:17.300519 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_produtos_preco.d32f7aebfa: Close
[0m00:44:17.302523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:44:17.303458 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where email is not null
group by email
having count(*) > 1



      
    ) dbt_internal_test
[0m00:44:17.306737 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_cliente as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where id_cliente is not null
group by id_cliente
having count(*) > 1



      
    ) dbt_internal_test
[0m00:44:17.311253 [info ] [Thread-3 (]: 17 of 20 PASS not_null_stg_produtos_preco ...................................... [[32mPASS[0m in 0.25s]
[0m00:44:17.318267 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c"
[0m00:44:17.325175 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_produtos_preco.d32f7aebfa
[0m00:44:17.326146 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:17.327108 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:17.336875 [debug] [Thread-1 (]: On test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_produto as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_produtos"
where id_produto is not null
group by id_produto
having count(*) > 1



      
    ) dbt_internal_test
[0m00:44:17.345160 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (execute): 00:44:17.190915 => 00:44:17.342739
[0m00:44:17.351452 [debug] [Thread-2 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (execute): 00:44:17.199084 => 00:44:17.350796
[0m00:44:17.357887 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: ROLLBACK
[0m00:44:17.359443 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:44:17.361593 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: ROLLBACK
[0m00:44:17.364512 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: Close
[0m00:44:17.368673 [debug] [Thread-1 (]: Timing info for test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c (execute): 00:44:17.217862 => 00:44:17.367949
[0m00:44:17.372015 [debug] [Thread-2 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: Close
[0m00:44:17.374993 [info ] [Thread-4 (]: 18 of 20 PASS unique_stg_clientes_email ........................................ [[32mPASS[0m in 0.30s]
[0m00:44:17.380702 [debug] [Thread-1 (]: On test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c: ROLLBACK
[0m00:44:17.385290 [info ] [Thread-2 (]: 19 of 20 PASS unique_stg_clientes_id_cliente ................................... [[32mPASS[0m in 0.31s]
[0m00:44:17.395982 [debug] [Thread-4 (]: Finished running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:44:17.398729 [debug] [Thread-1 (]: On test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c: Close
[0m00:44:17.401894 [debug] [Thread-2 (]: Finished running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:44:17.409041 [info ] [Thread-1 (]: 20 of 20 PASS unique_stg_produtos_id_produto ................................... [[32mPASS[0m in 0.26s]
[0m00:44:17.415843 [debug] [Thread-1 (]: Finished running node test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c
[0m00:44:17.421993 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:17.424420 [debug] [MainThread]: On master: BEGIN
[0m00:44:17.427520 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:44:17.445202 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:44:17.449686 [debug] [MainThread]: On master: COMMIT
[0m00:44:17.468769 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:17.477331 [debug] [MainThread]: On master: COMMIT
[0m00:44:17.480405 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:44:17.482041 [debug] [MainThread]: On master: Close
[0m00:44:17.485762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:44:17.488796 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c' was properly closed.
[0m00:44:17.491368 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3' was properly closed.
[0m00:44:17.492724 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_produtos_preco.d32f7aebfa' was properly closed.
[0m00:44:17.494258 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_email.2b7c7e0aff' was properly closed.
[0m00:44:17.496836 [info ] [MainThread]: 
[0m00:44:17.499042 [info ] [MainThread]: Finished running 20 tests in 0 hours 0 minutes and 1.61 seconds (1.61s).
[0m00:44:17.507124 [debug] [MainThread]: Command end result
[0m00:44:17.561873 [info ] [MainThread]: 
[0m00:44:17.564891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:44:17.568075 [info ] [MainThread]: 
[0m00:44:17.570465 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=0 SKIP=0 TOTAL=20
[0m00:44:17.574220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757859f28e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578566d4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7578566d4790>]}
[0m00:44:17.576602 [debug] [MainThread]: Flushing usage events
[0m00:45:32.578966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72639914b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263997ce4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263997cdea0>]}


============================== 00:45:32.589125 | 3080f008-28c1-4900-9e33-ed753e31387e ==============================
[0m00:45:32.589125 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:45:32.591045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:45:32.862836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3080f008-28c1-4900-9e33-ed753e31387e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263975eed70>]}
[0m00:45:32.992091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3080f008-28c1-4900-9e33-ed753e31387e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263978afbe0>]}
[0m00:45:32.994284 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:45:33.040652 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:45:34.293734 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:45:34.295319 [debug] [MainThread]: Partial parsing: updated file: mage_case://models/stagking/stg_vendas.sql
[0m00:45:34.608096 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.staging
- models.mage_case.data_mart
[0m00:45:34.629824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3080f008-28c1-4900-9e33-ed753e31387e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726395907e20>]}
[0m00:45:34.699190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3080f008-28c1-4900-9e33-ed753e31387e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263959a0f70>]}
[0m00:45:34.700957 [info ] [MainThread]: Found 4 models, 20 tests, 4 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m00:45:34.702853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3080f008-28c1-4900-9e33-ed753e31387e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263959a2d40>]}
[0m00:45:34.708090 [info ] [MainThread]: 
[0m00:45:34.712222 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:45:34.716629 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m00:45:34.741816 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m00:45:34.744331 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m00:45:34.746431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:45:34.770022 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m00:45:34.773895 [debug] [ThreadPool]: On list_dbt: Close
[0m00:45:34.779322 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_public)
[0m00:45:34.790945 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:45:34.792286 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:45:34.793350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:45:34.805730 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:45:34.807176 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:45:34.808519 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:45:34.813478 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:45:34.815859 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:45:34.817320 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:45:34.826385 [debug] [MainThread]: Using postgres connection "master"
[0m00:45:34.827620 [debug] [MainThread]: On master: BEGIN
[0m00:45:34.828651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:45:34.840178 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:45:34.841657 [debug] [MainThread]: Using postgres connection "master"
[0m00:45:34.843165 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:45:34.850120 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m00:45:34.853692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3080f008-28c1-4900-9e33-ed753e31387e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72639493dab0>]}
[0m00:45:34.855043 [debug] [MainThread]: On master: ROLLBACK
[0m00:45:34.856214 [debug] [MainThread]: Using postgres connection "master"
[0m00:45:34.857052 [debug] [MainThread]: On master: BEGIN
[0m00:45:34.858486 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:45:34.859881 [debug] [MainThread]: On master: COMMIT
[0m00:45:34.861028 [debug] [MainThread]: Using postgres connection "master"
[0m00:45:34.861868 [debug] [MainThread]: On master: COMMIT
[0m00:45:34.863028 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:45:34.863985 [debug] [MainThread]: On master: Close
[0m00:45:34.865384 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:45:34.866759 [info ] [MainThread]: 
[0m00:45:34.876954 [debug] [Thread-1 (]: Began running node model.mage_case.stg_clientes
[0m00:45:34.877738 [debug] [Thread-2 (]: Began running node model.mage_case.stg_itens_vendas
[0m00:45:34.878554 [debug] [Thread-3 (]: Began running node model.mage_case.stg_produtos
[0m00:45:34.879647 [debug] [Thread-4 (]: Began running node model.mage_case.stg_vendas
[0m00:45:34.881514 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_clientes ................................ [RUN]
[0m00:45:34.883440 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_itens_vendas ............................ [RUN]
[0m00:45:34.885663 [info ] [Thread-3 (]: 3 of 4 START sql view model public.stg_produtos ................................ [RUN]
[0m00:45:34.888961 [info ] [Thread-4 (]: 4 of 4 START sql view model public.stg_vendas .................................. [RUN]
[0m00:45:34.892814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now model.mage_case.stg_clientes)
[0m00:45:34.896129 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.mage_case.stg_itens_vendas'
[0m00:45:34.899204 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.mage_case.stg_produtos'
[0m00:45:34.901961 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.mage_case.stg_vendas'
[0m00:45:34.903537 [debug] [Thread-1 (]: Began compiling node model.mage_case.stg_clientes
[0m00:45:34.904728 [debug] [Thread-2 (]: Began compiling node model.mage_case.stg_itens_vendas
[0m00:45:34.906288 [debug] [Thread-3 (]: Began compiling node model.mage_case.stg_produtos
[0m00:45:34.908192 [debug] [Thread-4 (]: Began compiling node model.mage_case.stg_vendas
[0m00:45:34.923988 [debug] [Thread-1 (]: Writing injected SQL for node "model.mage_case.stg_clientes"
[0m00:45:34.931689 [debug] [Thread-2 (]: Writing injected SQL for node "model.mage_case.stg_itens_vendas"
[0m00:45:35.044164 [debug] [Thread-3 (]: Writing injected SQL for node "model.mage_case.stg_produtos"
[0m00:45:35.052993 [debug] [Thread-4 (]: Writing injected SQL for node "model.mage_case.stg_vendas"
[0m00:45:35.065417 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (compile): 00:45:34.925039 => 00:45:35.064683
[0m00:45:35.066809 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (compile): 00:45:34.909987 => 00:45:35.066099
[0m00:45:35.068929 [debug] [Thread-2 (]: Began executing node model.mage_case.stg_itens_vendas
[0m00:45:35.070137 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (compile): 00:45:34.932969 => 00:45:35.069619
[0m00:45:35.071005 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (compile): 00:45:35.046177 => 00:45:35.070598
[0m00:45:35.072156 [debug] [Thread-1 (]: Began executing node model.mage_case.stg_clientes
[0m00:45:35.096996 [debug] [Thread-3 (]: Began executing node model.mage_case.stg_produtos
[0m00:45:35.123525 [debug] [Thread-4 (]: Began executing node model.mage_case.stg_vendas
[0m00:45:35.124860 [debug] [Thread-2 (]: Writing runtime sql for node "model.mage_case.stg_itens_vendas"
[0m00:45:35.130479 [debug] [Thread-1 (]: Writing runtime sql for node "model.mage_case.stg_clientes"
[0m00:45:35.139788 [debug] [Thread-3 (]: Writing runtime sql for node "model.mage_case.stg_produtos"
[0m00:45:35.146891 [debug] [Thread-4 (]: Writing runtime sql for node "model.mage_case.stg_vendas"
[0m00:45:35.152862 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:45:35.154577 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:45:35.155362 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: BEGIN
[0m00:45:35.155905 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:45:35.156404 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:45:35.157256 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: BEGIN
[0m00:45:35.158163 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:45:35.159055 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: BEGIN
[0m00:45:35.159976 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: BEGIN
[0m00:45:35.160873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:45:35.162780 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:45:35.164154 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:45:35.171478 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:45:35.172677 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:45:35.173731 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */

  create view "dbt"."public"."stg_produtos__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT 
        *
    FROM
        "dbt"."public"."produtos"
)

SELECT
    id_produto,
    nome_produto,
    categoria,
    preco
FROM
    source
  );
[0m00:45:35.175523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:45:35.177019 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:45:35.178384 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:45:35.178973 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:45:35.179928 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:45:35.187058 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:45:35.188120 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */

  create view "dbt"."public"."stg_clientes__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT 
        *
    FROM
        "dbt"."public"."clientes"
)

SELECT
    id_cliente,
    nome,
    email,
    cidade,
    estado
FROM
    source
  );
[0m00:45:35.189260 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:45:35.190216 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:45:35.191058 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
alter table "dbt"."public"."stg_produtos" rename to "stg_produtos__dbt_backup"
[0m00:45:35.193096 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */

  create view "dbt"."public"."stg_itens_vendas__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT 
        *
    FROM
        "dbt"."public"."itens_vendas"
)

SELECT
    id_venda,
    id_produto,
    quantidade,
    preco_unitario
FROM
    source
  );
[0m00:45:35.193834 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:45:35.194496 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */

  create view "dbt"."public"."stg_vendas__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT 
        *
    FROM
        "dbt"."public"."vendas"
)

SELECT
    id_venda,
    id_cliente,
    data_venda,
    valor_total
FROM
    source
  );
[0m00:45:35.195900 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:45:35.197937 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:45:35.202370 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:45:35.207268 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:45:35.207953 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:45:35.212558 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:45:35.213844 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */
alter table "dbt"."public"."stg_clientes" rename to "stg_clientes__dbt_backup"
[0m00:45:35.215031 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
alter table "dbt"."public"."stg_produtos__dbt_tmp" rename to "stg_produtos"
[0m00:45:35.220227 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:45:35.221419 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
alter table "dbt"."public"."stg_itens_vendas" rename to "stg_itens_vendas__dbt_backup"
[0m00:45:35.222865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:45:35.223705 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:45:35.224199 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
alter table "dbt"."public"."stg_vendas" rename to "stg_vendas__dbt_backup"
[0m00:45:35.225465 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:45:35.230261 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:45:35.249147 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: COMMIT
[0m00:45:35.250183 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:45:35.254786 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:45:35.256453 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */
alter table "dbt"."public"."stg_clientes__dbt_tmp" rename to "stg_clientes"
[0m00:45:35.258100 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:45:35.262369 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:45:35.263447 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
alter table "dbt"."public"."stg_itens_vendas__dbt_tmp" rename to "stg_itens_vendas"
[0m00:45:35.265039 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:45:35.265475 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: COMMIT
[0m00:45:35.266350 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
alter table "dbt"."public"."stg_vendas__dbt_tmp" rename to "stg_vendas"
[0m00:45:35.267768 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:45:35.270077 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: COMMIT
[0m00:45:35.271901 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:45:35.272472 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:45:35.274457 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: COMMIT
[0m00:45:35.275444 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:45:35.283368 [debug] [Thread-3 (]: Applying DROP to: "dbt"."public"."stg_produtos__dbt_backup"
[0m00:45:35.286195 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: COMMIT
[0m00:45:35.287476 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:45:35.288614 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: COMMIT
[0m00:45:35.294110 [debug] [Thread-3 (]: Using postgres connection "model.mage_case.stg_produtos"
[0m00:45:35.295303 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:45:35.296641 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: COMMIT
[0m00:45:35.298688 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_produtos"} */
drop view if exists "dbt"."public"."stg_produtos__dbt_backup" cascade
[0m00:45:35.299596 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:45:35.300593 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: COMMIT
[0m00:45:35.302380 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:45:35.306251 [debug] [Thread-1 (]: Applying DROP to: "dbt"."public"."stg_clientes__dbt_backup"
[0m00:45:35.306738 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:45:35.310907 [debug] [Thread-2 (]: Applying DROP to: "dbt"."public"."stg_itens_vendas__dbt_backup"
[0m00:45:35.311503 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m00:45:35.313201 [debug] [Thread-1 (]: Using postgres connection "model.mage_case.stg_clientes"
[0m00:45:35.316640 [debug] [Thread-3 (]: Timing info for model.mage_case.stg_produtos (execute): 00:45:35.132006 => 00:45:35.316396
[0m00:45:35.318375 [debug] [Thread-2 (]: Using postgres connection "model.mage_case.stg_itens_vendas"
[0m00:45:35.322022 [debug] [Thread-4 (]: Applying DROP to: "dbt"."public"."stg_vendas__dbt_backup"
[0m00:45:35.323298 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_clientes"} */
drop view if exists "dbt"."public"."stg_clientes__dbt_backup" cascade
[0m00:45:35.324273 [debug] [Thread-3 (]: On model.mage_case.stg_produtos: Close
[0m00:45:35.325143 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_itens_vendas"} */
drop view if exists "dbt"."public"."stg_itens_vendas__dbt_backup" cascade
[0m00:45:35.326837 [debug] [Thread-4 (]: Using postgres connection "model.mage_case.stg_vendas"
[0m00:45:35.329132 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3080f008-28c1-4900-9e33-ed753e31387e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263949ed330>]}
[0m00:45:35.329728 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:45:35.331446 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.mage_case.stg_vendas"} */
drop view if exists "dbt"."public"."stg_vendas__dbt_backup" cascade
[0m00:45:35.332239 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:45:35.333474 [info ] [Thread-3 (]: 3 of 4 OK created sql view model public.stg_produtos ........................... [[32mCREATE VIEW[0m in 0.43s]
[0m00:45:35.336331 [debug] [Thread-1 (]: Timing info for model.mage_case.stg_clientes (execute): 00:45:35.125880 => 00:45:35.335982
[0m00:45:35.340180 [debug] [Thread-2 (]: Timing info for model.mage_case.stg_itens_vendas (execute): 00:45:35.073514 => 00:45:35.339672
[0m00:45:35.340741 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:45:35.341825 [debug] [Thread-3 (]: Finished running node model.mage_case.stg_produtos
[0m00:45:35.342810 [debug] [Thread-1 (]: On model.mage_case.stg_clientes: Close
[0m00:45:35.343785 [debug] [Thread-2 (]: On model.mage_case.stg_itens_vendas: Close
[0m00:45:35.346430 [debug] [Thread-4 (]: Timing info for model.mage_case.stg_vendas (execute): 00:45:35.140520 => 00:45:35.346192
[0m00:45:35.348713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3080f008-28c1-4900-9e33-ed753e31387e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263949ecac0>]}
[0m00:45:35.350090 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3080f008-28c1-4900-9e33-ed753e31387e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72639488cf70>]}
[0m00:45:35.351041 [debug] [Thread-4 (]: On model.mage_case.stg_vendas: Close
[0m00:45:35.352329 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.stg_clientes ........................... [[32mCREATE VIEW[0m in 0.46s]
[0m00:45:35.353627 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.stg_itens_vendas ....................... [[32mCREATE VIEW[0m in 0.45s]
[0m00:45:35.355548 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3080f008-28c1-4900-9e33-ed753e31387e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263949ed0c0>]}
[0m00:45:35.357286 [debug] [Thread-1 (]: Finished running node model.mage_case.stg_clientes
[0m00:45:35.359122 [debug] [Thread-2 (]: Finished running node model.mage_case.stg_itens_vendas
[0m00:45:35.361115 [info ] [Thread-4 (]: 4 of 4 OK created sql view model public.stg_vendas ............................. [[32mCREATE VIEW[0m in 0.45s]
[0m00:45:35.365107 [debug] [Thread-4 (]: Finished running node model.mage_case.stg_vendas
[0m00:45:35.369552 [debug] [MainThread]: Using postgres connection "master"
[0m00:45:35.370910 [debug] [MainThread]: On master: BEGIN
[0m00:45:35.372459 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:45:35.384346 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:45:35.385734 [debug] [MainThread]: On master: COMMIT
[0m00:45:35.387865 [debug] [MainThread]: Using postgres connection "master"
[0m00:45:35.389879 [debug] [MainThread]: On master: COMMIT
[0m00:45:35.391964 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:45:35.393488 [debug] [MainThread]: On master: Close
[0m00:45:35.395452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:45:35.397029 [debug] [MainThread]: Connection 'model.mage_case.stg_clientes' was properly closed.
[0m00:45:35.398143 [debug] [MainThread]: Connection 'model.mage_case.stg_itens_vendas' was properly closed.
[0m00:45:35.399195 [debug] [MainThread]: Connection 'model.mage_case.stg_produtos' was properly closed.
[0m00:45:35.400393 [debug] [MainThread]: Connection 'model.mage_case.stg_vendas' was properly closed.
[0m00:45:35.401916 [info ] [MainThread]: 
[0m00:45:35.403063 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m00:45:35.405763 [debug] [MainThread]: Command end result
[0m00:45:35.439159 [info ] [MainThread]: 
[0m00:45:35.441398 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:45:35.443657 [info ] [MainThread]: 
[0m00:45:35.446465 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:45:35.450839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72639914b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263978afbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72639493d9f0>]}
[0m00:45:35.452987 [debug] [MainThread]: Flushing usage events
[0m00:47:11.501066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749676393730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749676ad24d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749676ad1ea0>]}


============================== 00:47:11.508435 | 5ac15cbe-e56e-4c06-a822-3350be9e0f92 ==============================
[0m00:47:11.508435 [info ] [MainThread]: Running with dbt=1.7.9
[0m00:47:11.509695 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m00:47:11.755317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ac15cbe-e56e-4c06-a822-3350be9e0f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496749f6d70>]}
[0m00:47:11.893315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ac15cbe-e56e-4c06-a822-3350be9e0f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749674eabbb0>]}
[0m00:47:11.894922 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m00:47:11.926062 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m00:47:12.904512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:47:12.905709 [debug] [MainThread]: Partial parsing: added file: mage_case://models/stagking/stg_vendas.yml
[0m00:47:13.147833 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mage_case.data_mart
- models.mage_case.staging
[0m00:47:13.159490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ac15cbe-e56e-4c06-a822-3350be9e0f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749672b700d0>]}
[0m00:47:13.296225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ac15cbe-e56e-4c06-a822-3350be9e0f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749672d97cd0>]}
[0m00:47:13.297823 [info ] [MainThread]: Found 4 models, 25 tests, 4 sources, 0 exposures, 0 metrics, 517 macros, 0 groups, 0 semantic models
[0m00:47:13.299798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ac15cbe-e56e-4c06-a822-3350be9e0f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749672d97eb0>]}
[0m00:47:13.304942 [info ] [MainThread]: 
[0m00:47:13.307431 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:47:13.310739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_public'
[0m00:47:13.329148 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:47:13.331268 [debug] [ThreadPool]: On list_dbt_public: BEGIN
[0m00:47:13.337475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:13.354203 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:47:13.356776 [debug] [ThreadPool]: Using postgres connection "list_dbt_public"
[0m00:47:13.358487 [debug] [ThreadPool]: On list_dbt_public: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_dbt_public"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:47:13.364594 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:47:13.367018 [debug] [ThreadPool]: On list_dbt_public: ROLLBACK
[0m00:47:13.368544 [debug] [ThreadPool]: On list_dbt_public: Close
[0m00:47:13.439802 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:13.441352 [debug] [MainThread]: On master: BEGIN
[0m00:47:13.442636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:47:13.458888 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:47:13.461352 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:13.464601 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:47:13.474324 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m00:47:13.480025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ac15cbe-e56e-4c06-a822-3350be9e0f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749672e0e4a0>]}
[0m00:47:13.482211 [debug] [MainThread]: On master: ROLLBACK
[0m00:47:13.484354 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:13.485847 [debug] [MainThread]: On master: BEGIN
[0m00:47:13.488035 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:47:13.489357 [debug] [MainThread]: On master: COMMIT
[0m00:47:13.491068 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:13.492467 [debug] [MainThread]: On master: COMMIT
[0m00:47:13.494175 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:47:13.495520 [debug] [MainThread]: On master: Close
[0m00:47:13.497328 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:47:13.498686 [info ] [MainThread]: 
[0m00:47:13.510808 [debug] [Thread-1 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:47:13.511490 [debug] [Thread-2 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629
[0m00:47:13.512064 [debug] [Thread-3 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665
[0m00:47:13.512720 [debug] [Thread-4 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f
[0m00:47:13.513812 [info ] [Thread-1 (]: 1 of 25 START test dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2  [RUN]
[0m00:47:13.517573 [info ] [Thread-2 (]: 2 of 25 START test dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0  [RUN]
[0m00:47:13.520709 [info ] [Thread-3 (]: 3 of 25 START test dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0  [RUN]
[0m00:47:13.523367 [info ] [Thread-4 (]: 4 of 25 START test dbt_utils_expression_is_true_stg_produtos_preco___0 ......... [RUN]
[0m00:47:13.528103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_public, now test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23)
[0m00:47:13.530904 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629'
[0m00:47:13.533821 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665'
[0m00:47:13.537780 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f'
[0m00:47:13.539653 [debug] [Thread-1 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:47:13.541366 [debug] [Thread-2 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629
[0m00:47:13.543558 [debug] [Thread-3 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665
[0m00:47:13.546062 [debug] [Thread-4 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f
[0m00:47:13.570531 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:47:13.578256 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629"
[0m00:47:13.588846 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665"
[0m00:47:13.599832 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f"
[0m00:47:13.608307 [debug] [Thread-2 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629 (compile): 00:47:13.571149 => 00:47:13.607609
[0m00:47:13.609694 [debug] [Thread-3 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665 (compile): 00:47:13.579691 => 00:47:13.609025
[0m00:47:13.610686 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23 (compile): 00:47:13.547972 => 00:47:13.610236
[0m00:47:13.611544 [debug] [Thread-4 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f (compile): 00:47:13.590130 => 00:47:13.611099
[0m00:47:13.613043 [debug] [Thread-2 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629
[0m00:47:13.615543 [debug] [Thread-3 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665
[0m00:47:13.617261 [debug] [Thread-1 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:47:13.618862 [debug] [Thread-4 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f
[0m00:47:13.638306 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629"
[0m00:47:13.641499 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665"
[0m00:47:13.645439 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:47:13.650381 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f"
[0m00:47:13.658153 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665"
[0m00:47:13.659304 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:47:13.660671 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629"
[0m00:47:13.662178 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665: BEGIN
[0m00:47:13.663916 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f"
[0m00:47:13.665824 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: BEGIN
[0m00:47:13.667302 [debug] [Thread-2 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629: BEGIN
[0m00:47:13.668563 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:47:13.669636 [debug] [Thread-4 (]: On test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f: BEGIN
[0m00:47:13.670831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:13.671934 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:47:13.674829 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:47:13.685564 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:13.687961 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:13.690241 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665"
[0m00:47:13.691627 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:13.692354 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:13.692859 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629"
[0m00:47:13.694150 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_itens_vendas"

where not(quantidade > 0)


      
    ) dbt_internal_test
[0m00:47:13.695357 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"
[0m00:47:13.696397 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f"
[0m00:47:13.697460 [debug] [Thread-2 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_itens_vendas"

where not(preco_unitario >= 0)


      
    ) dbt_internal_test
[0m00:47:13.698958 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_clientes"

where not(estado  IS NOT NULL AND char_length(estado) = 2)


      
    ) dbt_internal_test
[0m00:47:13.699566 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:13.700241 [debug] [Thread-4 (]: On test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_produtos"

where not(preco >= 0)


      
    ) dbt_internal_test
[0m00:47:13.702538 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:13.705675 [debug] [Thread-3 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665 (execute): 00:47:13.638688 => 00:47:13.705343
[0m00:47:13.706173 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:13.709622 [debug] [Thread-2 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629 (execute): 00:47:13.620284 => 00:47:13.709189
[0m00:47:13.710784 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:13.711872 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665: ROLLBACK
[0m00:47:13.714260 [debug] [Thread-1 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23 (execute): 00:47:13.642590 => 00:47:13.713973
[0m00:47:13.715372 [debug] [Thread-2 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629: ROLLBACK
[0m00:47:13.718168 [debug] [Thread-4 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f (execute): 00:47:13.646748 => 00:47:13.717626
[0m00:47:13.720246 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665: Close
[0m00:47:13.721132 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: ROLLBACK
[0m00:47:13.722472 [debug] [Thread-2 (]: On test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629: Close
[0m00:47:13.723350 [debug] [Thread-4 (]: On test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f: ROLLBACK
[0m00:47:13.725247 [info ] [Thread-3 (]: 3 of 25 PASS dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0 ...... [[32mPASS[0m in 0.19s]
[0m00:47:13.726757 [debug] [Thread-1 (]: On test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23: Close
[0m00:47:13.728548 [info ] [Thread-2 (]: 2 of 25 PASS dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0 .. [[32mPASS[0m in 0.20s]
[0m00:47:13.730880 [debug] [Thread-4 (]: On test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f: Close
[0m00:47:13.732611 [debug] [Thread-3 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665
[0m00:47:13.736111 [info ] [Thread-1 (]: 1 of 25 PASS dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2  [[32mPASS[0m in 0.21s]
[0m00:47:13.738315 [debug] [Thread-2 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629
[0m00:47:13.741424 [info ] [Thread-4 (]: 4 of 25 PASS dbt_utils_expression_is_true_stg_produtos_preco___0 ............... [[32mPASS[0m in 0.20s]
[0m00:47:13.744846 [debug] [Thread-3 (]: Began running node test.mage_case.dbt_utils_expression_is_true_stg_vendas_valor_total___0.c052f06d20
[0m00:47:13.748495 [debug] [Thread-1 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23
[0m00:47:13.752252 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:47:13.755051 [debug] [Thread-4 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f
[0m00:47:13.757095 [info ] [Thread-3 (]: 5 of 25 START test dbt_utils_expression_is_true_stg_vendas_valor_total___0 ..... [RUN]
[0m00:47:13.759418 [debug] [Thread-1 (]: Began running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:47:13.761703 [info ] [Thread-2 (]: 6 of 25 START test not_null_stg_clientes_cidade ................................ [RUN]
[0m00:47:13.763592 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:47:13.766108 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_quantidade___0.2efdadf665, now test.mage_case.dbt_utils_expression_is_true_stg_vendas_valor_total___0.c052f06d20)
[0m00:47:13.768639 [info ] [Thread-1 (]: 7 of 25 START test not_null_stg_clientes_email ................................. [RUN]
[0m00:47:13.770451 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_itens_vendas_preco_unitario___0.a6317d4629, now test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73)
[0m00:47:13.772238 [info ] [Thread-4 (]: 8 of 25 START test not_null_stg_clientes_estado ................................ [RUN]
[0m00:47:13.774886 [debug] [Thread-3 (]: Began compiling node test.mage_case.dbt_utils_expression_is_true_stg_vendas_valor_total___0.c052f06d20
[0m00:47:13.777276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_clientes_estado___IS_NOT_NULL_AND_char_length_estado_2.f3dff08b23, now test.mage_case.not_null_stg_clientes_email.d1824e153a)
[0m00:47:13.779518 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:47:13.782588 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_produtos_preco___0.1a7b59fa2f, now test.mage_case.not_null_stg_clientes_estado.33c8769c0b)
[0m00:47:13.793643 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.dbt_utils_expression_is_true_stg_vendas_valor_total___0.c052f06d20"
[0m00:47:13.796777 [debug] [Thread-1 (]: Began compiling node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:47:13.816123 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:47:13.817333 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:47:13.829068 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:47:13.836262 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:47:13.843331 [debug] [Thread-3 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_vendas_valor_total___0.c052f06d20 (compile): 00:47:13.784055 => 00:47:13.842336
[0m00:47:13.844303 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (compile): 00:47:13.800819 => 00:47:13.843858
[0m00:47:13.846003 [debug] [Thread-3 (]: Began executing node test.mage_case.dbt_utils_expression_is_true_stg_vendas_valor_total___0.c052f06d20
[0m00:47:13.847121 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (compile): 00:47:13.830908 => 00:47:13.846688
[0m00:47:13.848563 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:47:13.849496 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (compile): 00:47:13.820266 => 00:47:13.849014
[0m00:47:13.854027 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.dbt_utils_expression_is_true_stg_vendas_valor_total___0.c052f06d20"
[0m00:47:13.855844 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:47:13.860115 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:47:13.861880 [debug] [Thread-1 (]: Began executing node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:47:13.869079 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:47:13.874669 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:47:13.882808 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:47:13.883762 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:47:13.885560 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: BEGIN
[0m00:47:13.886573 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:47:13.887851 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: BEGIN
[0m00:47:13.888592 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_vendas_valor_total___0.c052f06d20"
[0m00:47:13.890251 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:47:13.891873 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: BEGIN
[0m00:47:13.893417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:13.894828 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_vendas_valor_total___0.c052f06d20: BEGIN
[0m00:47:13.897996 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:47:13.901720 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:47:13.908688 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:13.910565 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"
[0m00:47:13.913792 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cidade
from "dbt"."public"."stg_clientes"
where cidade is null



      
    ) dbt_internal_test
[0m00:47:13.917118 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:13.918747 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:13.919604 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:13.921040 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:13.921798 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"
[0m00:47:13.925230 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73 (execute): 00:47:13.857129 => 00:47:13.924870
[0m00:47:13.926605 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_email.d1824e153a"
[0m00:47:13.928538 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.dbt_utils_expression_is_true_stg_vendas_valor_total___0.c052f06d20"
[0m00:47:13.930931 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_estado.33c8769c0b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select estado
from "dbt"."public"."stg_clientes"
where estado is null



      
    ) dbt_internal_test
[0m00:47:13.934634 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: ROLLBACK
[0m00:47:13.936447 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_email.d1824e153a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from "dbt"."public"."stg_clientes"
where email is null



      
    ) dbt_internal_test
[0m00:47:13.938064 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_vendas_valor_total___0.c052f06d20: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.dbt_utils_expression_is_true_stg_vendas_valor_total___0.c052f06d20"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from "dbt"."public"."stg_vendas"

where not(valor_total >= 0)


      
    ) dbt_internal_test
[0m00:47:13.940989 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73: Close
[0m00:47:13.941671 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:13.944125 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:13.945253 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:13.947092 [info ] [Thread-2 (]: 6 of 25 PASS not_null_stg_clientes_cidade ...................................... [[32mPASS[0m in 0.18s]
[0m00:47:13.951519 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_estado.33c8769c0b (execute): 00:47:13.864658 => 00:47:13.950869
[0m00:47:13.955539 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_clientes_email.d1824e153a (execute): 00:47:13.871126 => 00:47:13.955041
[0m00:47:13.959200 [debug] [Thread-3 (]: Timing info for test.mage_case.dbt_utils_expression_is_true_stg_vendas_valor_total___0.c052f06d20 (execute): 00:47:13.850660 => 00:47:13.958618
[0m00:47:13.961876 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73
[0m00:47:13.963914 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: ROLLBACK
[0m00:47:13.965709 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: ROLLBACK
[0m00:47:13.967453 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_vendas_valor_total___0.c052f06d20: ROLLBACK
[0m00:47:13.969040 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:47:13.970989 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_estado.33c8769c0b: Close
[0m00:47:13.973084 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_clientes_email.d1824e153a: Close
[0m00:47:13.976120 [debug] [Thread-3 (]: On test.mage_case.dbt_utils_expression_is_true_stg_vendas_valor_total___0.c052f06d20: Close
[0m00:47:13.977675 [info ] [Thread-2 (]: 9 of 25 START test not_null_stg_clientes_id_cliente ............................ [RUN]
[0m00:47:13.982279 [info ] [Thread-4 (]: 8 of 25 PASS not_null_stg_clientes_estado ...................................... [[32mPASS[0m in 0.20s]
[0m00:47:13.989106 [info ] [Thread-1 (]: 7 of 25 PASS not_null_stg_clientes_email ....................................... [[32mPASS[0m in 0.21s]
[0m00:47:13.992330 [info ] [Thread-3 (]: 5 of 25 PASS dbt_utils_expression_is_true_stg_vendas_valor_total___0 ........... [[32mPASS[0m in 0.23s]
[0m00:47:13.995251 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_cidade.e1b3bc7d73, now test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2)
[0m00:47:13.998533 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_clientes_estado.33c8769c0b
[0m00:47:14.001381 [debug] [Thread-1 (]: Finished running node test.mage_case.not_null_stg_clientes_email.d1824e153a
[0m00:47:14.003948 [debug] [Thread-3 (]: Finished running node test.mage_case.dbt_utils_expression_is_true_stg_vendas_valor_total___0.c052f06d20
[0m00:47:14.008437 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:47:14.011884 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:47:14.013932 [debug] [Thread-1 (]: Began running node test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750
[0m00:47:14.016487 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9
[0m00:47:14.031638 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:47:14.033253 [info ] [Thread-4 (]: 10 of 25 START test not_null_stg_clientes_nome ................................. [RUN]
[0m00:47:14.035309 [info ] [Thread-1 (]: 11 of 25 START test not_null_stg_itens_vendas_id_produto ....................... [RUN]
[0m00:47:14.038530 [info ] [Thread-3 (]: 12 of 25 START test not_null_stg_itens_vendas_id_venda ......................... [RUN]
[0m00:47:14.041996 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_estado.33c8769c0b, now test.mage_case.not_null_stg_clientes_nome.04166b95e6)
[0m00:47:14.044870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_email.d1824e153a, now test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750)
[0m00:47:14.046701 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.dbt_utils_expression_is_true_stg_vendas_valor_total___0.c052f06d20, now test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9)
[0m00:47:14.048258 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:47:14.051301 [debug] [Thread-1 (]: Began compiling node test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750
[0m00:47:14.053502 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9
[0m00:47:14.054710 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (compile): 00:47:14.018145 => 00:47:14.054235
[0m00:47:14.063257 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:47:14.069998 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"
[0m00:47:14.077139 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"
[0m00:47:14.079885 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:47:14.089959 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:47:14.099285 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750 (compile): 00:47:14.064398 => 00:47:14.098550
[0m00:47:14.100362 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (compile): 00:47:14.055645 => 00:47:14.099875
[0m00:47:14.101281 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9 (compile): 00:47:14.070900 => 00:47:14.100800
[0m00:47:14.102351 [debug] [Thread-1 (]: Began executing node test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750
[0m00:47:14.103958 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:47:14.105671 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:47:14.106775 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9
[0m00:47:14.111580 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"
[0m00:47:14.118840 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:47:14.120813 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: BEGIN
[0m00:47:14.142119 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"
[0m00:47:14.147265 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:47:14.154613 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"
[0m00:47:14.156941 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:47:14.158009 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"
[0m00:47:14.158937 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750: BEGIN
[0m00:47:14.160817 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: BEGIN
[0m00:47:14.162604 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9: BEGIN
[0m00:47:14.164002 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:14.165047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:14.166446 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:47:14.167890 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:47:14.169345 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"
[0m00:47:14.181525 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_cliente
from "dbt"."public"."stg_clientes"
where id_cliente is null



      
    ) dbt_internal_test
[0m00:47:14.184329 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:14.188828 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2 (execute): 00:47:14.083508 => 00:47:14.188069
[0m00:47:14.190737 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:14.191418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:14.192027 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: ROLLBACK
[0m00:47:14.192715 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:14.194196 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"
[0m00:47:14.195891 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"
[0m00:47:14.198532 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2: Close
[0m00:47:14.200841 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_clientes_nome.04166b95e6"
[0m00:47:14.203102 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_venda
from "dbt"."public"."stg_itens_vendas"
where id_venda is null



      
    ) dbt_internal_test
[0m00:47:14.204973 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_produto
from "dbt"."public"."stg_itens_vendas"
where id_produto is null



      
    ) dbt_internal_test
[0m00:47:14.207524 [info ] [Thread-2 (]: 9 of 25 PASS not_null_stg_clientes_id_cliente .................................. [[32mPASS[0m in 0.21s]
[0m00:47:14.209547 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_clientes_nome.04166b95e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome
from "dbt"."public"."stg_clientes"
where nome is null



      
    ) dbt_internal_test
[0m00:47:14.214721 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:14.216014 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2
[0m00:47:14.216908 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:14.220721 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9 (execute): 00:47:14.123200 => 00:47:14.220291
[0m00:47:14.221328 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:14.222775 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014
[0m00:47:14.225935 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750 (execute): 00:47:14.107927 => 00:47:14.225487
[0m00:47:14.227262 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9: ROLLBACK
[0m00:47:14.230925 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_clientes_nome.04166b95e6 (execute): 00:47:14.113234 => 00:47:14.230297
[0m00:47:14.232770 [info ] [Thread-2 (]: 13 of 25 START test not_null_stg_itens_vendas_preco_unitario ................... [RUN]
[0m00:47:14.234854 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750: ROLLBACK
[0m00:47:14.237972 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9: Close
[0m00:47:14.239715 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: ROLLBACK
[0m00:47:14.241976 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_id_cliente.ef479689f2, now test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014)
[0m00:47:14.243811 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750: Close
[0m00:47:14.246368 [info ] [Thread-3 (]: 12 of 25 PASS not_null_stg_itens_vendas_id_venda ............................... [[32mPASS[0m in 0.20s]
[0m00:47:14.248936 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_clientes_nome.04166b95e6: Close
[0m00:47:14.250642 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014
[0m00:47:14.253487 [info ] [Thread-1 (]: 11 of 25 PASS not_null_stg_itens_vendas_id_produto ............................. [[32mPASS[0m in 0.21s]
[0m00:47:14.255651 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9
[0m00:47:14.258359 [info ] [Thread-4 (]: 10 of 25 PASS not_null_stg_clientes_nome ....................................... [[32mPASS[0m in 0.22s]
[0m00:47:14.268409 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"
[0m00:47:14.270965 [debug] [Thread-1 (]: Finished running node test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750
[0m00:47:14.273471 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8
[0m00:47:14.276270 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_clientes_nome.04166b95e6
[0m00:47:14.279698 [debug] [Thread-1 (]: Began running node test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576
[0m00:47:14.281559 [info ] [Thread-3 (]: 14 of 25 START test not_null_stg_itens_vendas_quantidade ....................... [RUN]
[0m00:47:14.283556 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4
[0m00:47:14.286130 [info ] [Thread-1 (]: 15 of 25 START test not_null_stg_produtos_categoria ............................ [RUN]
[0m00:47:14.289979 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_itens_vendas_id_venda.1d450c29c9, now test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8)
[0m00:47:14.292249 [info ] [Thread-4 (]: 16 of 25 START test not_null_stg_produtos_id_produto ........................... [RUN]
[0m00:47:14.294709 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014 (compile): 00:47:14.260192 => 00:47:14.293966
[0m00:47:14.296684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_itens_vendas_id_produto.3111cc5750, now test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576)
[0m00:47:14.298360 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8
[0m00:47:14.300851 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_clientes_nome.04166b95e6, now test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4)
[0m00:47:14.302680 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014
[0m00:47:14.304460 [debug] [Thread-1 (]: Began compiling node test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576
[0m00:47:14.317472 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"
[0m00:47:14.318742 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4
[0m00:47:14.325425 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"
[0m00:47:14.338569 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576"
[0m00:47:14.356965 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4"
[0m00:47:14.360253 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8 (compile): 00:47:14.305678 => 00:47:14.359675
[0m00:47:14.363185 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8
[0m00:47:14.370448 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"
[0m00:47:14.373805 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576 (compile): 00:47:14.327071 => 00:47:14.372955
[0m00:47:14.374857 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"
[0m00:47:14.375798 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4 (compile): 00:47:14.343579 => 00:47:14.375340
[0m00:47:14.376963 [debug] [Thread-1 (]: Began executing node test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576
[0m00:47:14.378129 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014: BEGIN
[0m00:47:14.379646 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4
[0m00:47:14.380932 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"
[0m00:47:14.386703 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576"
[0m00:47:14.388247 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:47:14.395629 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4"
[0m00:47:14.397791 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8: BEGIN
[0m00:47:14.407768 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:47:14.414190 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576"
[0m00:47:14.415564 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4"
[0m00:47:14.417032 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576: BEGIN
[0m00:47:14.418670 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4: BEGIN
[0m00:47:14.420919 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:14.421950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:14.422623 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:14.424518 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:47:14.426705 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"
[0m00:47:14.430385 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"
[0m00:47:14.438816 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select preco_unitario
from "dbt"."public"."stg_itens_vendas"
where preco_unitario is null



      
    ) dbt_internal_test
[0m00:47:14.442061 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select quantidade
from "dbt"."public"."stg_itens_vendas"
where quantidade is null



      
    ) dbt_internal_test
[0m00:47:14.442849 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:14.444367 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:14.445658 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:14.447836 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576"
[0m00:47:14.448589 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:14.449561 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4"
[0m00:47:14.452719 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014 (execute): 00:47:14.321310 => 00:47:14.451994
[0m00:47:14.454284 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select categoria
from "dbt"."public"."stg_produtos"
where categoria is null



      
    ) dbt_internal_test
[0m00:47:14.456874 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8 (execute): 00:47:14.364567 => 00:47:14.456543
[0m00:47:14.457963 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_produto
from "dbt"."public"."stg_produtos"
where id_produto is null



      
    ) dbt_internal_test
[0m00:47:14.460321 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014: ROLLBACK
[0m00:47:14.463735 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8: ROLLBACK
[0m00:47:14.465011 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:14.470243 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:14.472316 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014: Close
[0m00:47:14.475347 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8: Close
[0m00:47:14.478680 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576 (execute): 00:47:14.381327 => 00:47:14.478256
[0m00:47:14.482413 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4 (execute): 00:47:14.389672 => 00:47:14.481998
[0m00:47:14.484612 [info ] [Thread-2 (]: 13 of 25 PASS not_null_stg_itens_vendas_preco_unitario ......................... [[32mPASS[0m in 0.24s]
[0m00:47:14.487446 [info ] [Thread-3 (]: 14 of 25 PASS not_null_stg_itens_vendas_quantidade ............................. [[32mPASS[0m in 0.20s]
[0m00:47:14.491224 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576: ROLLBACK
[0m00:47:14.493456 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4: ROLLBACK
[0m00:47:14.496236 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014
[0m00:47:14.497983 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8
[0m00:47:14.499698 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576: Close
[0m00:47:14.501527 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4: Close
[0m00:47:14.503181 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120
[0m00:47:14.504726 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_produtos_preco.d32f7aebfa
[0m00:47:14.507450 [info ] [Thread-1 (]: 15 of 25 PASS not_null_stg_produtos_categoria .................................. [[32mPASS[0m in 0.21s]
[0m00:47:14.511782 [info ] [Thread-4 (]: 16 of 25 PASS not_null_stg_produtos_id_produto ................................. [[32mPASS[0m in 0.21s]
[0m00:47:14.517011 [info ] [Thread-2 (]: 17 of 25 START test not_null_stg_produtos_nome_produto ......................... [RUN]
[0m00:47:14.519392 [info ] [Thread-3 (]: 18 of 25 START test not_null_stg_produtos_preco ................................ [RUN]
[0m00:47:14.522230 [debug] [Thread-1 (]: Finished running node test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576
[0m00:47:14.524528 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4
[0m00:47:14.526798 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_itens_vendas_preco_unitario.3501831014, now test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120)
[0m00:47:14.530334 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_itens_vendas_quantidade.5bf6e1c0b8, now test.mage_case.not_null_stg_produtos_preco.d32f7aebfa)
[0m00:47:14.532637 [debug] [Thread-1 (]: Began running node test.mage_case.not_null_stg_vendas_data_venda.02ebc97835
[0m00:47:14.534171 [debug] [Thread-4 (]: Began running node test.mage_case.not_null_stg_vendas_id_cliente.a0d7d4278f
[0m00:47:14.535945 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120
[0m00:47:14.538513 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_produtos_preco.d32f7aebfa
[0m00:47:14.541296 [info ] [Thread-1 (]: 19 of 25 START test not_null_stg_vendas_data_venda ............................. [RUN]
[0m00:47:14.546717 [info ] [Thread-4 (]: 20 of 25 START test not_null_stg_vendas_id_cliente ............................. [RUN]
[0m00:47:14.561492 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120"
[0m00:47:14.569440 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_produtos_preco.d32f7aebfa"
[0m00:47:14.572266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_produtos_categoria.ffa6c7a576, now test.mage_case.not_null_stg_vendas_data_venda.02ebc97835)
[0m00:47:14.575335 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_produtos_id_produto.9c94bdb5a4, now test.mage_case.not_null_stg_vendas_id_cliente.a0d7d4278f)
[0m00:47:14.579360 [debug] [Thread-1 (]: Began compiling node test.mage_case.not_null_stg_vendas_data_venda.02ebc97835
[0m00:47:14.580940 [debug] [Thread-4 (]: Began compiling node test.mage_case.not_null_stg_vendas_id_cliente.a0d7d4278f
[0m00:47:14.589644 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.not_null_stg_vendas_data_venda.02ebc97835"
[0m00:47:14.597069 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120 (compile): 00:47:14.549573 => 00:47:14.596648
[0m00:47:14.597809 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_produtos_preco.d32f7aebfa (compile): 00:47:14.562311 => 00:47:14.597470
[0m00:47:14.602055 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.not_null_stg_vendas_id_cliente.a0d7d4278f"
[0m00:47:14.604245 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120
[0m00:47:14.605650 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_produtos_preco.d32f7aebfa
[0m00:47:14.610870 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120"
[0m00:47:14.617111 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_produtos_preco.d32f7aebfa"
[0m00:47:14.617957 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_vendas_data_venda.02ebc97835 (compile): 00:47:14.582237 => 00:47:14.617615
[0m00:47:14.621734 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_vendas_id_cliente.a0d7d4278f (compile): 00:47:14.591312 => 00:47:14.621259
[0m00:47:14.622707 [debug] [Thread-1 (]: Began executing node test.mage_case.not_null_stg_vendas_data_venda.02ebc97835
[0m00:47:14.624195 [debug] [Thread-4 (]: Began executing node test.mage_case.not_null_stg_vendas_id_cliente.a0d7d4278f
[0m00:47:14.630034 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.not_null_stg_vendas_data_venda.02ebc97835"
[0m00:47:14.635214 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.not_null_stg_vendas_id_cliente.a0d7d4278f"
[0m00:47:14.635895 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_produtos_preco.d32f7aebfa"
[0m00:47:14.636458 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120"
[0m00:47:14.638769 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_produtos_preco.d32f7aebfa: BEGIN
[0m00:47:14.640004 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120: BEGIN
[0m00:47:14.641277 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:47:14.642603 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:47:14.643381 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_vendas_data_venda.02ebc97835"
[0m00:47:14.646556 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_vendas_id_cliente.a0d7d4278f"
[0m00:47:14.650193 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_vendas_data_venda.02ebc97835: BEGIN
[0m00:47:14.653401 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_vendas_id_cliente.a0d7d4278f: BEGIN
[0m00:47:14.658023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:14.659808 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:14.669560 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:14.671641 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:47:14.675057 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_produtos_preco.d32f7aebfa"
[0m00:47:14.676582 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120"
[0m00:47:14.681442 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_produtos_preco.d32f7aebfa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_produtos_preco.d32f7aebfa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select preco
from "dbt"."public"."stg_produtos"
where preco is null



      
    ) dbt_internal_test
[0m00:47:14.683010 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select nome_produto
from "dbt"."public"."stg_produtos"
where nome_produto is null



      
    ) dbt_internal_test
[0m00:47:14.685742 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:14.686433 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:14.686965 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:14.690040 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_produtos_preco.d32f7aebfa (execute): 00:47:14.612811 => 00:47:14.689644
[0m00:47:14.691279 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:14.691833 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.not_null_stg_vendas_data_venda.02ebc97835"
[0m00:47:14.694332 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120 (execute): 00:47:14.607299 => 00:47:14.693996
[0m00:47:14.695761 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_produtos_preco.d32f7aebfa: ROLLBACK
[0m00:47:14.697063 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.not_null_stg_vendas_id_cliente.a0d7d4278f"
[0m00:47:14.698224 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_vendas_data_venda.02ebc97835: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_vendas_data_venda.02ebc97835"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select data_venda
from "dbt"."public"."stg_vendas"
where data_venda is null



      
    ) dbt_internal_test
[0m00:47:14.699315 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120: ROLLBACK
[0m00:47:14.700850 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_produtos_preco.d32f7aebfa: Close
[0m00:47:14.701784 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_vendas_id_cliente.a0d7d4278f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_vendas_id_cliente.a0d7d4278f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_cliente
from "dbt"."public"."stg_vendas"
where id_cliente is null



      
    ) dbt_internal_test
[0m00:47:14.704507 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120: Close
[0m00:47:14.705300 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:14.706827 [info ] [Thread-3 (]: 18 of 25 PASS not_null_stg_produtos_preco ...................................... [[32mPASS[0m in 0.18s]
[0m00:47:14.712010 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:14.711283 [info ] [Thread-2 (]: 17 of 25 PASS not_null_stg_produtos_nome_produto ............................... [[32mPASS[0m in 0.18s]
[0m00:47:14.715825 [debug] [Thread-1 (]: Timing info for test.mage_case.not_null_stg_vendas_data_venda.02ebc97835 (execute): 00:47:14.625389 => 00:47:14.715221
[0m00:47:14.718437 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_produtos_preco.d32f7aebfa
[0m00:47:14.721563 [debug] [Thread-4 (]: Timing info for test.mage_case.not_null_stg_vendas_id_cliente.a0d7d4278f (execute): 00:47:14.631460 => 00:47:14.721179
[0m00:47:14.723693 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120
[0m00:47:14.725626 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_vendas_data_venda.02ebc97835: ROLLBACK
[0m00:47:14.728047 [debug] [Thread-3 (]: Began running node test.mage_case.not_null_stg_vendas_id_venda.a7928fee30
[0m00:47:14.730342 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_vendas_id_cliente.a0d7d4278f: ROLLBACK
[0m00:47:14.733727 [debug] [Thread-2 (]: Began running node test.mage_case.not_null_stg_vendas_valor_total.ca5b1816d1
[0m00:47:14.738715 [debug] [Thread-1 (]: On test.mage_case.not_null_stg_vendas_data_venda.02ebc97835: Close
[0m00:47:14.740566 [info ] [Thread-3 (]: 21 of 25 START test not_null_stg_vendas_id_venda ............................... [RUN]
[0m00:47:14.744595 [debug] [Thread-4 (]: On test.mage_case.not_null_stg_vendas_id_cliente.a0d7d4278f: Close
[0m00:47:14.747088 [info ] [Thread-2 (]: 22 of 25 START test not_null_stg_vendas_valor_total ............................ [RUN]
[0m00:47:14.750804 [info ] [Thread-1 (]: 19 of 25 PASS not_null_stg_vendas_data_venda ................................... [[32mPASS[0m in 0.18s]
[0m00:47:14.754402 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_produtos_preco.d32f7aebfa, now test.mage_case.not_null_stg_vendas_id_venda.a7928fee30)
[0m00:47:14.757638 [info ] [Thread-4 (]: 20 of 25 PASS not_null_stg_vendas_id_cliente ................................... [[32mPASS[0m in 0.18s]
[0m00:47:14.760915 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_produtos_nome_produto.e8e8287120, now test.mage_case.not_null_stg_vendas_valor_total.ca5b1816d1)
[0m00:47:14.763977 [debug] [Thread-1 (]: Finished running node test.mage_case.not_null_stg_vendas_data_venda.02ebc97835
[0m00:47:14.767138 [debug] [Thread-3 (]: Began compiling node test.mage_case.not_null_stg_vendas_id_venda.a7928fee30
[0m00:47:14.771268 [debug] [Thread-4 (]: Finished running node test.mage_case.not_null_stg_vendas_id_cliente.a0d7d4278f
[0m00:47:14.774459 [debug] [Thread-2 (]: Began compiling node test.mage_case.not_null_stg_vendas_valor_total.ca5b1816d1
[0m00:47:14.777465 [debug] [Thread-1 (]: Began running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:47:14.794331 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.not_null_stg_vendas_id_venda.a7928fee30"
[0m00:47:14.796892 [debug] [Thread-4 (]: Began running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:47:14.815569 [debug] [Thread-2 (]: Writing injected SQL for node "test.mage_case.not_null_stg_vendas_valor_total.ca5b1816d1"
[0m00:47:14.817996 [info ] [Thread-1 (]: 23 of 25 START test unique_stg_clientes_email .................................. [RUN]
[0m00:47:14.821932 [info ] [Thread-4 (]: 24 of 25 START test unique_stg_clientes_id_cliente ............................. [RUN]
[0m00:47:14.826053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_vendas_data_venda.02ebc97835, now test.mage_case.unique_stg_clientes_email.2b7c7e0aff)
[0m00:47:14.829272 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_vendas_id_cliente.a0d7d4278f, now test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3)
[0m00:47:14.831811 [debug] [Thread-1 (]: Began compiling node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:47:14.833271 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_vendas_id_venda.a7928fee30 (compile): 00:47:14.779234 => 00:47:14.832690
[0m00:47:14.835128 [debug] [Thread-4 (]: Began compiling node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:47:14.836991 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_vendas_valor_total.ca5b1816d1 (compile): 00:47:14.798434 => 00:47:14.835973
[0m00:47:14.859325 [debug] [Thread-1 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:47:14.860350 [debug] [Thread-3 (]: Began executing node test.mage_case.not_null_stg_vendas_id_venda.a7928fee30
[0m00:47:14.877752 [debug] [Thread-4 (]: Writing injected SQL for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:47:14.878923 [debug] [Thread-2 (]: Began executing node test.mage_case.not_null_stg_vendas_valor_total.ca5b1816d1
[0m00:47:14.888869 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.not_null_stg_vendas_id_venda.a7928fee30"
[0m00:47:14.898491 [debug] [Thread-2 (]: Writing runtime sql for node "test.mage_case.not_null_stg_vendas_valor_total.ca5b1816d1"
[0m00:47:14.902217 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (compile): 00:47:14.862108 => 00:47:14.901460
[0m00:47:14.905861 [debug] [Thread-1 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (compile): 00:47:14.838305 => 00:47:14.904839
[0m00:47:14.910251 [debug] [Thread-4 (]: Began executing node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:47:14.912979 [debug] [Thread-1 (]: Began executing node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:47:14.921326 [debug] [Thread-4 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:47:14.923565 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_vendas_id_venda.a7928fee30"
[0m00:47:14.930414 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_vendas_valor_total.ca5b1816d1"
[0m00:47:14.933946 [debug] [Thread-1 (]: Writing runtime sql for node "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:47:14.937879 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_vendas_id_venda.a7928fee30: BEGIN
[0m00:47:14.940489 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_vendas_valor_total.ca5b1816d1: BEGIN
[0m00:47:14.945006 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:47:14.948957 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:47:14.963342 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:47:14.968714 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: BEGIN
[0m00:47:14.969930 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:47:14.971753 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:14.972783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:14.975621 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: BEGIN
[0m00:47:14.977923 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:14.979020 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.not_null_stg_vendas_id_venda.a7928fee30"
[0m00:47:14.983902 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:47:14.988072 [debug] [Thread-2 (]: Using postgres connection "test.mage_case.not_null_stg_vendas_valor_total.ca5b1816d1"
[0m00:47:14.990011 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_vendas_id_venda.a7928fee30: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_vendas_id_venda.a7928fee30"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id_venda
from "dbt"."public"."stg_vendas"
where id_venda is null



      
    ) dbt_internal_test
[0m00:47:14.993497 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_vendas_valor_total.ca5b1816d1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.not_null_stg_vendas_valor_total.ca5b1816d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valor_total
from "dbt"."public"."stg_vendas"
where valor_total is null



      
    ) dbt_internal_test
[0m00:47:14.997125 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:15.003429 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:15.006078 [debug] [Thread-1 (]: Using postgres connection "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"
[0m00:47:15.007516 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:15.008647 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:15.012033 [debug] [Thread-3 (]: Timing info for test.mage_case.not_null_stg_vendas_id_venda.a7928fee30 (execute): 00:47:14.881615 => 00:47:15.011589
[0m00:47:15.014317 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_email.2b7c7e0aff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where email is not null
group by email
having count(*) > 1



      
    ) dbt_internal_test
[0m00:47:15.019150 [debug] [Thread-2 (]: Timing info for test.mage_case.not_null_stg_vendas_valor_total.ca5b1816d1 (execute): 00:47:14.891880 => 00:47:15.018737
[0m00:47:15.021106 [debug] [Thread-4 (]: Using postgres connection "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"
[0m00:47:15.024533 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_vendas_id_venda.a7928fee30: ROLLBACK
[0m00:47:15.027540 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_vendas_valor_total.ca5b1816d1: ROLLBACK
[0m00:47:15.028847 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:15.030429 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_cliente as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_clientes"
where id_cliente is not null
group by id_cliente
having count(*) > 1



      
    ) dbt_internal_test
[0m00:47:15.032365 [debug] [Thread-3 (]: On test.mage_case.not_null_stg_vendas_id_venda.a7928fee30: Close
[0m00:47:15.033536 [debug] [Thread-2 (]: On test.mage_case.not_null_stg_vendas_valor_total.ca5b1816d1: Close
[0m00:47:15.037526 [debug] [Thread-1 (]: Timing info for test.mage_case.unique_stg_clientes_email.2b7c7e0aff (execute): 00:47:14.924461 => 00:47:15.036636
[0m00:47:15.043674 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:15.042534 [info ] [Thread-3 (]: 21 of 25 PASS not_null_stg_vendas_id_venda ..................................... [[32mPASS[0m in 0.29s]
[0m00:47:15.047071 [info ] [Thread-2 (]: 22 of 25 PASS not_null_stg_vendas_valor_total .................................. [[32mPASS[0m in 0.29s]
[0m00:47:15.048860 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: ROLLBACK
[0m00:47:15.053276 [debug] [Thread-4 (]: Timing info for test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3 (execute): 00:47:14.915014 => 00:47:15.052662
[0m00:47:15.055234 [debug] [Thread-3 (]: Finished running node test.mage_case.not_null_stg_vendas_id_venda.a7928fee30
[0m00:47:15.058363 [debug] [Thread-2 (]: Finished running node test.mage_case.not_null_stg_vendas_valor_total.ca5b1816d1
[0m00:47:15.061956 [debug] [Thread-1 (]: On test.mage_case.unique_stg_clientes_email.2b7c7e0aff: Close
[0m00:47:15.063733 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: ROLLBACK
[0m00:47:15.066307 [debug] [Thread-3 (]: Began running node test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c
[0m00:47:15.074878 [info ] [Thread-1 (]: 23 of 25 PASS unique_stg_clientes_email ........................................ [[32mPASS[0m in 0.25s]
[0m00:47:15.080783 [debug] [Thread-4 (]: On test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3: Close
[0m00:47:15.084299 [info ] [Thread-3 (]: 25 of 25 START test unique_stg_produtos_id_produto ............................. [RUN]
[0m00:47:15.087416 [debug] [Thread-1 (]: Finished running node test.mage_case.unique_stg_clientes_email.2b7c7e0aff
[0m00:47:15.090332 [info ] [Thread-4 (]: 24 of 25 PASS unique_stg_clientes_id_cliente ................................... [[32mPASS[0m in 0.26s]
[0m00:47:15.094148 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.mage_case.not_null_stg_vendas_id_venda.a7928fee30, now test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c)
[0m00:47:15.099037 [debug] [Thread-4 (]: Finished running node test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3
[0m00:47:15.102991 [debug] [Thread-3 (]: Began compiling node test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c
[0m00:47:15.128555 [debug] [Thread-3 (]: Writing injected SQL for node "test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c"
[0m00:47:15.146701 [debug] [Thread-3 (]: Timing info for test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c (compile): 00:47:15.107506 => 00:47:15.145739
[0m00:47:15.148623 [debug] [Thread-3 (]: Began executing node test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c
[0m00:47:15.155047 [debug] [Thread-3 (]: Writing runtime sql for node "test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c"
[0m00:47:15.172234 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c"
[0m00:47:15.174016 [debug] [Thread-3 (]: On test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c: BEGIN
[0m00:47:15.176521 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:47:15.194894 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:47:15.198648 [debug] [Thread-3 (]: Using postgres connection "test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c"
[0m00:47:15.203812 [debug] [Thread-3 (]: On test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id_produto as unique_field,
    count(*) as n_records

from "dbt"."public"."stg_produtos"
where id_produto is not null
group by id_produto
having count(*) > 1



      
    ) dbt_internal_test
[0m00:47:15.211206 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:47:15.214596 [debug] [Thread-3 (]: Timing info for test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c (execute): 00:47:15.149782 => 00:47:15.214150
[0m00:47:15.216683 [debug] [Thread-3 (]: On test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c: ROLLBACK
[0m00:47:15.219823 [debug] [Thread-3 (]: On test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c: Close
[0m00:47:15.222247 [info ] [Thread-3 (]: 25 of 25 PASS unique_stg_produtos_id_produto ................................... [[32mPASS[0m in 0.13s]
[0m00:47:15.226704 [debug] [Thread-3 (]: Finished running node test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c
[0m00:47:15.232291 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:15.233955 [debug] [MainThread]: On master: BEGIN
[0m00:47:15.235414 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:47:15.252310 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:47:15.255003 [debug] [MainThread]: On master: COMMIT
[0m00:47:15.256578 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:15.258889 [debug] [MainThread]: On master: COMMIT
[0m00:47:15.262774 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:47:15.267177 [debug] [MainThread]: On master: Close
[0m00:47:15.270591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:47:15.273405 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_email.2b7c7e0aff' was properly closed.
[0m00:47:15.274882 [debug] [MainThread]: Connection 'test.mage_case.not_null_stg_vendas_valor_total.ca5b1816d1' was properly closed.
[0m00:47:15.275988 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_produtos_id_produto.ad98d9f47c' was properly closed.
[0m00:47:15.277249 [debug] [MainThread]: Connection 'test.mage_case.unique_stg_clientes_id_cliente.f03b9582c3' was properly closed.
[0m00:47:15.279138 [info ] [MainThread]: 
[0m00:47:15.281076 [info ] [MainThread]: Finished running 25 tests in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m00:47:15.291637 [debug] [MainThread]: Command end result
[0m00:47:15.342732 [info ] [MainThread]: 
[0m00:47:15.346618 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:47:15.349714 [info ] [MainThread]: 
[0m00:47:15.352737 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 TOTAL=25
[0m00:47:15.358928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749676393730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749672be7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749672bb8070>]}
[0m00:47:15.361117 [debug] [MainThread]: Flushing usage events
